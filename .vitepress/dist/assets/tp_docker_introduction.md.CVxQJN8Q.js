import{_ as e,c as s,o as i,U as a}from"./chunks/framework.aGaNZw_P.js";const n="/assets/hello-world.BTHY9Inp.png",l="/assets/hello-world2.8NVSZjIr.png",t="/assets/ubuntu.cYJWKzfO.png",v=JSON.parse('{"title":"Introduction à Docker","description":"Dans ce TP nous allons voir l’installation de Docker et les premiers exemples d’utilisations de votre nouvel environnement.","frontmatter":{"description":"Dans ce TP nous allons voir l’installation de Docker et les premiers exemples d’utilisations de votre nouvel environnement."},"headers":[],"relativePath":"tp/docker/introduction.md","filePath":"tp/docker/introduction.md","lastUpdated":1674597678000}'),r={name:"tp/docker/introduction.md"},o=a('<h1 id="introduction-a-docker" tabindex="-1">Introduction à Docker <a class="header-anchor" href="#introduction-a-docker" aria-label="Permalink to &quot;Introduction à Docker&quot;">​</a></h1><p>Dans ce TP nous allons voir l’installation de Docker et les premiers exemples d’utilisations de votre nouvel environnement.</p><details class="details custom-block"><summary>Sommaire</summary><nav class="table-of-contents"><ul><li><a href="#installation-de-docker-sous-windows">Installation de Docker sous Windows</a></li><li><a href="#lancer-docker">Lancer Docker</a></li><li><a href="#premier-test">Premier test</a></li><li><a href="#second-test">Second test</a></li><li><a href="#les-sources-de-l-image-hello-world">Les sources de l’image hello world</a></li><li><a href="#pour-aller-plus-loin">Pour aller plus loin</a><ul><li><a href="#creer-un-fichier-dans-la-machine">Créer un fichier dans la machine</a></li><li><a href="#avoir-acces-aux-fichiers-de-votre-machine">Avoir accès aux fichiers de votre machine</a></li></ul></li><li><a href="#compilation-cordova">Compilation Cordova</a><ul><li><a href="#unix-linux-osx">Unix (Linux, Osx)</a></li><li><a href="#windows">Windows</a></li></ul></li><li><a href="#allons-plus-loin">Allons plus loin</a></li></ul></nav></details><h2 id="installation-de-docker-sous-windows" tabindex="-1">Installation de Docker sous Windows <a class="header-anchor" href="#installation-de-docker-sous-windows" aria-label="Permalink to &quot;Installation de Docker sous Windows&quot;">​</a></h2><p>Pour installer Docker rien de plus simple, il suffit d’utiliser l’installeur officiel en le téléchargent sur <a href="https://www.docker.com/docker-windows" target="_blank" rel="noreferrer">le site de Docker.</a></p><h2 id="lancer-docker" tabindex="-1">Lancer Docker <a class="header-anchor" href="#lancer-docker" aria-label="Permalink to &quot;Lancer Docker&quot;">​</a></h2><p>Lancer Docker en tant qu’administrateur (et autoriser Hyper-V si celui-ci vous le demande).</p><h2 id="premier-test" tabindex="-1">Premier test <a class="header-anchor" href="#premier-test" aria-label="Permalink to &quot;Premier test&quot;">​</a></h2><p>Maintenant qu’il est installé sur votre poste, rien de plus simple. Dans une console, entrez la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Vous devez voir la version de Docker.</p><ul><li>Que constatez-vous ?</li><li>Pourquoi est-ce important d’utiliser une version récente ?</li></ul><h2 id="second-test" tabindex="-1">Second test <a class="header-anchor" href="#second-test" aria-label="Permalink to &quot;Second test&quot;">​</a></h2><p>Maintenant que nous savons que Docker est correctement installé, testons avec une « machine » fournie par Docker. L’image se nomme <code>hello-world</code>, celle-ci ne fait qu’afficher un message de bienvenue. De nouveau, dans la console, entrez la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> hello-world</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+n+'" alt="Docker Hello World" loading="lazy"></p><ul><li>Que constatez-vous ?</li><li>Comment être certain que l’image n’a rien fait d’anormal sur notre machine ?</li></ul><h2 id="les-sources-de-l-image-hello-world" tabindex="-1">Les sources de l’image hello world <a class="header-anchor" href="#les-sources-de-l-image-hello-world" aria-label="Permalink to &quot;Les sources de l’image hello world&quot;">​</a></h2><p>Maintenant que nous avons lancé notre première « vrai » machine, intéressons-nous à son fonctionnement. Vous avez du constater le terme « Pulling From » c’est l’image ou les morceaux d’image utile au fonctionnement de votre service. Celui-ci est téléchargé directement depuis le « Docker Hub » (il est également possible d’avoir un Hub privé). Vous pouvez voir « les sources » de l’image en question : <a href="https://github.com/docker-library/hello-world" target="_blank" rel="noreferrer">ici</a>, comme beaucoup de projets libres l’image est disponible sur Github.</p><p>Surprise ! On retrouve des plateformes (amd64, i686, armXX). Et c’est normal, Docker est multiplate-forme et dans le cas de notre exemple l’exécutable « hello » est codé en C il est donc logique de retrouver l’exécutable pour les différentes plateformes ou l’image doit fonctionner.</p><p>Maintenant que nous avons vu le projet, entrons plus en détail, allons voir la définition de notre image le <a href="https://github.com/docker-library/hello-world/blob/master/i386/hello-world/Dockerfile" target="_blank" rel="noreferrer">fichier Dockerfile.</a></p><p><img src="'+l+'" alt="Hello World 2" loading="lazy"></p><p>Peu d’informations, 3 lignes :</p><ul><li><code>FROM scratch</code> (Image de base, celle utilisée comme référence elle aussi possède un DockerFile).</li><li><code>COPY hello /</code> (ajoute le fichier hello à la racine de votre « machine »).</li><li><code>CMD [&quot;/hello&quot;]</code> (Commande lancée au démarrage de votre image).</li></ul><p>PS On créera un DockerFile dans le 2nd TP.</p><h2 id="pour-aller-plus-loin" tabindex="-1">Pour aller plus loin <a class="header-anchor" href="#pour-aller-plus-loin" aria-label="Permalink to &quot;Pour aller plus loin&quot;">​</a></h2><p>Bon, un texte à l’écran c’est bien… Mais si on lançait un système entier ? Ubuntu par exemple. Pour ça rien de plus simple, dans la console lancer :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><img src="'+t+`" alt="Ubuntu" loading="lazy"></p><p>Et voilà, vous avez un Linux complètement opérationnel en quelques minutes sur votre poste Windows. Pratique ! Même si ce n’est pas vraiment le but premier de Docker c’est cool.</p><p>Utiliser un peu le shell de votre « nouveau Linux », exemple de commande :</p><ul><li><code>uname -a</code> : Affiche la version du noyau.</li><li><code>whoami</code> : Qui suis-je ? (normalement root, d’ailleurs est-ce normal ?).</li><li><code>top</code> : Affiche les processus en cours.</li><li><code>ls /</code></li></ul><p>Questions :</p><ul><li>D’ailleurs, pourquoi le top ne retourne-t-il que deux processus ?</li><li>Aucune trace des fichiers de votre machine… normale de base rien n’est accessible.</li></ul><h3 id="creer-un-fichier-dans-la-machine" tabindex="-1">Créer un fichier dans la machine <a class="header-anchor" href="#creer-un-fichier-dans-la-machine" aria-label="Permalink to &quot;Créer un fichier dans la machine&quot;">​</a></h3><p>Créer un fichier vide avec la commande :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fichier_test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Vérifier avec un <code>ls</code> que le fichier est bien présent. Vous pouvez quitter votre l’image en saisissant <code>exit</code> dans le terminal. Relancer de nouveau l’image avec la commande :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Faites à nouveau un <code>ls</code>, que constatez-vous ? Et bien oui, le fichier n’est plus présent… C’est normal, tous les fichiers créés dans l’image sont non persistants (c’est-à-dire qu’ils sont supprimés à chaque fois que l’image s’arrête).</p><h3 id="avoir-acces-aux-fichiers-de-votre-machine" tabindex="-1">Avoir accès aux fichiers de votre machine <a class="header-anchor" href="#avoir-acces-aux-fichiers-de-votre-machine" aria-label="Permalink to &quot;Avoir accès aux fichiers de votre machine&quot;">​</a></h3><p>Bon, c’est bien, mais si l’on donnait accès à un stockage persistant à notre image. Sur votre machine le Stockage persistant c’est votre disque dur (HDD, SSD, etc.). Avec docker (comme sous Linux d’ailleurs) on parle de monter « un volume », une fois monté ce volume sera accessible comme un dossier (ou un fichier, on y reviendra).</p><h4 id="monter-un-dossier" tabindex="-1">Monter un dossier <a class="header-anchor" href="#monter-un-dossier" aria-label="Permalink to &quot;Monter un dossier&quot;">​</a></h4><p>Pour monter un volume il suffit d’ajouter un <code>-v</code> à la commande de lancement, exemple pour avoir le dossier courant :</p><p>⚠️⚠️ Attention ! L’accès est en lecture ET en écriture sur <strong>VOTRE MACHINE</strong> donc attention.</p><p>Sous Windows :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %cd%:/mnt/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Monte le dossier courant dans le /mnt du Docker.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Sous Unix :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">):/mnt/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # Monte le dossier courant dans le /mnt du Docker.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Lancer la commande, <code>ls /mnt</code> vous devriez voir vos fichiers.</p><h4 id="monter-un-fichier" tabindex="-1">Monter un fichier <a class="header-anchor" href="#monter-un-fichier" aria-label="Permalink to &quot;Monter un fichier&quot;">​</a></h4><p>Comme je le disais dans l’introduction avec docker il est possible de rendre accessible le dossier, mais également les fichiers. Pour les fichiers la commande est la même sauf qu’au lieu de spécifier un dossier on spécifie le chemin d’un fichier. Exemple :</p><p>Windows :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %cd%/mon_fichier:/mnt/mon_fichier</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Unix :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)/mon_fichier:/mnt/mon_fichier</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Le fichier est maintenant accessible dans votre image Docker. Il est également possible de limiter l’accès à votre fichier en le montant par exemple en « RO » en français « lecture seulement » :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)/mon_fichier:/mnt/mon_fichier:ro</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ubuntu</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bash</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Et c’est la que l’on voit la puissance, on verra qu’il sera possible par la suite de créer de vrai « stack » applicative qui définiront l’ensemble des paramètres de notre environnement (cloisonné) et gérant finement les droits d’accès à la configuration par exemple ! Un régal !</p><h2 id="compilation-cordova" tabindex="-1">Compilation Cordova <a class="header-anchor" href="#compilation-cordova" aria-label="Permalink to &quot;Compilation Cordova&quot;">​</a></h2><p>Je pense que vous vous souvenez que paramétrer l’environnement de compilation Android sur Windows n’était pas vraiment simple (JDK, SDK, etc.), avec Docker c’est beaucoup plus simple ! Vraiment beaucoup plus simple. Pour compiler un projet Cordova avec Docker j’ai préparé une petite image Docker qui possède l’ensemble des éléments nécessaires, pour l’utiliser :</p><h3 id="unix-linux-osx" tabindex="-1">Unix (Linux, Osx) <a class="header-anchor" href="#unix-linux-osx" aria-label="Permalink to &quot;Unix (Linux, Osx)&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon_projet_cordova/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --entrypoint</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/bash</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> $(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">pwd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">):/Sources/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> c4software/cordova-light:latest</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Vous pouvez maintenant lancer, par exemple : cordova build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="windows" tabindex="-1">Windows <a class="header-anchor" href="#windows" aria-label="Permalink to &quot;Windows&quot;">​</a></h3><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mon_projet_cordova/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -it</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --entrypoint</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/bash</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %cd%:/Sources/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> c4software/cordova-light:latest</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Vous pouvez maintenant lancer, par exemple : cordova build</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="allons-plus-loin" tabindex="-1">Allons plus loin <a class="header-anchor" href="#allons-plus-loin" aria-label="Permalink to &quot;Allons plus loin&quot;">​</a></h2><p>Nous avons ici des petites machines pour jouer… C&#39;est rigolo… Mais Docker est bien plus puissant que ça <a href="./creer_server_local.html">la suite c&#39;est par ici</a></p>`,67),p=[o];function d(h,c,u,k,m,b){return i(),s("div",null,p)}const F=e(r,[["render",d]]);export{v as __pageData,F as default};
