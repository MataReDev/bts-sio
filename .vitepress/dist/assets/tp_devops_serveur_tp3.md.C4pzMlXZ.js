import{_ as p,c as o,k as s,a,I as i,w as t,U as e,D as r,o as d}from"./chunks/framework.aGaNZw_P.js";const h="/assets/dbeaver.CzGgKrGw.png",H=JSON.parse('{"title":"TP3. Configurer un serveur de base de données","description":"Dans ce TP nous allons voir comment créer un serveur de base de données (MySQL / MariaDB) et comment le configurer.","frontmatter":{"description":"Dans ce TP nous allons voir comment créer un serveur de base de données (MySQL / MariaDB) et comment le configurer."},"headers":[],"relativePath":"tp/devops/serveur/tp3.md","filePath":"tp/devops/serveur/tp3.md","lastUpdated":1704218918000}'),u={name:"tp/devops/serveur/tp3.md"},c=s("h1",{id:"tp3-configurer-un-serveur-de-base-de-donnees",tabindex:"-1"},[a("TP3. Configurer un serveur de base de données "),s("a",{class:"header-anchor",href:"#tp3-configurer-un-serveur-de-base-de-donnees","aria-label":'Permalink to "TP3. Configurer un serveur de base de données"'},"​")],-1),k={class:"details custom-block"},m=s("summary",null,"Sommaire",-1),g={class:"table-of-contents"},b=e('<li><a href="#pre-requis">Pré-requis</a></li><li><a href="#objectifs">Objectifs</a></li><li><a href="#avant-propos-les-environnements">Avant-propos : Les environnements</a></li><li><a href="#la-machine">La machine</a><ul><li><a href="#les-besoins">Les besoins</a></li><li><a href="#les-choix">Les choix</a></li></ul></li>',4),v=s("a",{href:"#creation-de-la-machine"},"Création de la machine",-1),E=s("li",null,[s("a",{href:"#creation-complete-de-la-vm"},"Création complète de la VM")],-1),y={href:"#creation-de-la-vm-via-un-modele"},F=e('<li><a href="#configuration-de-la-machine">Configuration de la machine</a></li><li><a href="#configuration-de-la-base-de-la-machine">Configuration de la base de la machine</a></li><li><a href="#la-base-de-donnees">La base de données</a><ul><li><a href="#installation-de-mariadb">Installation de MariaDB</a></li><li><a href="#configuration">Configuration</a></li><li><a href="#verifier-que-mariadb-est-installe">Vérifier que MariaDB est installé</a></li></ul></li><li><a href="#configurer-phpmyadmin">Configurer PHPMyAdmin</a><ul><li><a href="#installation-de-phpmyadmin">Installation de PHPMyAdmin</a></li><li><a href="#configuration-de-phpmyadmin">Configuration de PHPMyAdmin</a></li><li><a href="#les-utilisateurs-de-base-de-donnees">Les utilisateurs de base de données</a></li><li><a href="#problematique">Problématique</a></li><li><a href="#autoriser-les-connexions-distantes">Autoriser les connexions distantes</a></li><li><a href="#connexion-avec-dbeaver">Connexion avec DBeaver</a></li></ul></li><li><a href="#un-virtual-host-pour-phpmyadmin">Un virtual host pour PHPMyAdmin ?</a></li><li><a href="#conclusion">Conclusion</a></li>',6),C=e('<h2 id="pre-requis" tabindex="-1">Pré-requis <a class="header-anchor" href="#pre-requis" aria-label="Permalink to &quot;Pré-requis&quot;">​</a></h2><p>Pour réaliser ce TP vous devez connaître les éléments suivants :</p><ul><li><a href="/tp/devops/serveur/tp1.html">TP1. Créer une VM sur la ferme.</a></li><li><a href="/cheatsheets/serveur/linux-debian-based.html">Aide mémoire Linux</a></li><li><a href="/cheatsheets/serveur/debian-reseau.html">Configurateur réseau Debian</a></li></ul><h2 id="objectifs" tabindex="-1">Objectifs <a class="header-anchor" href="#objectifs" aria-label="Permalink to &quot;Objectifs&quot;">​</a></h2><p>Ce TP / TD a pour objectif de vous faire découvrir comment configurer un serveur de base de données (MySQL) pour qu&#39;il soit utilisable par un serveur Web (Apache), mais également par une application Client (C#, Java, PHP, etc.).</p><div class="tip custom-block"><p class="custom-block-title">Application cliente ?</p><p>Une application cliente est une application qui se connecte à un serveur pour récupérer des données et les afficher à l&#39;utilisateur. Le découpage entre serveur et client est une notion qui est très importante dans le développement d&#39;applications.</p><p>En effet, cela permet de :</p><ul><li>Répartir les ressources entre plusieurs machines.</li><li>Isoler les données de l&#39;application.</li><li>Sécuriser les données de l&#39;application (accès à la base de données).</li></ul></div><p>Nous allons donc dans ce TP nous concentrer sur <strong>la base de données</strong> et uniquement sur celle-ci.</p><div class="danger custom-block"><p class="custom-block-title">Machine type examen</p><p>Comprendre le découpage multimachine est un élément important pour le passage de l&#39;examen. Il est donc important de bien comprendre ce que nous faisons dans ce TP.</p></div><h2 id="avant-propos-les-environnements" tabindex="-1">Avant-propos : Les environnements <a class="header-anchor" href="#avant-propos-les-environnements" aria-label="Permalink to &quot;Avant-propos : Les environnements&quot;">​</a></h2><p>Rappel, en informatique, il est important de différencier les différents environnements :</p><ul><li><strong>Production</strong> : C&#39;est l&#39;environnement qui est utilisé par les utilisateurs finaux. Il est donc important qu&#39;il soit stable et sécurisé.</li><li><strong>Test</strong> / <strong>Staging</strong> : C&#39;est l&#39;environnement qui est utilisé pour tester les nouvelles fonctionnalités.</li><li><strong>Développement</strong> : C&#39;est l&#39;environnement qui est utilisé par les développeurs pour tester leur code.</li></ul><p>Chaque environnement à un rôle bien précis, il convient donc de travailler différemment sur chacun d&#39;eux.</p><ul><li>Votre machine est votre environnement de <strong>développement</strong>.</li><li>La machine que nous allons créer aujourd&#39;hui peut-être votre environnement distant de base de données (<strong>test</strong> ou <strong>staging</strong>).</li><li>La machine sur laquelle vous allez déployer votre site web de l&#39;AP sera votre environnement de <strong>production</strong>.</li></ul><div class="tip custom-block"><p class="custom-block-title">Gare au nommage</p><p>Nous allons créer dans ce TP / TD une machine qui pourra vous servir de base de données pour vos différents projets. Je vous invite donc à être vigilant sur le nommage de cette machine, pour que celle-ci soit un nom qui va permettre son identification.</p></div>',14),f=s("iframe",{src:"https://giphy.com/embed/si4P9VBMEIhq40i6tT",width:"480",height:"480",frameBorder:"0",class:"giphy-embed",allowFullScreen:""},null,-1),A=e('<h2 id="la-machine" tabindex="-1">La machine <a class="header-anchor" href="#la-machine" aria-label="Permalink to &quot;La machine&quot;">​</a></h2><p>Pour réaliser ce TP, je vous propose que l&#39;on réfléchisse ensemble sur la machine que nous allons créer.</p><h3 id="les-besoins" tabindex="-1">Les besoins <a class="header-anchor" href="#les-besoins" aria-label="Permalink to &quot;Les besoins&quot;">​</a></h3><p>Les besoins de cette machine sont les suivants :</p><ul><li>Elle doit être accessible uniquement depuis le réseau du lycée.</li><li>Elle doit permettre de stocker plusieurs bases de données.</li><li>Elle doit avoir un accès SSH sécurisé.</li><li>Elle doit permettre de conserver vos bases de données pour les deux prochaines années.</li><li>Elle doit être administrable à distance.</li></ul><h3 id="les-choix" tabindex="-1">Les choix <a class="header-anchor" href="#les-choix" aria-label="Permalink to &quot;Les choix&quot;">​</a></h3><p>Voilà la liste des choix que nous allons devoir faire pour créer cette machine :</p><ul><li>Espace disque :</li><li>Mémoire vive :</li><li>Processeur :</li><li>OS :</li><li>Logiciels :</li></ul><p>Avant de créer votre machine, je vous invite à réfléchir sur ces choix. Une fois votre réflexion terminée, nous allons débriefer ensemble.</p><details class="details custom-block"><summary>Une réponse possible</summary><ul><li>Espace disque : 10 Go.</li><li>Mémoire vive : 1 Go.</li><li>Processeur : 1 vCPU.</li><li>OS : Debian 11.5.</li><li>Logiciels : MySQL / MariaDB, SSH, Apache, PHP.</li><li>Accès SSH : Sans mot de passe, uniquement avec une clé SSH.</li><li>Votre machine <strong>ne doit pas avoir de d’interface graphique</strong> (inutile pour un serveur).</li></ul><p>Pourquoi cette configuration ? Apache et PHP sont installés, car, nous allons mettre sur votre serveur PHPMyAdmin. Si vous ne souhaitez pas installer PHPMyAdmin, vous pouvez supprimer Apache et PHP.</p></details><h2 id="creation-de-la-machine" tabindex="-1">Création de la machine <a class="header-anchor" href="#creation-de-la-machine" aria-label="Permalink to &quot;Création de la machine&quot;">​</a></h2><p>Maintenant que notre besoin est défini, nous allons pouvoir créer notre machine.</p><div class="tip custom-block"><p class="custom-block-title">Des points à vérifier</p><ul><li>Votre machine doit posséder une IP fixe (à générer via le configurateur réseau, en prenant soin de ne pas utiliser une IP déjà utilisée).</li><li>Votre machine doit être à jour (<code>apt update &amp;&amp; apt upgrade</code>).</li><li>Votre machine doit avoir un accès SSH sécurisé (via échange de clé).</li></ul></div><div class="danger custom-block"><p class="custom-block-title">Je veux une fiche serveur</p><p>Je vous rappelle que vous <strong>devez</strong> avoir une fiche serveur pour chaque machine que vous créez. Cette fiche doit être complète et doit contenir les informations de connexion à votre machine (les IP, Login, Mot de passe, etc.).</p></div><h3 id="creation-complete-de-la-vm" tabindex="-1">Création complète de la VM <a class="header-anchor" href="#creation-complete-de-la-vm" aria-label="Permalink to &quot;Création complète de la VM&quot;">​</a></h3><p>Dans cette version, vous allez devoir créer la VM depuis le début. Vous avez plus d&#39;options, mais vous devez réaliser l&#39;installation du système d&#39;exploitation.</p><ul><li><a href="./tp1.html">Consulter la documentation</a></li></ul>',17),P={id:"creation-de-la-vm-via-un-modele",tabindex:"-1"},q=s("a",{class:"header-anchor",href:"#creation-de-la-vm-via-un-modele","aria-label":'Permalink to "Création de la VM via un modèle <Badge type="tip" text="Meilleure solution" vertical="top" />"'},"​",-1),B=e(`<p>Dans cette version, vous allez créer votre VM à partir d&#39;un modèle. Le modèle contient déjà le système d&#39;exploitation et les logiciels installés. Vous n&#39;avez plus qu&#39;à configurer la VM (réseau, utilisateur, etc.).</p><ul><li><a href="./tp1alt.html">Consulter la documentation</a></li></ul><h2 id="configuration-de-la-machine" tabindex="-1">Configuration de la machine <a class="header-anchor" href="#configuration-de-la-machine" aria-label="Permalink to &quot;Configuration de la machine&quot;">​</a></h2><p>Je vous laisse suivre le TP suivant pour configurer votre machine :</p><ul><li><a href="/tp/devops/serveur/tp2.html">TP2. Avoir une machine Debian avec Apache + PHP</a></li><li><strong>ou la synthèse de ce TP</strong> : <a href="/cheatsheets/serveur/debian-web.html">Configurer une serveur Debian pour le Web</a></li></ul><details class="details custom-block"><summary>Vous souhaitez juste les commandes ?</summary><p>Voici la procédure de création de la partie PHP + Apache :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> lsb-release</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-transport-https</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gnupg2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ca-certificates</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apt/trusted.gpg.d/php.gpg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://packages.sury.org/php/apt.gpg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;echo &quot;deb https://packages.sury.org/php/ $(lsb_release -sc) main&quot; &gt; /etc/apt/sources.list.d/php.list&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Installer Apache + PHP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> zip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open-vm-tools</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-fpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-cli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-{bz2,curl,mbstring,intl,pdo,mysql,gd,xml}</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Activer PHP dans Apache</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2enmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> proxy_fcgi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setenvif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> headers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2enconf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> php8.2-fpm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Active  Apache</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Vérifier la version de PHP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Affiche OK si le serveur web est accessible.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --head</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://localhost:80</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;HTTP/1.[01] [23]..&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Le serveur écoute bien sur le port 80.&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ||</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Aucun serveur en écoute sur le port 80.&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div></details><h2 id="configuration-de-la-base-de-la-machine" tabindex="-1">Configuration de la base de la machine <a class="header-anchor" href="#configuration-de-la-base-de-la-machine" aria-label="Permalink to &quot;Configuration de la base de la machine&quot;">​</a></h2><p>Si vous avez correctement suivi les TP précédents, vous devriez avoir une machine qui ressemble à ça :</p><ul><li>Logiciels installés : SSH, Apache, PHP, MySQL, vim.</li><li><strong>VMWare Tools installé</strong>. (<code>apt install open-vm-tools</code>).</li><li>Accès SSH : Via échange de clé.</li><li>Accès Web fonctionnel (via le port 80).</li></ul><div class="tip custom-block"><p class="custom-block-title">VMWare Tools</p><p>Les VMWare Tools sont des logiciels qui permettent d&#39;optimiser l&#39;utilisation de la machine virtuelle. Ils sont <strong>très</strong> importants pour la performance de votre machine, vous <strong>devez</strong> donc les installer (sinon Bruno ne vous aime plus).</p></div><h2 id="la-base-de-donnees" tabindex="-1">La base de données <a class="header-anchor" href="#la-base-de-donnees" aria-label="Permalink to &quot;La base de données&quot;">​</a></h2><p>Notre machine est maintenant prête à accueillir le serveur de base de données. Nous avons plusieurs possibilités :</p><ul><li>MariaDB</li><li>MySQL</li><li>PostgreSQL</li></ul><p>Dans ce TP, nous allons utiliser MariaDB. Pourquoi ? Car celui-ci est disponible de base sur debian.</p><h3 id="installation-de-mariadb" tabindex="-1">Installation de MariaDB <a class="header-anchor" href="#installation-de-mariadb" aria-label="Permalink to &quot;Installation de MariaDB&quot;">​</a></h3><p>Vous l&#39;avez compris, installer un logiciel sur Linux est très simple, une seule commande suffit :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mariadb-client</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Pourquoi ces deux paquets ? <code>mariadb-server</code> est le serveur de base de données, et <code>mariadb-client</code> est le client de base de données. Le client est utilisé pour se connecter <strong>localement</strong> à la base de données.</p><div class="tip custom-block"><p class="custom-block-title">Arrêtons-nous un instant</p><ul><li>Pourquoi faire un update avant d&#39;installer un paquet ?</li><li>À quoi correspond le <code>-y</code> à la fin de la commande ?</li><li>Selon vous, est-ce que votre serveur de base de données est démarré ? Si oui, comment le vérifier ?</li><li>Que veux dire <strong>localement</strong> ?</li></ul></div><h3 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h3><p>Avant d&#39;utiliser MariaDB, nous devons configurer le mot de passe de l&#39;utilisateur <code>root</code>. Pour cela, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql_secure_installation</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va vous demander de rentrer le mot de passe actuel de l&#39;utilisateur <code>root</code>. Comme vous venez d&#39;installer MariaDB.</p><div class="tip custom-block"><p class="custom-block-title">Arrêtons-nous un instant</p><ul><li>Qu&#39;est-ce que <code>mysql_secure_installation</code> ?</li><li>Pourquoi est-ce important de changer le mot de passe de l&#39;utilisateur <code>root</code> ?</li><li>Quel mot de passe avez-vous choisi ? Pourquoi ?</li></ul></div><h3 id="verifier-que-mariadb-est-installe" tabindex="-1">Vérifier que MariaDB est installé <a class="header-anchor" href="#verifier-que-mariadb-est-installe" aria-label="Permalink to &quot;Vérifier que MariaDB est installé&quot;">​</a></h3><p>Pour vérifier que MariaDB est installé, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va vous demander le mot de passe de l&#39;utilisateur <code>root</code>. Si vous avez bien suivi les étapes précédentes, vous devriez être connecté à MariaDB.</p><h2 id="configurer-phpmyadmin" tabindex="-1">Configurer PHPMyAdmin <a class="header-anchor" href="#configurer-phpmyadmin" aria-label="Permalink to &quot;Configurer PHPMyAdmin&quot;">​</a></h2><p>Notre serveur de base de données est maintenant installé, mais nous n&#39;avons pas d&#39;interface graphique pour le gérer. Pour cela, nous allons installer PHPMyAdmin.</p><div class="danger custom-block"><p class="custom-block-title">Un instant</p><p>Une base de données ≠ de PHPMyAdmin. PHPMyAdmin est un logiciel qui permet de gérer une base de données. Il est donc possible d&#39;utiliser une base de données sans PHPMyAdmin. Des alternatives existent, en fonction de vos besoins, il n&#39;est peut-être pas nécessaire d&#39;installer Apache + PHP + PHPMyAdmin sur votre serveur de base de données.</p><p>Dans la suite du TP/TD nous allons voir comment administrer notre base de données <strong>sans</strong> PHPMyAdmin. Les alternatives sont les suivantes :</p><ul><li>Utiliser la ligne de commande (compliqué).</li><li>Utiliser un logiciel tiers (comme HeidiSQL, DBeaver, etc.).</li><li>Utiliser un équivalent de PHPMyAdmin (comme Adminer).</li><li>Utiliser l&#39;outil intégré à votre IDE (comme dans PHPStorm, VsCode, etc).</li></ul><p>Quel que soit votre choix, vous devez être très vigilant dans votre vocabulaire pour ne <strong>jamais mélanger</strong> le terme de base de données et celui de PHPMyAdmin (<strong>au risque de passer pour un débutant</strong>).</p></div><p>Avant d&#39;aller plus loin, regardons ce que nous allons installer. PHPMyAdmin est un site web qui permet de gérer une base de données. Il est donc nécessaire d&#39;avoir un serveur web (Apache) et un langage de programmation (PHP) pour pouvoir l&#39;utiliser. Si vous avez suivi les étapes précédentes, vous devriez déjà avoir Apache et PHP installés.</p><h3 id="installation-de-phpmyadmin" tabindex="-1">Installation de PHPMyAdmin <a class="header-anchor" href="#installation-de-phpmyadmin" aria-label="Permalink to &quot;Installation de PHPMyAdmin&quot;">​</a></h3><p>Pour installer phpMyAdmin, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unzip</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/html</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://files.phpmyadmin.net/phpMyAdmin/5.2.0/phpMyAdmin-5.2.0-all-languages.zip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unzip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phpMyAdmin-5.2.0-all-languages.zip</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phpMyAdmin-5.2.0-all-languages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phpmyadmin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phpMyAdmin-5.2.0-all-languages.zip</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>L&#39;installation est le résultat de plusieurs commandes :</p><ul><li><code>apt install unzip</code> : on installe le logiciel <code>unzip</code>. C&#39;est un logiciel qui permet de décompresser des fichiers.</li><li><code>cd /var/www/html</code> : on se déplace dans le dossier <code>/var/www/html</code>.</li><li><code>wget …</code> : on télécharge le fichier <code>phpMyAdmin-5.2.0-all-languages.zip</code>. Depuis les serveurs de phpMyAdmin.</li><li><code>unzip …</code> : on décompresse le fichier <code>phpMyAdmin-5.2.0-all-languages.zip</code>.</li><li><code>mv …</code> : on renomme le dossier <code>phpMyAdmin-5.2.0-all-languages</code> en <code>phpmyadmin</code>. Car il est plus simple de taper <code>phpmyadmin</code> que <code>phpMyAdmin-5.2.0-all-languages</code>.</li><li><code>rm …</code> : on supprime le fichier <code>phpMyAdmin-5.2.0-all-languages.zip</code>. Car il n&#39;est plus utile.</li></ul><div class="tip custom-block"><p class="custom-block-title">Arrêtons-nous un instant</p><ul><li>Pourquoi utilisons-nous la version du site web de phpMyAdmin ? Et pas la version du dépôt Debian ?</li><li>À votre avis est-ce suffisant pour que phpMyAdmin fonctionne ?</li></ul></div><h3 id="configuration-de-phpmyadmin" tabindex="-1">Configuration de PHPMyAdmin <a class="header-anchor" href="#configuration-de-phpmyadmin" aria-label="Permalink to &quot;Configuration de PHPMyAdmin&quot;">​</a></h3><p>PHPMyAdmin est maintenant installé, il ne nécessite pas de configuration particulière. Il suffit de se rendre sur l&#39;adresse suivante : <code>http://&lt;adresse_ip&gt;/phpmyadmin</code>.</p><div class="tip custom-block"><p class="custom-block-title">Dans un prochain TP/TD</p><p>Dans le prochain TP nous allons (re)voir pour configurer Apache avec des VirtualHosts. L&#39;objectif ? <strong>Héberger plusieurs sites web sur un seul serveur</strong>.</p></div><h3 id="les-utilisateurs-de-base-de-donnees" tabindex="-1">Les utilisateurs de base de données <a class="header-anchor" href="#les-utilisateurs-de-base-de-donnees" aria-label="Permalink to &quot;Les utilisateurs de base de données&quot;">​</a></h3><p>Comme pour la partie serveur, il est vivement déconseillé (comprendre ici, je ne veux jamais voir quelqu&#39;un en root), d&#39;utiliser l&#39;utilisateur <code>root</code> pour administrer sa base de données. Pour cela, nous allons créer un utilisateur <code>&lt;votre-nom&gt;</code> qui aura des droits limités sur la base de données.</p><p>Avant de continuer, réfléchissons ensemble à la raison pour laquelle nous ne devons pas utiliser l&#39;utilisateur <code>root</code> pour administrer notre base de données.</p><details class="details custom-block"><summary>Réponse possible</summary><ul><li>L&#39;utilisateur <code>root</code> est un utilisateur très puissant. Il a accès à toutes les bases de données, et peut donc faire n&#39;importe quoi.</li><li>L&#39;utilisateur <code>root</code> utilisé dans une application web est un gros risque de sécurité. Si quelqu&#39;un parvient à se connecter à votre application web, il pourra faire n&#39;importe quoi sur votre base de données.</li><li>L&#39;utilisateur <code>root</code> est l&#39;utilisateur par défaut, c&#39;est donc le premier utilisateur que les pirates vont essayer de pirater.</li></ul><p>Je vous déconseille donc vivement d&#39;utiliser le compte <code>root</code> pour quelques usages. Il est vivement conseillé d&#39;utiliser un compte avec des droits limités, et idéalement, de créer un compte différent pour chaque application web.</p></details><h4 id="avant-propos" tabindex="-1">Avant-propos <a class="header-anchor" href="#avant-propos" aria-label="Permalink to &quot;Avant-propos&quot;">​</a></h4><p>La première étape est de créer l&#39;utilisateur. Pour ça nous avons plusieurs possibilités :</p><ul><li>Soit nous utilisons la ligne de commande (<code>mysql</code> directement depuis le serveur).</li><li>Soit nous utilisons <code>phpMyAdmin</code>.</li></ul><div class="tip custom-block"><p class="custom-block-title">il n&#39;y a pas de bonne ou de mauvaise solution</p><ul><li>La ligne de commande est plus rapide, mais plus compliquée.</li><li>PHPMyAdmin c&#39;est plus simple, mais un peu plus long.</li></ul><p>Utilisez la méthode qui vous convient le mieux.</p></div><h4 id="via-la-ligne-de-commande" tabindex="-1">Via la ligne de commande <a class="header-anchor" href="#via-la-ligne-de-commande" aria-label="Permalink to &quot;Via la ligne de commande&quot;">​</a></h4><p>Pour créer un utilisateur, nous allons utiliser la commande <code>CREATE USER</code>. Cette commande prend en paramètre le nom de l&#39;utilisateur, et son mot de passe. Pour créer l&#39;utilisateur <code>&lt;votre-nom&gt;</code> avec le mot de passe de votre choix, nous allons utiliser la commande suivante :</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># Création</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> USER </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&lt;votre-nom&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;votre-mot-de-passe&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># Les droits</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">GRANT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ALL PRIVILEGES </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ON</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TO</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;votre-nom&gt;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># Rafraîchir les privilèges</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLUSH PRIVILEGES;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>Un peu d&#39;explication :</p><ul><li>le <code>%</code> signifie que l&#39;utilisateur peut se connecter depuis n&#39;importe quelle adresse IP.</li><li><code>*.*</code> signifie que l&#39;utilisateur a tous les droits sur toutes les bases de données. (À votre avis, est-ce une bonne idée ?)</li><li><code>FLUSH PRIVILEGES</code> permet de rafraîchir les privilèges. C&#39;est une commande qui est nécessaire pour que les modifications soient prises en compte.</li></ul><h4 id="via-phpmyadmin" tabindex="-1">Via PHPMyAdmin <a class="header-anchor" href="#via-phpmyadmin" aria-label="Permalink to &quot;Via PHPMyAdmin&quot;">​</a></h4><p>Pour créer un utilisateur, nous allons utiliser l&#39;onglet <code>Utilisateurs</code> de PHPMyAdmin. Pour cela, il faut se rendre sur l&#39;adresse suivante : <code>http://&lt;adresse_ip&gt;/</code>.</p><h4 id="conclusion-intermediaire" tabindex="-1">Conclusion intermédiaire <a class="header-anchor" href="#conclusion-intermediaire" aria-label="Permalink to &quot;Conclusion intermédiaire&quot;">​</a></h4><p>Comme sur un serveur, comprendre que plusieurs utilisateurs sont nécessaires sur une base de données est très important. À l&#39;avenir vous devez essayer de ne jamais utiliser l&#39;utilisateur <code>root</code> pour vos applications. Je dirais même plus, si en stage ou dans une application web, vous êtes amené à utiliser l&#39;utilisateur <code>root</code>, je vous conseille vivement de l&#39;indiquer à votre tuteur. Il y a de fortes chances que votre tuteur vous demande de changer cela.</p><p>Avant de continuer le TP, je vous laisse valider que PHPMyAdmin fonctionne correctement en répondant à la problématique suivante :</p><h3 id="problematique" tabindex="-1">Problématique <a class="header-anchor" href="#problematique" aria-label="Permalink to &quot;Problématique&quot;">​</a></h3><p>L&#39;entreprise BTS SIO, vous demande de numériser la gestion des absences de ses étudiants. Pour cela, vous devez créer une base de données qui contiendra les informations suivantes :</p><ul><li>Pour les étudiants : nom, prénom, classe, date de naissance, adresse, téléphone, email.</li><li>Pour les absences : date, heure de début, heure de fin, motif, étudiant.</li></ul><p>Chaque étudiant peut avoir plusieurs absences. Chaque absence est liée à un seul étudiant. Les étudiants sont répartis en 2 classes : <strong>SIO1</strong> et <strong>SIO2</strong>, et en deux niveaux : <strong>SLAM</strong> et <strong>SISR</strong>.</p><details class="details custom-block"><summary>Réponse possible (à ne regarder qu&#39;en cas de blocage)</summary><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> gestion_absences</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">USE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gestion_absences;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> classe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id_classe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTO_INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  nom_classe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">250</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INSERT INTO</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classe (nom_classe) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VALUES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SIO1 SLAM&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SIO1 SISR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SIO2 SLAM&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), (</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;SIO2 SISR&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> etudiant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id_etudiant </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTO_INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  prenom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id_classe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  date_naissance </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  adresse </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  telephone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  email </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id_classe) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">REFERENCES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> classe(id_classe)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> absence</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id_absence </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AUTO_INCREMENT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">PRIMARY KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  date_absence </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  heure_debut </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  heure_fin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  motif </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">VARCHAR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id_etudiant </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">INT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NOT NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  FOREIGN KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (id_etudiant) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">REFERENCES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> etudiant(id_etudiant)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="autres-logiciels-pour-gerer-une-base-de-donnees" tabindex="-1">Autres logiciels pour gérer une base de données <a class="header-anchor" href="#autres-logiciels-pour-gerer-une-base-de-donnees" aria-label="Permalink to &quot;Autres logiciels pour gérer une base de données&quot;">​</a></h2><p>Nous avons pour l&#39;instant vu comment installer MariaDB et PHPMyAdmin. Mais il existe d&#39;autres logiciels pour gérer une base de données. Nous allons voir ici comment installer ces logiciels. Pour que les autres logiciels fonctionnent, il faut que vous autorisiez le port 3306 dans la configuration de MariaDB.</p><div class="warning custom-block"><p class="custom-block-title">Rappel sur les ports</p><p>Le port est un numéro qui permet de différencier les différents services qui tournent sur un serveur. Par exemple, le port 80 est utilisé par le serveur web Apache. Le port 22 est utilisé par le service SSH. Le port 3306 est utilisé par le service MariaDB. De base, le port 3306 n&#39;écoute que les connexions locales. Pour que les autres logiciels puissent se connecter à MariaDB, il faut autoriser les connexions distantes.</p><p>🚨 <strong>Point cyber</strong>, VOUS NE DEVEZ JAMAIS OUVRIR LE PORT 3306 SUR INTERNET. VOUS DEVEZ LE LAISSER OUVERT UNIQUEMENT SUR VOTRE RÉSEAU LOCAL. 🚨</p></div></details><h3 id="autoriser-les-connexions-distantes" tabindex="-1">Autoriser les connexions distantes <a class="header-anchor" href="#autoriser-les-connexions-distantes" aria-label="Permalink to &quot;Autoriser les connexions distantes&quot;">​</a></h3><p>La configuration se fait dans le fichier <code>/etc/mysql/mariadb.conf.d/50-server.cnf</code>.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/mysql/mariadb.conf.d/50-server.cnf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Modifier la ligne <code>bind-address</code> par la ligne suivante dans la section <code>[mysqld]</code>.</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">bind-address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = 0.0.0.0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Redémarrer le serveur MySQL</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mysql</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Comment lire la ligne ajoutée ?</p><ul><li><code>bind-address</code> : c&#39;est la variable qui permet de définir l&#39;adresse IP sur laquelle MariaDB va écouter les connexions.</li><li><code>0.0.0.0</code> : Cette valeur signifie que MariaDB va écouter sur toutes les adresses IP disponibles sur le serveur.</li></ul></div><h3 id="connexion-avec-dbeaver" tabindex="-1">Connexion avec DBeaver <a class="header-anchor" href="#connexion-avec-dbeaver" aria-label="Permalink to &quot;Connexion avec DBeaver&quot;">​</a></h3><p>Maintenant que MariaDB est configuré pour accepter les connexions distantes, nous allons voir comment se connecter à MariaDB avec DBeaver.</p><p>Dbeaver est déjà installé sur votre machine. Vous pouvez le lancer via le menu démarrer.</p><p><img src="`+h+`" alt="DBeaver" loading="lazy"></p><p>Une fois DBeaver lancé, vous devriez pouvoir vous connecter à MariaDB en utilisant les informations suivantes :</p><ul><li><strong>Hôte</strong> : <code>&lt;adresse_ip&gt;</code></li><li><strong>Port</strong> : <code>3306</code></li></ul><h2 id="un-virtual-host-pour-phpmyadmin" tabindex="-1">Un virtual host pour PHPMyAdmin ? <a class="header-anchor" href="#un-virtual-host-pour-phpmyadmin" aria-label="Permalink to &quot;Un virtual host pour PHPMyAdmin ?&quot;">​</a></h2><p>Si vous souhaiter avoir un virtual host pour PHPMyAdmin, vous pouvez suivre les instructions suivantes :</p><p>⚠️ Cette partie est optionnelle. Si vous ne souhaitez pas avoir un virtual host pour PHPMyAdmin, vous pouvez passer à la partie suivante.</p><details class="details custom-block"><summary>Voir les instructions</summary><h3 id="creer-un-virtual-host-dedie-a-phpmyadmin" tabindex="-1">Créer un virtual host dédié à phpMyAdmin <a class="header-anchor" href="#creer-un-virtual-host-dedie-a-phpmyadmin" aria-label="Permalink to &quot;Créer un virtual host dédié à phpMyAdmin&quot;">​</a></h3><p>Pour créer un virtual host, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/apache2/sites-available/phpmyadmin.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va créer un fichier <code>phpmyadmin.conf</code> dans le dossier <code>/etc/apache2/sites-available</code>. Ce fichier va contenir la configuration de notre virtual host.</p><p>Ce fichier va contenir la configuration de notre virtual host. Vous pouvez copier-coller le code suivant :</p><div class="language-apache vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">apache</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VirtualHost</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> *:9090</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ServerAdmin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> webmaster@localhost</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    DocumentRoot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /var/www/html/phpmyadmin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/www/html/phpmyadmin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        Options</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Indexes FollowSymLinks</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        AllowOverride</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> All</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        Require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> all granted</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    ErrorLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${APACHE_LOG_DIR}/error.log</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    CustomLog</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> \${APACHE_LOG_DIR}/access.log combined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">VirtualHost</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Pour activer le virtual host, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">a2ensite</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> phpmyadmin</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va activer le virtual host <code>phpmyadmin.conf</code>. Vous pouvez maintenant redémarrer Apache pour que les modifications soient prises en compte :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></details><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>Dans ce TP, nous avons vu comment installer MariaDB et PHPMyAdmin. Nous avons aussi vu comment configurer MariaDB pour qu&#39;il accepte les connexions distantes. Vous pouvez maintenant garder ce serveur pour vous entraîner à créer des bases de données et à les gérer.</p><p><a href="/cheatsheets/serveur/debian-web.html">N&#39;oubliez pas, vous avez une aide mémoire récapitulant les commandes vues dans ce TP</a></p>`,85),D=s("iframe",{src:"https://giphy.com/embed/fdyZ3qI0GVZC0",width:"480",height:"270",frameBorder:"0",class:"giphy-embed",allowFullScreen:""},null,-1);function _(M,T,L,S,x,I){const n=r("Badge"),l=r("center");return d(),o("div",null,[c,s("details",k,[m,s("nav",g,[s("ul",null,[b,s("li",null,[v,s("ul",null,[E,s("li",null,[s("a",y,[a("Création de la VM via un modèle "),i(n,{type:"tip",text:"Meilleure solution",vertical:"top"})])])])]),F])])]),C,i(l,null,{default:t(()=>[f]),_:1}),A,s("h3",P,[a("Création de la VM via un modèle "),i(n,{type:"tip",text:"Meilleure solution",vertical:"top"}),a(),q]),B,i(l,null,{default:t(()=>[D]),_:1})])}const R=p(u,[["render",_]]);export{H as __pageData,R as default};
