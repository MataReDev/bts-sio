import{_ as s,c as e,o as i,U as a}from"./chunks/framework.aGaNZw_P.js";const n="/assets/salt.Bu8-6z8K.png",t="/assets/expositions.KWNztzFs.png",l="/assets/random.Cg5NCP6U.png",r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG8AAABvAQMAAADYCwwjAAAABlBMVEUAAAD///+l2Z/dAAAAAnRSTlP//8i138cAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAEsSURBVDiN1dSxjcQgEAXQsQjI1g0g0QYZLUEDcNuA3RIZbVhyA5ARIM+Nfbs+XQIkGxwieQS2/zBjwD8L/gcTgI/1ARVAdpmxGo5fXHgcYBAWq1PC8CE6Df58whANpz1GrDYCQL0/skHKa6OgfcdvkFYOdPhb2AaTqnOhytQp9HloPJSkSjot+1TVFkGVdIBd5sgWYDniMwwQNx/2pMAp2WUCltS+qH199VWLOVQDm+Ps+OmrJqmGa9gAKAV2iXEznC2KrWWAga3x6vCrkm3mSEmpCWEufSLKFcVDVT9Ayut4nRGmiF3SSue1yhxkl1fH4sGFLdglzYLTm40yvQenxXMk5aFhel1oh4aapNC1DtEjtet+v6jFa36NlvkdocEzbwHg8jnAz/1yP8Vv2aciceX4I54AAAAASUVORK5CYII=",p="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHsAAAB7AQMAAABuCW08AAAABlBMVEUAAAD///+l2Z/dAAAAAnRSTlP//8i138cAAAAJcEhZcwAACxIAAAsSAdLdfvwAAAFySURBVEiJ1dU9bsQgEAXgsSjo1hdA4hp0XMm+gH8uEK5ExzWQfAG7c4E8eXbWSZQiTKQUCdrC+iRjeDCzxF8G/WdYiQbPk1tCpEYGG5fOWU4LJzzLIJqBSr/nNlEvhs7hbTP+BPD40NTKgUufMuk8fiy9AsijT+b8fQRUgWuowEv4fAzfwkqGtGnZkDtNAofjFQdFak6lkcGqacBBYUQVZIAMXq6DGnwZZXDoMpxfNuQVywBjTtRGGxLPMlg13s5NWg5ngwywp0mrsGNnZhQCEyJ/eDvdc1ThIHuljlSWWQiuNLs9kF+6z7YGnNRxpk70TL0Oh0bNnTN190qrsEV8DftD6m8rlQBKBwW0bPvzBtWBcQvUFunh8iiEiMhxvBa3e5MBxpZQRrln08vgrOxo54RL9CyPKqB/jLG0O7753nJqcDW2yWOyO3UB9EykqfN2lkNCuy2kyygE9HWvNvR1zkJAHp037U5N5CCD3/hb+xvwCgSSWFJG/5I8AAAAAElFTkSuQmCC",o="/assets/toutes_les_etapes.DHeKayKI.png",h="/assets/faille.h5-JkXzS.png",d="/assets/tableau.P1lFRkSb.png",A=JSON.parse('{"title":"La méthode OWASP","description":"La méthode OWASP ! Prévenir plutôt que guérir…","frontmatter":{"description":"La méthode OWASP ! Prévenir plutôt que guérir…"},"headers":[],"relativePath":"cheatsheets/owasp/index.md","filePath":"cheatsheets/owasp/index.md","lastUpdated":1704112852000}'),u={name:"cheatsheets/owasp/index.md"},c=a('<h1 id="la-methode-owasp" tabindex="-1">La méthode OWASP <a class="header-anchor" href="#la-methode-owasp" aria-label="Permalink to &quot;La méthode OWASP&quot;">​</a></h1><details class="details custom-block"><summary>Table des matières</summary><nav class="table-of-contents"><ul><li><a href="#comment-se-tenir-a-jour">Comment se tenir à jour ?</a></li><li><a href="#les-mots-de-passe">Les mots de passe</a><ul><li><a href="#principes-de-base">Principes de base</a></li><li><a href="#des-algorithmes-le-bcrypt">Des algorithmes : Le bcrypt</a></li></ul></li><li><a href="#resume">Résumé :</a></li><li><a href="#authentification-a-plusieurs-facteurs">Authentification à plusieurs facteurs</a><ul><li><a href="#les-impacts-lies-a-la-securite">Les impacts liés à la sécurité</a></li><li><a href="#les-types-de-failles">Les types de failles</a></li><li><a href="#le-social-engineering">Le Social Engineering</a></li></ul></li><li><a href="#integrer-la-securite-a-toutes-les-etapes">Intégrer la sécurité à toutes les étapes</a><ul><li><a href="#assurer-la-qualite">Assurer la qualité</a></li><li><a href="#open-web-application-security-project-owasp">Open Web Application Security Project (OWASP)</a></li><li><a href="#les-failles">Les failles</a></li><li><a href="#les-injections">Les Injections</a></li><li><a href="#violation-de-gestion-d-authentification-et-de-session">Violation de Gestion d’Authentification et de Session</a></li><li><a href="#cross-site-scripting-xss">Cross-Site Scripting (XSS)</a></li><li><a href="#references-directes-non-securisees-a-un-objet">Références directes non sécurisées à un objet</a></li><li><a href="#mauvaise-configuration-securite">Mauvaise configuration Sécurité</a></li><li><a href="#exposition-de-donnees-sensibles">Exposition de données sensibles</a></li><li><a href="#manque-de-controle-d-acces-au-niveau-fonctionnel">Manque de contrôle d’accès au niveau fonctionnel</a></li><li><a href="#falsification-de-requete-intersite-csrf">Falsification de requête intersite (CSRF)</a></li><li><a href="#utilisation-de-composants-avec-des-vulnerabilites-connues">Utilisation de composants avec des vulnérabilités connues</a></li><li><a href="#redirections-et-renvois-non-valides">Redirections et Renvois non validés</a></li><li><a href="#mais-une-faille-c-est-quoi">Mais, une faille c’est quoi ?</a></li></ul></li><li><a href="#les-outils-owasp">Les outils OWASP</a></li><li><a href="#synthese-owasp">Synthèse OWASP</a></li></ul></nav></details><h2 id="comment-se-tenir-a-jour" tabindex="-1">Comment se tenir à jour ? <a class="header-anchor" href="#comment-se-tenir-a-jour" aria-label="Permalink to &quot;Comment se tenir à jour ?&quot;">​</a></h2><p>Prévenir plutôt que guérir… Quelques sites à surveiller :</p><ul><li><a href="https://www.us-cert.gov/" target="_blank" rel="noreferrer">US CERT (LA SOURCE)</a></li><li><a href="http://thehackernews.com/" target="_blank" rel="noreferrer">The Hacker News</a></li><li><a href="https://www.zataz.com/" target="_blank" rel="noreferrer">Zataz</a></li><li><a href="https://www.reddit.com/r/netsec/" target="_blank" rel="noreferrer">Reddit NetSec</a></li><li><a href="https://www.nextinpact.com/" target="_blank" rel="noreferrer">Next INpact</a> (~payant)</li><li>Google Actu</li></ul><div class="tip custom-block"><p class="custom-block-title">Important</p><p>Vous êtes la première ligne d’informations !</p></div><h2 id="les-mots-de-passe" tabindex="-1">Les mots de passe <a class="header-anchor" href="#les-mots-de-passe" aria-label="Permalink to &quot;Les mots de passe&quot;">​</a></h2><p>Zoom sur les mots de passe :</p><ul><li>Un mot de passe ne doit jamais être stocké en claire.</li><li>Un mot de passe doit être haché (non réversible).</li><li>Un mot de passe doit être salé (ajout d’une chaîne aléatoire).</li><li>Un mot de passe seul n&#39;est souvent pas suffisant (Double authentification).</li></ul><h3 id="principes-de-base" tabindex="-1">Principes de base <a class="header-anchor" href="#principes-de-base" aria-label="Permalink to &quot;Principes de base&quot;">​</a></h3><p>Avoir un mot de passe hashé ne suffit pas. Il faut aussi le saler.</p><p><img src="'+n+'" alt="Salage" loading="lazy"></p><p>Le salage est une technique qui permet d’ajouter une chaîne aléatoire au mot de passe avant (ou après) de le hacher. Idéalement le sel est différent par utilisateur, cela permet de rendre le mot de passe unique pour chaque utilisateur.</p><h3 id="des-algorithmes-le-bcrypt" tabindex="-1">Des algorithmes : Le bcrypt <a class="header-anchor" href="#des-algorithmes-le-bcrypt" aria-label="Permalink to &quot;Des algorithmes : Le bcrypt&quot;">​</a></h3><p>Le bcrypt est un algorithme de hachage qui :</p><ul><li>Intègre le sel.</li><li>Intègre un coût (nombre d’itération). Plus le coût est élevé, plus le hachage est long (et donc plus sécurisé).</li><li>Intègre un hachage (SHA-256).</li></ul><h2 id="resume" tabindex="-1">Résumé : <a class="header-anchor" href="#resume" aria-label="Permalink to &quot;Résumé :&quot;">​</a></h2><p>Les mots de passe :</p><ul><li>Un mot de passe ne doit jamais être stocké en claire. Il doit être haché (non réversible) et salé (ajout d’une chaîne aléatoire).</li><li>Le sel peut-être différent pour chaque utilisateur ou global pour tous les utilisateurs. Celui-ci doit être placé avant ou après le mot de passe, il sera utilisé également pour vérifier le mot de passe.</li><li>Le bcrypt est un algorithme de hachage qui intègre le sel, le coût et le hachage (SHA-256).</li></ul><h2 id="authentification-a-plusieurs-facteurs" tabindex="-1">Authentification à plusieurs facteurs <a class="header-anchor" href="#authentification-a-plusieurs-facteurs" aria-label="Permalink to &quot;Authentification à plusieurs facteurs&quot;">​</a></h2><p>3 formes d&#39;authentification :</p><ul><li>Mémorielle qui représente une chose que l&#39;intéressé connaît (un secret),</li><li>Matérielle qui se réfère à quelque chose qu&#39;il possède (un objet),</li><li>Corporelle qui utilise un trait physique de l&#39;utilisateur (une biométrie).</li></ul><p>Des <strong>outils</strong> :</p><ul><li><strong>Mot de passe :</strong> Un mot de passe avec un niveau de sécurité suffisant (longueur, caractères spéciaux, majuscules, minuscules, chiffres).</li><li><strong>Application :</strong> OTP (One Time Password) : SMS, Google Authenticator, Authy, Yubikey.</li><li><strong>Objet physique :</strong> U2F (Universal 2nd Factor) : Clé USB, Yubikey.</li><li><strong>Biométrie :</strong> Empreinte digitale, Reconnaissance faciale.</li></ul><p>Mais surtout c&#39;est :</p><ul><li>Permets de sécuriser les mots de passe en ajoutant une couche de sécurité supplémentaire.</li><li>Via un secret partagé entre la personne <strong>physique</strong> et le site.</li></ul><h3 id="les-impacts-lies-a-la-securite" tabindex="-1">Les impacts liés à la sécurité <a class="header-anchor" href="#les-impacts-lies-a-la-securite" aria-label="Permalink to &quot;Les impacts liés à la sécurité&quot;">​</a></h3><p>La sécurité informatique dans une application c’est un « équilibre »</p><ul><li>Impact fonctionnel</li><li>Limitation de l’expérience utilisateur (UX)</li><li>Impact financier</li></ul><p><img src="'+t+'" alt="" loading="lazy"><img src="'+l+'" alt="" loading="lazy"></p><h3 id="les-types-de-failles" tabindex="-1">Les types de failles <a class="header-anchor" href="#les-types-de-failles" aria-label="Permalink to &quot;Les types de failles&quot;">​</a></h3><ul><li>L’humain (Social Engineering)</li><li>D&#39;accès (physique)</li><li>Applicatif (Hack)</li><li>L’argent (jusqu’à quel montant une personne donne l’information ?)</li></ul><h3 id="le-social-engineering" tabindex="-1">Le Social Engineering <a class="header-anchor" href="#le-social-engineering" aria-label="Permalink to &quot;Le Social Engineering&quot;">​</a></h3><p>Les gens sont souvent trop confiants. Il faut donc les former régulièrement à la sécurité.</p><p>Deux exemples en vidéo :</p><table><thead><tr><th style="text-align:center;"><img src="'+r+'" alt="Exposition" loading="lazy"></th><th style="text-align:center;"><img src="'+p+'" alt="Random" loading="lazy"></th></tr></thead><tbody><tr><td style="text-align:center;"><a href="https://www.youtube.com/watch?v=-FSLaHKoCNE" target="_blank" rel="noreferrer">Exemple SECTF à la DefCon</a></td><td style="text-align:center;"><a href="https://share.vidyard.com/watch/i46XF6N6rpR9KMaorihFQw" target="_blank" rel="noreferrer">Call Recreation (@5min, @11min30)</a></td></tr></tbody></table><h2 id="integrer-la-securite-a-toutes-les-etapes" tabindex="-1">Intégrer la sécurité à toutes les étapes <a class="header-anchor" href="#integrer-la-securite-a-toutes-les-etapes" aria-label="Permalink to &quot;Intégrer la sécurité à toutes les étapes&quot;">​</a></h2><p>La sécurité c’est un état d’esprit à intégrer.</p><p>C’est <strong>votre métier</strong></p><p><img src="'+o+`" alt="" loading="lazy"></p><h3 id="assurer-la-qualite" tabindex="-1">Assurer la qualité <a class="header-anchor" href="#assurer-la-qualite" aria-label="Permalink to &quot;Assurer la qualité&quot;">​</a></h3><p>S&#39;assurer d&#39;une qualité continue du code avec :</p><ul><li>Des règles à connaître (OWASP).</li><li>Des tests unitaires.</li><li>Une analyse automatique du code (SonarQube).</li></ul><h3 id="open-web-application-security-project-owasp" tabindex="-1">Open Web Application Security Project (OWASP) <a class="header-anchor" href="#open-web-application-security-project-owasp" aria-label="Permalink to &quot;Open Web Application Security Project (OWASP)&quot;">​</a></h3><blockquote><p>Open Web Application Security Project (OWASP) est une communauté en ligne travaillant sur la sécurité des applications Web. Sa philosophie est d&#39;être à la fois libre et ouverte à tous. Elle a pour vocation de publier des recommandations de sécurisation Web et de proposer aux internautes, administrateurs et entreprises des méthodes et outils de référence permettant de contrôler le niveau de sécurisation de ses applications Web.</p></blockquote><blockquote><p><em>Source: Wikipédia</em></p></blockquote><p><a href="https://owasp.org/" target="_blank" rel="noreferrer">Site de Owasp</a></p><p>OWASP liste 10 grandes catégories de failles <strong>à connaître</strong> :</p><ul><li><strong>Injection</strong> : Les attaques par injection surviennent lorsque des données non fiables sont envoyées à un interpréteur en tant que commande ou requête. Cela peut se produire avec les injections SQL, les injections OS, etc.</li><li>Violation de Gestion d’Authentification et de Session : Cela se produit lorsque les attaquants exploitent des vulnérabilités dans les mécanismes d&#39;authentification, comme les sessions mal gérées, les mots de passe faibles ou les identifiants exposés.</li><li><strong>Défaillances cryptographiques</strong> : Les données en transit et au repos (telles que les mots de passe, numéros de carte bleue, dossiers médicaux, informations personnelles et secrets commerciaux) requièrent une protection supplémentaire compte tenu des défaillances cryptographiques possibles (et donc à l’exposition de données sensibles). Cela est particulièrement vrai dans le cas où ces données relèvent de dispositifs réglementés comme le RGPD, le CCPA, etc. Exemple, mot de passe non chiffré en base de données</li><li><strong>Conception non sécurisée / Exposition de données sensibles</strong> : La « conception non sécurisée » est un terme assez large qui regroupe diverses failles et désigne l’absence ou la faiblesse de la conception des contrôles. Exemple d’accès direct à une ressource sans contrôle, manque de contrôle dans un système de routeur Web, Manque de contrôle de saisie.</li><li><strong>Mauvaise configuration de la sécurité</strong> : Manque de validation des types de paramètres, accès trop facile aux ressources non accessibles au public (cloud), configuration incomplète ou trop permissive, messages d’erreurs trop détaillés, contenant des informations sensibles, manque de contrôle sur les données en entrée (filtrage non présent type filter_input, strip_tags, htmlspecialchars etc.)</li><li><strong>Utilisation de composants avec des vulnérabilités connues</strong> : L&#39;utilisation de logiciels ou de composants obsolètes et vulnérables peut exposer l&#39;application à des attaques connues. Il est essentiel de maintenir une liste des composants utilisés et de surveiller les vulnérabilités associées. Ancienne version de Laravel, ancienne version de PHP, MySQL non à jour, etc.</li><li><strong>Identification et authentification de mauvaise qualité</strong> : Lorsque les applications n’exécutent pas de manière correcte les fonctions liées à la gestion des sessions ou à l’authentification des utilisateurs, des intrus peuvent compromettre les mots de passe, clés de sécurité ou jetons de sessions et usurper, de manière temporaire ou permanente, les identités et donc les autorisations d’autres utilisateurs. Exemple, absence d’authentification multifacteur, absence de règle de mot de passe, utilisateur par défaut type root / root sur un système, utilisation d’id dans un lien.</li><li><strong>Manque d’intégrité des données et du logiciel</strong> : Cette catégorie englobe les codes et infrastructures qui ne sont pas protégés contre les violations d’intégrité. Exemple, mise à jour sans contrôle, absence de signature numérique, présence de XSS dans un système, aucune protection anti-rejeux (brute force, CSRF)</li><li><strong>Absence de logs serveur et de surveillance</strong> : Permettre un cas d’incident d’avoir de la traçabilité.</li><li><strong>Falsification de requête côté serveur</strong> : Elle permet à un hacker d’inciter l’application côté serveur à envoyer des requêtes à un endroit non prévu. Le serveur est donc capable de faire des requêtes à des endroits non prévus (depuis le coeur de l&#39;application).</li></ul><h3 id="les-failles" tabindex="-1">Les failles <a class="header-anchor" href="#les-failles" aria-label="Permalink to &quot;Les failles&quot;">​</a></h3><p>Le TOP 10 OWASP nous donne les grandes catégories de failles à connaître. Pour entrer dans le détail, voici les failles les plus courantes :</p><h3 id="les-injections" tabindex="-1">Les Injections <a class="header-anchor" href="#les-injections" aria-label="Permalink to &quot;Les Injections&quot;">​</a></h3><p>Injection SQL, Shell...</p><p>Souvent la plus connue et la plus rencontrée :</p><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&quot; . $_GET[&quot;id&quot;] . &quot;&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>http://exemple.com/liste?id=&#39;or &#39;1&#39;=&#39;1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">C&#39;est la base de la sécurité</p><p>Vous trouverez cet exemple un peu partout. C&#39;est le mauvais exemple en termes de sécurité !</p><p>Au passage, si vous écrivez :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $_GET[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$maRequete </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&#39;&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>⚠️ C&#39;est aussi une faille, celle-ci est identique à la précédente.</p></div><h4 id="comment-corriger" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours utiliser des requêtes préparées.</li><li>Ou utiliser des ORM (Object Relational Mapping) qui font la même chose.</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$maRequete </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $pdo</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">prepare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$maRequete</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execute</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;id&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $_GET[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;id&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="violation-de-gestion-d-authentification-et-de-session" tabindex="-1">Violation de Gestion d’Authentification et de Session <a class="header-anchor" href="#violation-de-gestion-d-authentification-et-de-session" aria-label="Permalink to &quot;Violation de Gestion d’Authentification et de Session&quot;">​</a></h3><p>Risque de casser / usurper une authentification ou une session. Comprends notamment le vol de session ou la récupération de mots de passe.</p><p>Une session en paramètre GET == ⚠️. Si vous partagez le lien, n&#39;importe qui pourra obtenir votre accès !</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>http://exemple.com/?jsessionid=A2938298D293</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="comment-corriger-1" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-1" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours utiliser des sessions cryptées.</li><li>Toujours utiliser des sessions avec un identifiant unique.</li><li>Toujours utiliser des sessions avec un TTL (Time To Live).</li></ul><h3 id="cross-site-scripting-xss" tabindex="-1">Cross-Site Scripting (XSS) <a class="header-anchor" href="#cross-site-scripting-xss" aria-label="Permalink to &quot;Cross-Site Scripting (XSS)&quot;">​</a></h3><p>Risque d&#39;injection de contenu dans une page pour but de provoquer des actions non désirées dans celle-ci.</p><p>Les failles XSS sont particulièrement répandues parmi les failles de sécurités Web.</p><p>Exécution de code JavaScript sans validation. Le risque ici est qu&#39;il est possible de changer le comportement initialement attendu pour en détourner le sens.</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Votre Nom : &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">input</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;text&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;nom&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">echo </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Bonjour &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> . $_POST[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nom&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">Attention</p><p>Avec ce code, il est possible d&#39;exécuter du code JavaScript. Exemple, si l&#39;utilisateur entre :</p><div class="language-html vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">alert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Le code sera exécuté dans le navigateur de l&#39;utilisateur lors de l&#39;affichage de la page.</p></div><p>Deux types sont à connaître :</p><ul><li>XSS Persistant (stocké)</li><li>XSS Reflété (via un lien)</li></ul><h4 id="comment-corriger-2" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-2" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours valider les entrées utilisateurs.</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> filter_input</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">INPUT_POST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nom&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FILTER_SANITIZE_STRING</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ou</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> strip_tags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($_POST[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nom&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ou</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$nom </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> htmlspecialchars</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($_POST[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;nom&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="references-directes-non-securisees-a-un-objet" tabindex="-1">Références directes non sécurisées à un objet <a class="header-anchor" href="#references-directes-non-securisees-a-un-objet" aria-label="Permalink to &quot;Références directes non sécurisées à un objet&quot;">​</a></h3><p>Accès à de la donnée en spécifiant un <code>id</code> directement par un paramètre non filtré.</p><p>C&#39;est également quelque chose de très courant. Si vous attendez en paramètre un mode / un id, veillez à toujours contrôler si la ressource chargée correspond aux droits de l&#39;utilisateur.</p><p>Si je change client par … admin ?</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>http://exemple.com/liste?mode=client</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> client </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$stmt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bindParam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, $mode);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Requête préparée</p><p>Vous noterez ici que nous avons une requête « préparé » ça n&#39;empêche pas le danger…</p></div><h4 id="comment-corriger-3" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-3" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours valider les entrées utilisateurs.</li><li>Toujours vérifier les droits de l&#39;utilisateur.</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($_SESSION[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;client&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On peut charger la ressource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($_SESSION[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;admin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On peut charger la ressource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On ne peut pas charger la ressource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="mauvaise-configuration-securite" tabindex="-1">Mauvaise configuration Sécurité <a class="header-anchor" href="#mauvaise-configuration-securite" aria-label="Permalink to &quot;Mauvaise configuration Sécurité&quot;">​</a></h3><p>Corresponds aux failles de configuration liées aux serveurs Web, applications, base de données ou frameworks.</p><ul><li>Console d’administration disponible sans authentification en ligne.</li><li>Listage des répertoires (<a href="https://www.google.fr/search?dcr=0&amp;q=intitle%3A%22Index%20of%22" target="_blank" rel="noreferrer">Exemple</a>)</li><li>Exemples de code non supprimés.</li><li>Application en debug.</li></ul><h4 id="comment-corriger-4" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-4" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours supprimer les exemples de code.</li><li>Toujours supprimer les répertoires de débug.</li><li>Lire la documentation.</li></ul><h3 id="exposition-de-donnees-sensibles" tabindex="-1">Exposition de données sensibles <a class="header-anchor" href="#exposition-de-donnees-sensibles" aria-label="Permalink to &quot;Exposition de données sensibles&quot;">​</a></h3><p>Exposition de données sensibles comme les mots de passe, les numéros de carte de paiement ou encore les données personnelles et la nécessité de chiffrer ces données.</p><ul><li>Espace client sans SSL.</li><li>Mot de passe en clair (ou en MD5) dans la base de données.</li><li>Sauvegarde de données inutiles.</li><li>Données sensibles dans les logs.</li><li>Données sensibles en clair dans la base de données.</li></ul><h4 id="comment-corriger-5" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-5" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours utiliser le HTTPS.</li><li>Toujours utiliser des mots de passe chiffrés (hashés + sel).</li><li>Toujours supprimer les données inutiles.</li><li>Toujours supprimer les données sensibles des logs.</li><li>Protéger les données sensibles dans la base de données (chiffrement).</li></ul><h3 id="manque-de-controle-d-acces-au-niveau-fonctionnel" tabindex="-1">Manque de contrôle d’accès au niveau fonctionnel <a class="header-anchor" href="#manque-de-controle-d-acces-au-niveau-fonctionnel" aria-label="Permalink to &quot;Manque de contrôle d’accès au niveau fonctionnel&quot;">​</a></h3><p>Failles liées aux contrôles d&#39;accès de fonctionnalité.</p><ul><li>Page d’admin accessible avec un compte utilisateur.</li><li>Mode non filtré (similaire à l’exemple mode={client,admin}).</li></ul><h4 id="comment-corriger-6" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-6" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours vérifier les droits de l&#39;utilisateur.</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($_SESSION[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;client&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On peut charger la ressource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($_SESSION[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;mode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;admin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On peut charger la ressource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On ne peut pas charger la ressource</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="falsification-de-requete-intersite-csrf" tabindex="-1">Falsification de requête intersite (CSRF) <a class="header-anchor" href="#falsification-de-requete-intersite-csrf" aria-label="Permalink to &quot;Falsification de requête intersite (CSRF)&quot;">​</a></h3><p>Failles liées à l’exécution de requêtes à l’insu de l’utilisateur.</p><ul><li>Rejeu de requête déjà joué.</li><li>Attaque de type brute force.</li><li>Exécution de requête à l’insu de l’utilisateur (exemple : déconnexion / connexion sur un site tierce).</li></ul><div class="tip custom-block"><p class="custom-block-title">Comment le bloquer ?</p><p>Ajoutez un identifiant/jeton dans la requête, unique et non réutilisable. Intégré de base dans Laravel.</p></div><h4 id="comment-corriger-7" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-7" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Ajouter un jeton unique dans les formulaires.</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">input</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;hidden&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;_token&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ csrf_token() }}&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Côté PHP</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">isset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($_POST[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $_POST[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $_SESSION[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;_token&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On peut traiter la requête</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    die</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="utilisation-de-composants-avec-des-vulnerabilites-connues" tabindex="-1">Utilisation de composants avec des vulnérabilités connues <a class="header-anchor" href="#utilisation-de-composants-avec-des-vulnerabilites-connues" aria-label="Permalink to &quot;Utilisation de composants avec des vulnérabilités connues&quot;">​</a></h3><p>Failles liées à l’utilisation de composants tiers vulnérables.</p><ul><li>CMS non à jour.</li><li>Apache / Tomcat non patchés.</li><li>Librairies XYZ non à jour.</li><li>Version de PHP non à jour.</li><li>Framework non à jour.</li></ul><h4 id="comment-corriger-8" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-8" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours mettre à jour les composants tiers.</li><li>Ne pas utiliser de vieux frameworks (exemple PHP 4, ou Symfony 1.4)</li></ul><h3 id="redirections-et-renvois-non-valides" tabindex="-1">Redirections et Renvois non validés <a class="header-anchor" href="#redirections-et-renvois-non-valides" aria-label="Permalink to &quot;Redirections et Renvois non validés&quot;">​</a></h3><p>Les redirections et les renvois non validés sont une vulnérabilité profitant d’une faiblesse dans le code et dont l’objectif est de rediriger l’utilisateur sur une page malveillante</p><ul><li>Utilisation de votre site comme « masque » dans du phishing</li></ul><p><em>Exemple :</em></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>http://www.shop-vdt.com/login.php?goto=evil.com/login</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h4 id="comment-corriger-9" tabindex="-1">Comment corriger ? <a class="header-anchor" href="#comment-corriger-9" aria-label="Permalink to &quot;Comment corriger ?&quot;">​</a></h4><ul><li>Toujours valider les entrées utilisateurs.</li><li>Filtrer les liens possibles.</li></ul><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Autorise uniquement les redirections vers le site</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">preg_match</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">https?:</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">\\/\\/</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">shop-vdt</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">\\.</span><span style="--shiki-light:#032F62;--shiki-dark:#DBEDFF;">com</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;--shiki-light-font-weight:bold;--shiki-dark-font-weight:bold;">\\/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, $_GET[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;goto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    header</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Location: &#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> .</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $_GET[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;goto&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    die</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="mais-une-faille-c-est-quoi" tabindex="-1">Mais, une faille c’est quoi ? <a class="header-anchor" href="#mais-une-faille-c-est-quoi" aria-label="Permalink to &quot;Mais, une faille c’est quoi ?&quot;">​</a></h3><p><img src="`+h+'" alt="Une faille" loading="lazy"></p><p>L&#39;idée d&#39;OWASP, c&#39;est de former pour comprendre les failles afin de ne plus les produire involontairement… Et surtout avec OWASP on parle de <strong>vulnérabilité, et non de risque</strong>.</p><h2 id="les-outils-owasp" tabindex="-1">Les outils OWASP <a class="header-anchor" href="#les-outils-owasp" aria-label="Permalink to &quot;Les outils OWASP&quot;">​</a></h2><ul><li><a href="https://owasp.org/www-project-juice-shop/" target="_blank" rel="noreferrer">OWASP Juice Shop (Formation, JavaScript)</a></li><li>WebGoat (Formation, Java)</li><li>WebScarab (Audit)</li><li>OWASP Testing guide (Guide pour voir le niveau de sécu)</li><li>OWASP Code Review guide (Méthode d’audit)</li></ul><h2 id="synthese-owasp" tabindex="-1">Synthèse OWASP <a class="header-anchor" href="#synthese-owasp" aria-label="Permalink to &quot;Synthèse OWASP&quot;">​</a></h2><p><img src="'+d+'" alt="" loading="lazy"></p>',132),k=[c];function g(m,E,b,y,v,f){return i(),e("div",null,k)}const q=s(u,[["render",g]]);export{A as __pageData,q as default};
