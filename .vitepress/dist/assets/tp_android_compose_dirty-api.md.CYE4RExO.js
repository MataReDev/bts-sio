import{_ as e,c as i,o as a,U as s,k as n}from"./chunks/framework.aGaNZw_P.js";const l="/assets/tabs.COwY9rEW.jpg",t="/assets/choix_ecran.DVf6LrqW.jpg",p="/assets/tabs_selection.Nh47Lg-R.jpg",r="/assets/preview_composant.2WfT6QCv.jpg",F=JSON.parse(`{"title":"Android Compose, une liste et une API Rest","description":"Dans cette page vous trouverez un exemple d'application Android utilisant Jetpack Compose.","frontmatter":{"description":"Dans cette page vous trouverez un exemple d'application Android utilisant Jetpack Compose.","tags":["Android","Compose","API","Rest","Retrofit"]},"headers":[],"relativePath":"tp/android/compose/dirty-api.md","filePath":"tp/android/compose/dirty-api.md","lastUpdated":1674679475000}`),o={name:"tp/android/compose/dirty-api.md"},d=s('<h1 id="android-compose-une-liste-et-une-api-rest" tabindex="-1">Android Compose, une liste et une API Rest <a class="header-anchor" href="#android-compose-une-liste-et-une-api-rest" aria-label="Permalink to &quot;Android Compose, une liste et une API Rest&quot;">​</a></h1><p>Dans cette page vous trouverez un exemple d&#39;application Android utilisant Jetpack Compose et appellant une API Rest.</p><details class="details custom-block"><summary>Table des matières</summary><nav class="table-of-contents"><ul><li><a href="#presentation">Présentation</a></li><li><a href="#prerequis">Prérequis</a></li><li><a href="#recuperation-du-code-source">Récupération du code source</a></li><li><a href="#organisation-du-code-source">Organisation du code source</a></li><li><a href="#le-fichier-build-gradle">Le fichier build.gradle</a></li><li><a href="#le-theme">Le thème</a></li><li><a href="#le-apiservice-kt">Le ApiService.kt</a></li><li><a href="#la-reactivite">La réactivité</a><ul><li><a href="#avant-propos-le-viewmodel">Avant-propos : Le ViewModel</a></li><li><a href="#le-fichier-listviewmodel-kt">Le fichier ListViewModel.kt</a></li><li><a href="#le-fichier-listscreen-kt">Le fichier ListScreen.kt</a></li></ul></li><li><a href="#les-enumerations-enums">Les énumérations (enums)</a></li><li><a href="#rappel-sur-les-callbacks">Rappel sur les callbacks</a></li><li><a href="#l-ecran-de-connexion">L&#39;écran de connexion</a></li><li><a href="#les-images-res-drawable">Les images (res, drawable)</a><ul><li><a href="#les-images-locales">Les images locales</a></li><li><a href="#les-images-distantes">Les images distantes</a></li></ul></li><li><a href="#les-tabs-la-navbar">Les tabs (La NavBar)</a></li><li><a href="#l-apercu-d-un-composant">L&#39;aperçu d&#39;un composant</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#ressources">Ressources</a></li></ul></nav></details><div class="warning custom-block"><p class="custom-block-title">Application d&#39;apprentissage</p><p>Cette application est un exemple d&#39;application Android utilisant Jetpack Compose et appelant une API Rest. Elle est destinée à être utilisée comme support de cours.</p><p>Dans un vrai projet, il est fortement recommandé d&#39;utiliser une architecture MVVM, et de séparer les composants de l&#39;application en plusieurs modules. Et surtout d&#39;utiliser Jetpack Navigation pour la navigation entre les écrans.</p></div><h2 id="presentation" tabindex="-1">Présentation <a class="header-anchor" href="#presentation" aria-label="Permalink to &quot;Présentation&quot;">​</a></h2><p>Cette application contient les éléments suivants :</p><ul><li>Une page d&#39;accueil.</li><li>Une page de liste, les données sont récupérées depuis une API (fichier <code>ApiService.kt</code>).</li><li>Une page de détail affiche les données de l&#39;élément sélectionné dans la liste.</li><li>Une liste de photos, les données sont récupérées depuis une API (fichier <code>ApiService.kt</code>). Les photos sont affichées en utilisant la librairie Coil.</li><li>Une page à propos affiche des informations sur l&#39;application.</li></ul>',7),c=n("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/Gs51sngU-3c",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""},null,-1),h=s(`<h2 id="prerequis" tabindex="-1">Prérequis <a class="header-anchor" href="#prerequis" aria-label="Permalink to &quot;Prérequis&quot;">​</a></h2><p>Pour comprendre cette application, vous devez avoir des notions de :</p><ul><li><a href="https://kotlinlang.org/" target="_blank" rel="noreferrer">Kotlin</a></li><li><a href="https://developer.android.com/" target="_blank" rel="noreferrer">Android</a></li><li><a href="https://developer.android.com/jetpack/compose" target="_blank" rel="noreferrer">Jetpack Compose</a></li><li>Suivi le TP <a href="/tp/composants/android.html">Android Compose, Une liste</a></li></ul><h2 id="recuperation-du-code-source" tabindex="-1">Récupération du code source <a class="header-anchor" href="#recuperation-du-code-source" aria-label="Permalink to &quot;Récupération du code source&quot;">​</a></h2><p>Vous pouvez récupérer le code source de cette application depuis le dépôt GitHub suivant :</p><ul><li><a href="https://github.com/c4software/project-compose-api-sample" target="_blank" rel="noreferrer">Code source</a></li></ul><h2 id="organisation-du-code-source" tabindex="-1">Organisation du code source <a class="header-anchor" href="#organisation-du-code-source" aria-label="Permalink to &quot;Organisation du code source&quot;">​</a></h2><p>Le code source de cette application est organisé de la manière suivante :</p><ul><li><code>MainActivity.kt</code> : Activité principale de l&#39;application.</li><li><code>screens/</code> : Contient les écrans de l&#39;application.</li><li><code>screens/HomeScreen.kt</code> : Écran d&#39;accueil.</li><li><code>screens/AboutScreen.kt</code> : Écran à propos.</li><li><code>screens/list/ListScreen.kt</code> : Écran de liste.</li><li><code>screens/list/ListViewModel.kt</code> : Logique métier de l&#39;écran de liste, ici nous appelons l&#39;API et gérons l&#39;état de la liste (chargement, erreur, données).</li><li><code>screens/photos/PhotosScreen.kt</code> : Écran de liste de photos.</li><li><code>screens/photos/PhotosViewModel.kt</code> : Logique métier de l&#39;écran de liste de photos, ici nous appelons l&#39;API et gérons l&#39;état de la liste (chargement, erreur, données).</li><li><code>data/ApiService.kt</code> : Service d&#39;appel à l&#39;API.</li><li><code>data/Enums.kt</code> : Énums utilisés dans l&#39;application (état de la liste, état de la requête).</li><li><code>components/</code> : Contient les composants utilisés dans l&#39;application.</li></ul><p>Ce qu&#39;il faut retenir c&#39;est que nous découpons notre application en 3 parties :</p><ul><li><code>screens</code> : Ce sont les écrans de l&#39;application.</li><li><code>components</code> : Ce sont les composants utilisés dans les différents écrans</li><li><code>data</code> : C&#39;est le code d&#39;accès aux données (API, base de données, etc.)</li></ul><h2 id="le-fichier-build-gradle" tabindex="-1">Le fichier <code>build.gradle</code> <a class="header-anchor" href="#le-fichier-build-gradle" aria-label="Permalink to &quot;Le fichier \`build.gradle\`&quot;">​</a></h2><p>Pour que notre application puisse fonctionner correctement, nous avons besoin des dépendances suivantes dans le fichier <code>build.gradle</code> :</p><div class="language-groovy vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ViewModel</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.lifecycle:lifecycle-viewmodel-ktx:2.5.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;androidx.lifecycle:lifecycle-viewmodel-compose:2.5.1&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Appel API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.squareup.retrofit2:retrofit:2.9.0&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;com.squareup.retrofit2:converter-gson:2.9.0&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Chargement des images via le réseau (coil)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.coil-kt:coil-compose:2.2.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>Les dépendances <code>lifecycle-viewmodel-ktx</code> et <code>lifecycle-viewmodel-compose</code> sont nécessaires pour utiliser le ViewModel dans notre application.</li><li>Les dépendances <code>retrofit</code> et <code>converter-gson</code> sont nécessaires pour appeler l&#39;API.</li></ul><h2 id="le-theme" tabindex="-1">Le thème <a class="header-anchor" href="#le-theme" aria-label="Permalink to &quot;Le thème&quot;">​</a></h2><p>De base l&#39;application utilise un fichier <code>theme.kt</code>. Celui-ci contient les couleurs de base de l&#39;application. Vous pouvez générer un nouveau thème en modifiant directement celui-ci.</p><p>Vous pouvez également utiliser <a href="https://m3.material.io/theme-builder#/custom" target="_blank" rel="noreferrer">une solution en ligne</a>.</p><h2 id="le-apiservice-kt" tabindex="-1">Le <code>ApiService.kt</code> <a class="header-anchor" href="#le-apiservice-kt" aria-label="Permalink to &quot;Le \`ApiService.kt\`&quot;">​</a></h2><p>Le fichier <code>ApiService.kt</code> contient le service d&#39;appel à l&#39;API. Il utilise la librairie <a href="https://square.github.io/retrofit/" target="_blank" rel="noreferrer">Retrofit</a> pour appeler l&#39;API.</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ApiService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;todos&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getTodos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Todo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    @GET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;photos&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    suspend</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getPhotos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Photo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Ici nous utilisons l&#39;annotation <code>@GET</code> pour indiquer que nous faisons un appel <code>GET</code> sur l&#39;URL <code>/todos</code>. Nous indiquons également que la méthode retourne une liste de <code>Todo</code>.</p><div class="tip custom-block"><p class="custom-block-title">Pas de code ?</p><p>Et oui, c&#39;est là tout l&#39;intérêt de Retrofit, il génère le code pour nous. Nous n&#39;avons pas à écrire le code pour appeler l&#39;API, il suffit de définir l&#39;interface et de l&#39;utiliser. Magique !</p></div><p>L&#39;autre partie du code est la création de l&#39;instance de <code>ApiService</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apiService: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">APIService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">? </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">APIService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (apiService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            apiService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Retrofit.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Builder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">baseUrl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(BASE_URL)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addConverterFactory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(GsonConverterFactory.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(APIService::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.java)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> apiService</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Nous utilisons le pattern <code>Singleton</code> pour créer une seule instance de <code>ApiService</code>. Nous utilisons également le pattern <code>Builder</code> pour créer l&#39;instance de <code>Retrofit</code>.</p><p>Dans le code ci-dessus nous avons défini une constante <code>BASE_URL</code> qui contient l&#39;URL de base de l&#39;API. Nous utilisons cette constante pour définir l&#39;URL de base de l&#39;API. Nous indiquons également que nous utilisons <code>Gson</code> pour convertir les données reçues en <code>Todo</code>.</p><p>C&#39;est ce morceau de code qui nous permet d&#39;appeler l&#39;API <strong>et surtout</strong> qui décodera les données reçues en JSON pour les transformer en <code>Todo</code> (dans notre cas).</p><p>Par la suite pour récupérer les données de l&#39;API il suffit d&#39;appeler la méthode <code>getTodos()</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> todos </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ApiService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getTodos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Compliqué ?</p><p>Pas tant que ça ! Avec l&#39;habitude, cette gymnastique de créer un service d&#39;appel à une API sera un jeu d&#39;enfant pour vous.</p></div><h2 id="la-reactivite" tabindex="-1">La réactivité <a class="header-anchor" href="#la-reactivite" aria-label="Permalink to &quot;La réactivité&quot;">​</a></h2><p>En Kotlin les composants sont réactifs. Cela signifie que si une variable change, tous les composants qui utilisent cette variable seront mis à jour. Nous utilisons cette fonctionnalité pour mettre à jour l&#39;écran de liste lorsque les données sont chargées depuis Internet.</p><p>Prenons l&#39;exemple de la <code>Liste</code>. Premier point important, pour rendre le code lisible, celui-ci est découpé en deux fichiers :</p><ul><li><code>ListScreen.kt</code> : Écran de liste</li><li><code>ListViewModel.kt</code> : Logique métier de l&#39;écran de liste</li></ul><p>Le fichier <code>ListScreen.kt</code> contient uniquement la partie graphique de l&#39;écran de liste. Le fichier <code>ListViewModel.kt</code> contient la logique métier de l&#39;écran de liste. Nous allons voir comment ces deux fichiers communiquent entre eux.</p><h3 id="avant-propos-le-viewmodel" tabindex="-1">Avant-propos : Le ViewModel <a class="header-anchor" href="#avant-propos-le-viewmodel" aria-label="Permalink to &quot;Avant-propos : Le ViewModel&quot;">​</a></h3><p>Le <code>ViewModel</code> est un découpage de l&#39;application qui permet de séparer la logique métier de l&#39;application de la partie graphique. Chaque écran de l&#39;application aura son <code>ViewModel</code> qui contiendra la logique métier de l&#39;écran. L&#39;objectif ? Découper l&#39;application en plusieurs parties et ainsi rendre le code plus lisible.</p><p>Un écran possèdera donc un <code>ViewModel</code> qui contiendra la logique métier de l&#39;écran. Vous ne devez pas avoir plusieurs <code>ViewModel</code> pour un même écran. Si vous avez besoin de plusieurs <code>ViewModel</code> pour un même écran, il faut alors séparer l&#39;écran en plusieurs écrans.</p><h3 id="le-fichier-listviewmodel-kt" tabindex="-1">Le fichier <code>ListViewModel.kt</code> <a class="header-anchor" href="#le-fichier-listviewmodel-kt" aria-label="Permalink to &quot;Le fichier \`ListViewModel.kt\`&quot;">​</a></h3><p>Le ViewModel contient donc la logique d&#39;accès aux données, nous avons donc ici :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Variables qui vont changer d&#39;état lors du chargement des données</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> itemsList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MutableStateFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Todo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;&gt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">emptyList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> loadingState </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MutableStateFlow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LOADING_STATES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(LOADING_STATES.LOADING)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Récupération des éléments.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// On utilise un CoroutineScope pour pouvoir faire des appels réseaux</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// sans bloquer le thread principal (c&#39;est à dire l&#39;interface)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getItems</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On indique que les données sont en cours de chargement (chargement)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    loadingState.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LOADING_STATES.LOADING</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // On lance une coroutine pour récupérer les données</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Une coroutine est un thread qui va s&#39;exécuter en parallèle du thread principal</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    CoroutineScope</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Dispatchers.IO).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">launch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // On récupère les données depuis l&#39;API, c&#39;est ici que l&#39;on fait appel à l&#39;API</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Le résultat est stocké dans la variable itemsList, cette variable est réactive la vue sera mise à jour</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            itemsList.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> APIService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getTodos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // On indique que les données sont chargées (terminé)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            loadingState.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LOADING_STATES.LOADED</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (e: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Throwable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // En cas d&#39;erreur</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // On indique qu&#39;une erreur est survenue (erreur)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            loadingState.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LOADING_STATES.ERROR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">C&#39;est presque générique !</p><p>Le code d&#39;accès à la donnée est presque générique, il suffit de changer la méthode <code>getTodos()</code> pour récupérer les données depuis une autre source (préalablement créé dans l&#39;APIService).</p><p>La gestion des états est toujours là même :</p><ul><li>J&#39;indique que les données sont en cours de chargement.</li><li>Je lance une coroutine pour récupérer les données.</li><li>Je mets à jour une variable qui est réactive avec les données obtenues.</li><li>J&#39;indique que les données sont chargées.</li><li>En cas d&#39;erreur, j&#39;indique qu&#39;une erreur est survenue.</li></ul><p>Nous avons une base réutilisable pour accéder à des données.</p></div><h3 id="le-fichier-listscreen-kt" tabindex="-1">Le fichier <code>ListScreen.kt</code> <a class="header-anchor" href="#le-fichier-listscreen-kt" aria-label="Permalink to &quot;Le fichier \`ListScreen.kt\`&quot;">​</a></h3><p>Nous avons ici la partie graphique. Les éléments qui seront affichés, nous avons cependant des éléments qui vont faire référence aux données à savoir :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ListScreen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(viewModel: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ListViewModel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> viewModel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Le paramètre de la fonction <code>ListScreen</code> est un <code>ListViewModel</code>, il s&#39;agit du <code>ViewModel</code> de l&#39;écran de liste. Il nous permettra d&#39;accéder à la logique métier de l&#39;écran de liste.</p><h4 id="l-ecoute-des-donnees" tabindex="-1">L&#39;écoute des données <a class="header-anchor" href="#l-ecoute-des-donnees" aria-label="Permalink to &quot;L&#39;écoute des données&quot;">​</a></h4><p>Notre vue écoute des données, pour ça nous avons besoin de deux variables :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Variable qui changeront d&#39;état lors du chargement des données</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> loadingState </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewModel.loadingState.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collectAsState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> items </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> viewModel.itemsList.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">collectAsState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Ces deux variables sont « réactives », c&#39;est-à-dire qu&#39;elles seront mises à jour lorsqu&#39;une donnée change. Nous utilisons la fonction <code>collectAsState()</code>. CollectAsState est une méthode qui nous permettra d&#39;écouter les changements des données directement dans notre interface.</p><ul><li>loadingState : État du chargement des données (chargement, erreur, terminée).</li><li>items : Liste des données (l&#39;ensemble des données retournées par l&#39;API).</li></ul><p>Puis nous avons la demande de chargement des données :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Récupération des éléments à afficher via le ViewModel</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">viewModel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getItems</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Ici nous appelons la méthode <code>getItems()</code> du <code>ViewModel</code> de l&#39;écran de liste. Cette méthode va déclencher le chargement des données depuis l&#39;API. Chargement qui permettra de mettre à jour les variables <code>loadingState</code> et <code>items</code>.</p><h4 id="l-affichage-des-donnees" tabindex="-1">L&#39;affichage des données <a class="header-anchor" href="#l-affichage-des-donnees" aria-label="Permalink to &quot;L&#39;affichage des données&quot;">​</a></h4><p>Une fois les données obtenues, nous allons les afficher dans l&#39;interface :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (loadingState.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    LOADING_STATES.LOADING </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Affichage d&#39;un loader</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Loader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    LOADING_STATES.LOADED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Affichage de la liste</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        ListItems</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(items </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> items.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) { selectedItem.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> it }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    LOADING_STATES.ERROR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Affichage d&#39;un message d&#39;erreur</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    else</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Affichage d&#39;un message d&#39;erreur</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>Vous pouvez voir que nous avons 3 états possibles :</p><ul><li><code>LOADING_STATES.LOADING</code>: Les données sont en cours de chargement.</li><li><code>LOADING_STATES.LOADED</code>: Les données ont été chargées avec succès.</li><li><code>LOADING_STATES.ERROR</code>: Une erreur est survenue lors du chargement des données.</li></ul><p>Nous affichons donc un loader, la liste des données ou un message d&#39;erreur en fonction de l&#39;état. Grâce au découpage de l&#39;interface en composants, notre code reste lisible et compréhensible, et est finalement très générique.</p><h2 id="les-enumerations-enums" tabindex="-1">Les énumérations (enums) <a class="header-anchor" href="#les-enumerations-enums" aria-label="Permalink to &quot;Les énumérations (enums)&quot;">​</a></h2><p>Écrire des énums est une bonne pratique pour définir des états. Nous pouvons ensuite utiliser ces énums pour définir l&#39;état de notre application. C&#39;est plus simple à lire et à comprendre que des <code>Boolean</code> ou des <code>Int</code>.</p><p>Dans ce projet nous avons défini 2 énums :</p><p>L&#39;enum <code>LOADING_STATE</code> est utilisé pour définir l&#39;état du chargement des données :</p><ul><li><code>LOADING</code>: Les données sont en cours de chargement.</li><li><code>ERROR</code>: Une erreur est survenue lors du chargement des données.</li><li><code>SUCCESS</code>: Les données ont été chargées avec succès.</li></ul><p>L&#39;enum <code>STATES</code> est utilisé pour définir quel écran est actuellement affiché en fonction de la NavBar en bas de l&#39;écran :</p><ul><li><code>HOME</code>: Écran d&#39;accueil.</li><li><code>LIST</code>: Écran de liste.</li><li><code>PHOTO</code>: Écran qui liste les photos.</li><li><code>LOGIN</code>: Écran de connexion (deux champs).</li><li><code>ABOUT</code>: Écran d&#39;informations sur l&#39;application.</li></ul><h2 id="rappel-sur-les-callbacks" tabindex="-1">Rappel sur les callbacks <a class="header-anchor" href="#rappel-sur-les-callbacks" aria-label="Permalink to &quot;Rappel sur les callbacks&quot;">​</a></h2><p>En Kotlin un composant peut définir un paramètre de type <code>() -&gt; Unit</code> pour définir un callback. Ce callback sera appelé au moment de l&#39;utilisation par l&#39;utilisateur.</p><p>Par exemple, dans le composant, <code>ListItems</code> nous avons défini un callback <code>onItemClicked</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Composable</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ListItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(item: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, onClick: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unit) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Row</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        Modifier</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fillMaxWidth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clickable</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onClick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() }, verticalAlignment </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Alignment.CenterVertically</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Text</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(item, modifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Modifier.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">padding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dp))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        Spacer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(modifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Modifier.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">weight</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>Notre paramètre <code>onClick</code> est de type <code>() -&gt; Unit</code>. Cela signifie que nous pouvons passer une fonction à ce paramètre. Ce qui nous permet de définir une action à effectuer lors du clic sur l&#39;item.</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ListItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> todo.title) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Action à effectuer lors du clic sur l&#39;item</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Point syntaxe</p><p>Dans l&#39;exemple ci-dessus, nous avons défini une fonction anonyme. Celle-ci est sortie de la liste des paramètres de la fonction <code>ListItem</code>. Nous pouvons également définir la fonction anonyme dans la liste des paramètres :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ListItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> todo.title, onClick </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Action à effectuer lors du clic sur l&#39;item</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Les deux syntaxes sont correctes. En Kotlin il est préférable d&#39;écrire la première syntaxe. Car elle est plus concise et plus lisible.</p></div><h2 id="l-ecran-de-connexion" tabindex="-1">L&#39;écran de connexion <a class="header-anchor" href="#l-ecran-de-connexion" aria-label="Permalink to &quot;L&#39;écran de connexion&quot;">​</a></h2><p>Vous avez dans l&#39;application de démo un écran de connexion. Cet écran est composé de deux champs de saisie (email et mot de passe). La connexion repose sur une API Rest.</p><p>Le fonctionnement est le suivant :</p><ul><li>L&#39;utilisateur saisit son email et son mot de passe.</li><li>L&#39;utilisateur clique sur le bouton &quot;Connexion&quot;.</li><li>L&#39;application utilise le viewModel pour appeler l&#39;API Rest. La fonction prend 3 paramètres : l&#39;email, le mot de passe et un callback.</li><li>Après l&#39;appel de l&#39;API le callback est appelé avec le résultat de l&#39;appel.</li></ul><p>Vous pouvez <a href="https://github.com/c4software/project-compose-api-sample/tree/main/app/src/main/java/com/example/exemplecomposelisteapi/screens/login" target="_blank" rel="noreferrer">voir le code ici</a></p><div class="danger custom-block"><p class="custom-block-title">Ici pas de sauvegarde de l&#39;authentification</p><p>L&#39;idée ici est de voir comment naviguer entre différent écran, et de découvrir comment il est possible de lier l&#39;ensemble (API, Navigation entre les vues, etc).</p><p>La sauvegarde de l&#39;authentification n&#39;est donc pas traitée ici.</p></div><h2 id="les-images-res-drawable" tabindex="-1">Les images (res, drawable) <a class="header-anchor" href="#les-images-res-drawable" aria-label="Permalink to &quot;Les images (res, drawable)&quot;">​</a></h2><p>Sur Android les ressources de type images sont stockées dans le dossier <code>res/drawable</code>. Nativement, Compose permet de charger les images depuis ce dossier. Pour charger des images depuis une ressource distante (par exemple une image stockée sur un serveur), nous allons utiliser une librairie tierce (Coil).</p><p>Voilà la procédure pour charger des images (locales et distantes).</p><h3 id="les-images-locales" tabindex="-1">Les images locales <a class="header-anchor" href="#les-images-locales" aria-label="Permalink to &quot;Les images locales&quot;">​</a></h3><p>Android Compose permet de charger des images depuis un fichier localement présent dans votre application (res/drawable). Pour charger une image depuis un fichier local, nous utilisons le composant <code>Image</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    painter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> painterResource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> R.drawable.ic_launcher_foreground),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contentDescription </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Logo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Vous avez un exemple</p><p>Si vous voulez un exemple dans l&#39;application de démo, vous pouvez regarder le fichier <a href="https://github.com/c4software/project-compose-api-sample/blob/main/app/src/main/java/com/example/exemplecomposelisteapi/screens/HomeScreen.kt" target="_blank" rel="noreferrer"><code>Home.kt</code></a> dans le dossier <code>screens</code>.</p></div><h3 id="les-images-distantes" tabindex="-1">Les images distantes <a class="header-anchor" href="#les-images-distantes" aria-label="Permalink to &quot;Les images distantes&quot;">​</a></h3><p>Pour charger une ressource distante, nous allons utiliser une librairie tierce. Nous allons utiliser la librairie <a href="https://github.com/coil-kt/coil#jetpack-compose" target="_blank" rel="noreferrer">Coil</a>.</p><p>Pour ajouter la librairie, il suffit d&#39;ajouter la dépendance suivante dans le fichier <code>build.gradle</code> :</p><div class="language-groovy vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;io.coil-kt:coil-compose:2.2.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">Attention</p><p>Après avoir ajouté la dépendance, il faut synchroniser le projet pour que la librairie soit ajoutée (un bandeau en haut de l&#39;IDE vous indique que le projet doit être synchronisé).</p></div><p>Pour charger une image distante, nous utilisons le composant <code>Image</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AsyncImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;https://picsum.photos/200/200&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    contentDescription </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Image&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    modifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Modifier</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">padding</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dp)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Le composant <code>AsyncImage</code> est un composant de la librairie Coil. Il permet de charger une image distante de manière asynchrone, c&#39;est-à-dire que le chargement de l&#39;image ne bloque pas le thread principal et donc ne ralentit pas l&#39;application.</p><div class="tip custom-block"><p class="custom-block-title">Un exemple ?</p><p>Si vous voulez un exemple dans l&#39;application de démo, vous pouvez regarder le fichier <a href="https://github.com/c4software/project-compose-api-sample/blob/main/app/src/main/java/com/example/exemplecomposelisteapi/components/PhotoItem.kt" target="_blank" rel="noreferrer"><code>PhotoItem.kt</code></a> dans le dossier <code>components</code>.</p><p>Dans le cas du code de démo, nous utilisons une image dont le lien est retourné par l&#39;API (lien de type <code>String</code>), exemple :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// PhotoItemMini.kt</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// L&#39;objet Photo correspond à un objet retourné par l&#39;API.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Composable</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PhotoItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(photo: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Photo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    AsyncImage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> photo.thumbnailUrl, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Lien de l&#39;image retourné par l&#39;API</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        contentDescription </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Image&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Description de l&#39;image (pour les malvoyants)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        modifier </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Modifier.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.dp) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Taille de l&#39;image (200x200)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div><h2 id="les-tabs-la-navbar" tabindex="-1">Les tabs (La NavBar) <a class="header-anchor" href="#les-tabs-la-navbar" aria-label="Permalink to &quot;Les tabs (La NavBar)&quot;">​</a></h2><p>Dans cette application nous utilisons des tabs (NavBar) pour naviguer entre les écrans. Pour cela nous utilisons le composant <code>BottomNavigation</code> de Jetpack Compose.</p><p>Ce Composant contient une liste de <code>BottomNavigationItem</code> qui correspondent aux différents différents éléments de la NavBar. Chaque élément est associé à un écran. Écrans qui seront affichés lors du clic sur l&#39;élément via le callback <code>onClick</code>.</p><p><img src="`+l+'" alt="Tabs" loading="lazy"></p><p>Dans le fichier <code>MainActivity.kt</code> nous avons défini une liste d&#39;écrans :</p><ul><li><code>STATES</code>: Correspond à la liste des différents écrans.</li><li><code>currentScreen</code>: Écran actuellement affiché.</li></ul><p>Pour afficher le bon écran :</p><p><img src="'+t+'" alt="choix écran" loading="lazy"></p><p>Nous avons donc un <code>when</code> qui va afficher le bon écran en fonction de la valeur de <code>currentScreen</code>. La valeur de <code>currentScreen</code> est modifiée lors du clic sur un élément de la NavBar.</p><p>Pour les interactions avec les tabs :</p><p><img src="'+p+`" alt="interactions tabs" loading="lazy"></p><ul><li>Le <code>OnClick</code> de chaque <code>BottomNavigationItem</code> permet de changer l&#39;écran actuellement affiché.</li><li>Le <code>Selected</code> de chaque <code>BottomNavigationItem</code> permet d&#39;indiquer quel écran est actuellement affiché, et donc de changer l&#39;icône (couleur).</li></ul><h2 id="l-apercu-d-un-composant" tabindex="-1">L&#39;aperçu d&#39;un composant <a class="header-anchor" href="#l-apercu-d-un-composant" aria-label="Permalink to &quot;L&#39;aperçu d&#39;un composant&quot;">​</a></h2><p>Pour faciliter le développement, vous pouvez utiliser le système de <code>Preview</code> de Jetpack Compose. Il permet de voir un composant dans l&#39;IDE sans avoir à lancer l&#39;application sur un appareil (ou un émulateur).</p><p>Pour utiliser le système de <code>Preview</code>, il suffit d&#39;ajouter l&#39;annotation <code>@Preview</code> au-dessus de la fonction qui contient le composant à afficher.</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Composable</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">@Preview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(showBackground </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ListItemPreview</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    ListItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed euismod, nunc ut&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="`+r+'" alt="preview composant" loading="lazy"></p><p>La flèche rouge vous permet de lancer l&#39;aperçu du composant en mode « interactif ». Vous pourrez donc cliquer dessus pour voir les interactions (visuelles) avec le composant.</p><div class="tip custom-block"><p class="custom-block-title">C&#39;est lent ?</p><p>Malheureusement, le système de <code>Preview</code> est assez lent. Il faut donc faire attention à ne pas en abuser. C&#39;est dommage, car c&#39;est un outil très pratique pour le développement.</p></div><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>Dans ce support nous avons vu comment l&#39;architecture d&#39;une application Android avec Jetpack Compose et qui appelle une API. Comme dans le TP précédent, nous nous sommes efforcés de découper notre application en plusieurs parties :</p><ul><li><code>screens</code> : Ce sont les écrans de l&#39;application.</li><li><code>components</code> : Ce sont les composants utilisés dans les différents écrans</li><li><code>data</code> : C&#39;est le code d&#39;accès aux données (API, base de données, etc.)</li></ul><p>Cette organisation est vraiment le niveau 0 si vous souhaitez développer des applications maintenables. C&#39;est la base de tout bon développeur Android.</p><div class="tip custom-block"><p class="custom-block-title">Et pour la suite ?</p><p>Il est bien évidemment possible de découper encore plus notre application. Par exemple, nous pourrions créer un dossier <code>utils</code> pour y mettre des fonctions utilitaires. Nous pourrions également créer un dossier <code>models</code> pour y mettre les modèles de données utilisés dans l&#39;application.</p><p>Il serait également intéressant d&#39;utiliser JetPack Navigation pour gérer les écrans de l&#39;application. Cela permettrait de gérer les transitions entre les écrans : <a href="https://developer.android.com/guide/navigation/navigation-getting-started" target="_blank" rel="noreferrer">Jetpack Navigation</a></p></div><h2 id="ressources" tabindex="-1">Ressources <a class="header-anchor" href="#ressources" aria-label="Permalink to &quot;Ressources&quot;">​</a></h2><ul><li><a href="https://developer.android.com/jetpack/compose/architecture" target="_blank" rel="noreferrer">https://developer.android.com/jetpack/compose/architecture</a></li><li><a href="https://square.github.io/retrofit/" target="_blank" rel="noreferrer">Retrofit</a></li><li><a href="https://github.com/google/gson" target="_blank" rel="noreferrer">Gson</a></li><li><a href="https://developer.android.com/guide/navigation/navigation-getting-started" target="_blank" rel="noreferrer">Jetpack Navigation</a></li><li><a href="https://github.com/c4software/project-compose-api-sample" target="_blank" rel="noreferrer">Le code source de l&#39;application</a></li><li><a href="https://kotlinlang.org/" target="_blank" rel="noreferrer">Kotlin</a></li><li><a href="https://developer.android.com/" target="_blank" rel="noreferrer">Android</a></li><li><a href="https://developer.android.com/jetpack/compose" target="_blank" rel="noreferrer">Jetpack Compose</a></li><li><a href="https://github.com/coil-kt/coil#jetpack-compose" target="_blank" rel="noreferrer">Coil</a></li></ul>',123),k=[d,c,h];function u(g,E,m,b,y,v){return a(),i("div",null,k)}const A=e(o,[["render",u]]);export{F as __pageData,A as default};
