import{_ as i,c as a,o as n,U as e,k as s}from"./chunks/framework.aGaNZw_P.js";const l="/assets/jackie-chan-why.DbL_smC3.jpg",t="/assets/diagram-bdd.Dpb6QXZz.png",r="/assets/tp2_diagram_classes.BRR_lz09.png",p="/assets/tp2-diagram-modele.i-03V4Io.png",h="/assets/tp2-liste-client-ui.mvrHNCIA.png",o="/assets/tp2-fiche-client-ui.C6qISjm0.png",d="/assets/mokup_produit.CXPgA_mb.png",B=JSON.parse('{"title":"Pratiquer la POO et le MVC","description":"","frontmatter":{},"headers":[],"relativePath":"tp/php/mvc/tp2.md","filePath":"tp/php/mvc/tp2.md","lastUpdated":1698930938000}'),c={name:"tp/php/mvc/tp2.md"},u=e('<h1 id="pratiquer-la-poo-et-le-mvc" tabindex="-1">Pratiquer la POO et le MVC <a class="header-anchor" href="#pratiquer-la-poo-et-le-mvc" aria-label="Permalink to &quot;Pratiquer la POO et le MVC&quot;">​</a></h1><p>Dans ce TP, nous allons continuer notre découverte de la POO au travers du MVC.</p><details class="details custom-block"><summary>Sommaire</summary><nav class="table-of-contents"><ul><li><a href="#le-projet">Le projet</a></li><li><a href="#recuperer-le-projet-de-base">Récupérer le projet de base</a></li><li><a href="#pdo-vous-connaissez">PDO vous connaissez ?</a></li><li><a href="#avant-d-aller-plus-loin-un-usage-avance-du-routeur">Avant d&#39;aller plus loin… un usage avancé du routeur</a></li><li><a href="#le-code-de-base">Le code de base</a><ul><li><a href="#les-modeles">Les modèles</a></li><li><a href="#la-base-de-donnees">La base de données</a></li><li><a href="#diagramme-de-classe-uml-relative-aux-modeles">Diagramme de classe / UML relative aux modèles</a></li></ul></li><li><a href="#la-page-de-liste-recherche">La page de liste / recherche</a><ul><li><a href="#creer-le-controleur">Créer le contrôleur</a></li><li><a href="#creer-la-vue">Créer la vue</a></li><li><a href="#creer-la-route">Créer la route /</a></li><li><a href="#afficher-la-liste-des-clients">Afficher la liste des clients</a></li><li><a href="#ajouter-la-pagination-et-la-fonctionnalite-de-recherche">Ajouter la pagination et la fonctionnalité de recherche</a></li></ul></li><li><a href="#la-fiche-client">La fiche client</a><ul><li><a href="#le-controleur">Le contrôleur</a></li><li><a href="#">Créer la route /client/</a></li><li><a href="#creer-la-fiche-client">Créer la fiche client</a></li><li><a href="#recuperer-un-client">Récupérer un client</a></li><li><a href="#afficher-la-liste-des-produits-d-un-client">Afficher la liste des produits d&#39;un client</a></li><li><a href="#ajouter-un-produit-au-client">Ajouter un produit au client</a></li></ul></li><li><a href="#les-adresses-clients">Les adresses clients</a></li><li><a href="#la-liste-des-contacts">La liste des contacts</a></li><li><a href="#restitution-du-travail">Restitution du travail</a></li><li><a href="#les-bonus">Les bonus</a><ul><li><a href="#bonus-ajouter-une-pagination-dans-la-fonctionnalitee-de-recherche">Bonus : Ajouter une pagination dans la fonctionnalitée de recherche.</a></li><li><a href="#bonus-les-produits">Bonus : Les produits</a></li><li><a href="#bonus-l-authentification">Bonus : L&#39;authentification</a></li></ul></li></ul></nav></details><h2 id="le-projet" tabindex="-1">Le projet <a class="header-anchor" href="#le-projet" aria-label="Permalink to &quot;Le projet&quot;">​</a></h2><p>Dans le <a href="./tp1.1.html">TP todo liste</a> nous avons vu la mise en place du design pattern MVC. Le découpage en 3 classes est le minimum, nous allons voir ici qu&#39;il est possible d&#39;exploiter la puissance de la programmation orientée objet (POO) pour organiser son code autour de classes qui auront un sens dans le cadre de votre projet.</p><ul><li><a href="/cheatsheets/poo/">Aide mémoire Programmation Orientée Objet</a></li><li><a href="/cheatsheets/poo-uml/">La modélisation objet</a></li><li><a href="/cheatsheets/mini-mvc-sample/">Aide mémoire Mini MVC Sample</a></li></ul><p>Le projet que vous allez réaliser est ce que l&#39;on appelle une CRM (Customer Relationship Management), c&#39;est un site (outil) qui va permettre d&#39;afficher des informations clients sous le format d&#39;une <code>Fiche Client</code>. Vous allez donc de voir créer quelques éléments de cette application à savoir :</p><ul><li>Lister les clients.</li><li>Rechercher les clients.</li><li>Voir la fiche d&#39;un client (et afficher ces informations).</li><li>Voir la liste des produits commandée par le client consulté.</li><li><em>Bonus</em> : Afficher la liste des contacts d&#39;un client.</li></ul><div class="danger custom-block"><p class="custom-block-title">Un instant</p><p>Nous allons nous placer ici dans un contexte type « entreprise » ou vous aurez à votre disposition un code existant. Pas d&#39;inquiétude, le code de base est relativement petit, cependant il intègre des fonctionnements nouveaux. Donc, comme d&#39;habitude je vous demande d&#39;être curieux et de fouiner dans le code avant d&#39;attaquer votre travail.</p></div><h2 id="recuperer-le-projet-de-base" tabindex="-1">Récupérer le projet de base <a class="header-anchor" href="#recuperer-le-projet-de-base" aria-label="Permalink to &quot;Récupérer le projet de base&quot;">​</a></h2><p>Le projet de base est disponible <a href="https://github.com/c4software/mini-mvc-sample/archive/refs/tags/2.8.zip" target="_blank" rel="noreferrer">à l&#39;adresse suivante en cliquant ici</a></p><div class="tip custom-block"><p class="custom-block-title">C&#39;est un projet vide</p><p>Même si celui-ci contient à première vue « beaucoup de fichiers », le projet que vous avez téléchargé est bien un projet vide.</p></div><h2 id="pdo-vous-connaissez" tabindex="-1">PDO vous connaissez ? <a class="header-anchor" href="#pdo-vous-connaissez" aria-label="Permalink to &quot;PDO vous connaissez ?&quot;">​</a></h2><p>Évidemment <a href="https://www.php.net/manual/en/book.pdo.php" target="_blank" rel="noreferrer">PDO</a> vous connaissez… Mais connaissez-vous <code>FETCH_CLASS</code> ? Vous ne l&#39;avez peut-être pas remarqué, mais la structure MVC n&#39;utilise pas l&#39;habituel<code>FETCH_ASSOC</code> , mais <code>FETCH_CLASS</code>. Ça veut dire qu&#39;à partir de maintenant nous allons utiliser une syntaxe objet plutôt que des tableaux lors de la récupération de données en base !</p><p><img src="'+l+`" alt="WHY" loading="lazy"></p><p>Rassurez-vous, la lecture et l&#39;écriture du code en seront grandement simplifiées ! Voilà quelques exemples :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/** </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@var</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Client</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> $clients */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($clients </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $c) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">div</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;card m-3 p-3&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&lt;?=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">generalInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;small&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&lt;?=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">contactInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Liste des produits</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $produits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lesProduits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($produits) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            ?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Les</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> produits</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($produits </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $p) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">li</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&lt;?=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $p</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">li</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Liste des adresses</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        $adresses </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $c</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lesAdresses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sizeof</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($adresses) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            ?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Les</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> adresses</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">h4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($adresses </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $a) { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                    &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">li</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&lt;?=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">li</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">div</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>Plus simple, non ? Ça va être surtout beaucoup plus puissant ! Nous allons être capables d&#39;encapsuler la logique dans des objets que nous manipulerons directement dans notre vue.</p><h2 id="avant-d-aller-plus-loin-un-usage-avance-du-routeur" tabindex="-1">Avant d&#39;aller plus loin… un usage avancé du routeur <a class="header-anchor" href="#avant-d-aller-plus-loin-un-usage-avance-du-routeur" aria-label="Permalink to &quot;Avant d&#39;aller plus loin… un usage avancé du routeur&quot;">​</a></h2><p>La structure MVC que vous avez à votre disposition incorpore également la possibilité d&#39;avoir des routes « dynamiques », exemple :</p><ul><li><code>/sample/utilisateur/42</code></li><li><code>/sample/utilisateur/420</code></li></ul><p>ou encore :</p><ul><li><code>/sample/fiche/1</code></li><li><code>/sample/fiche/123</code></li></ul><p>=&gt; Que constatez-vous ?</p><details class="details custom-block"><summary>Élément de réponse</summary><p>Nous avons effectivement une partie « variable » dans notre route, dans le cas des exemples :</p><ul><li><code>/sample/utilisateur/42</code> =&gt; Consulter l&#39;utilisateur avec comme identifiant <strong>42</strong>.</li><li><code>/sample/utilisateur/420</code> =&gt; Consulter l&#39;utilisateur avec comme identifiant <strong>420</strong>.</li></ul><p>ou encore :</p><ul><li><code>/sample/fiche/1</code> =&gt; Consulter la fiche avec comme identifiant <strong>1</strong>.</li><li><code>/sample/fiche/123</code> =&gt; Consulter la fiche avec comme identifiant <strong>123</strong>.</li></ul><p>C&#39;est routes sont des équivalents à :</p><ul><li><code>/sample/utilisateur?id=42</code> =&gt; Consulter l&#39;utilisateur avec comme identifiant <strong>42</strong>.</li><li><code>/sample/utilisateur?id=420</code> =&gt; Consulter l&#39;utilisateur avec comme identifiant <strong>420</strong>.</li><li><code>/sample/fiche?id=1</code> =&gt; Consulter la fiche avec comme identifiant <strong>1</strong>.</li><li><code>/sample/fiche?id=123</code> =&gt; Consulter la fiche avec comme identifiant <strong>123</strong>.</li></ul><p><strong>Mais en beaucoup plus lisible !</strong></p></details><p>Ce type de lien est très présent sur Internet, la structure MVC permet évidemment la création de ceux-ci.</p><p>Testons ça dans votre routeur :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/client/{id}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$main, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;client&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Et dans votre Contrôleur :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> client</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($id)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Voici le client avec l&#39;identifiant </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$id</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Je vous laisse tester.</p><div class="tip custom-block"><p class="custom-block-title">Valider le bon fonctionnement</p><ul><li>Tester le code proposé.</li><li>Écrire une vue plutôt qu&#39;un simple <code>echo</code>.</li><li>À votre avis à quoi cela sert-il ?</li></ul></div><h2 id="le-code-de-base" tabindex="-1">Le code de base <a class="header-anchor" href="#le-code-de-base" aria-label="Permalink to &quot;Le code de base&quot;">​</a></h2><p>Ici dans ce TP vous ne partirez pas de 0. J&#39;ai écrit pour vous la partie « couche de données », il faudra donc avant d&#39;attaquer analyser les différents diagrammes pour comprendre le code fourni.</p><h3 id="les-modeles" tabindex="-1">Les modèles <a class="header-anchor" href="#les-modeles" aria-label="Permalink to &quot;Les modèles&quot;">​</a></h3><p>Dans ce TP vous allez travailler essentiellement la manipulation d&#39;objet. Pour attaquer directement ce qui nous intéresse, voilà quelques modèles à télécharger et à déposer dans le dossier <code>models</code> de votre projet.</p><p><a href="https://cours.brosseau.ovh/demo/php/poo-mvc/tp2-modele-class.zip" target="_blank" rel="noreferrer">Télécharger les classes et modèles</a></p><h3 id="la-base-de-donnees" tabindex="-1">La base de données <a class="header-anchor" href="#la-base-de-donnees" aria-label="Permalink to &quot;La base de données&quot;">​</a></h3><p>Pour faire fonctionner les modèles, vous devez évidemment avoir la base de données compatible. La voilà :</p><p><a href="https://cours.brosseau.ovh/demo/php/poo-mvc/tp2-bdd.sql.zip" target="_blank" rel="noreferrer">Télécharger la base de données</a></p><p>Afin de vous permettre de la comprendre, voilà le diagramme de celle-ci.</p><p><img src="`+t+'" alt="Diagramme BDD" loading="lazy"></p><p>Je vous laisse importer la base de données sur votre ordinateur.</p><div class="tip custom-block"><p class="custom-block-title">Import ?</p><p>Point important la base de données n&#39;oubliez pas le dossier migration. En déposant le script dans le dossier <code>migration</code> de votre projet. Vous pourrez initialiser la base de données avec la commande suivante :</p><div class="language-sh vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> db:migrate</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></div><h3 id="diagramme-de-classe-uml-relative-aux-modeles" tabindex="-1">Diagramme de classe / UML relative aux modèles <a class="header-anchor" href="#diagramme-de-classe-uml-relative-aux-modeles" aria-label="Permalink to &quot;Diagramme de classe / UML relative aux modèles&quot;">​</a></h3><p>Pour bien comprendre les classes que je vous fournis, voilà le diagramme de classe qui permet de les comprendre.</p><h4 id="diagramme-des-classes" tabindex="-1">Diagramme des classes <a class="header-anchor" href="#diagramme-des-classes" aria-label="Permalink to &quot;Diagramme des classes&quot;">​</a></h4><p><img src="'+r+'" alt="Diagramme de classe" loading="lazy"></p><h4 id="diagramme-des-modeles" tabindex="-1">Diagramme des modèles <a class="header-anchor" href="#diagramme-des-modeles" aria-label="Permalink to &quot;Diagramme des modèles&quot;">​</a></h4><p><img src="'+p+'" alt="Diagramme de modèles" loading="lazy"></p>',50),k=s("div",{class:"warning custom-block"},[s("p",{class:"custom-block-title"},"STOP"),s("p",null,"Arrêtons-nous un instant pour analyser les diagrammes."),s("iframe",{src:"https://giphy.com/embed/xCwYFe19SldXLrJlwm",width:"480",height:"480",frameBorder:"0",class:"giphy-embed",allowFullScreen:""})],-1),g=e('<h2 id="la-page-de-liste-recherche" tabindex="-1">La page de liste / recherche <a class="header-anchor" href="#la-page-de-liste-recherche" aria-label="Permalink to &quot;La page de liste / recherche&quot;">​</a></h2><p>Maintenant que vous avez vu l&#39;ensemble des méthodes à votre disposition pour accéder aux données présentes en base. Je vous propose de travailler sur la liste des clients présents en base de données.</p><p>Cette fonctionnalité est appelée la page de « Liste de Recherche ». Elle va lister l&#39;ensemble des clients présents en base et permettra l&#39;accès à la fiche client.</p><p>Pour vous aider dans votre conception l&#39;entreprise vous fournit le « mockup » d&#39;interface suivant :</p><p><img src="'+h+`" alt="Idée de design" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Quelques éléments pour vous aider.</p><p>Les zones « blanches » visibles dans le design sont appelées des Cards. Ils sont fournis de base dans Bootstrap ou Tailwind. N&#39;hésitez pas à les utiliser.</p><p>Les résultats (liste des clients) sont une donnée tabulée, plutôt que de réinventer ce genre de choses avec des <code>div</code> n&#39;hésitez pas à utiliser l&#39;élément HTML prévu à cet effet à savoir une <code>table</code>.</p></div><p>Maintenant que vous avez les bases en tête, nous allons pouvoir attaquer la conception de cette première page.</p><h3 id="creer-le-controleur" tabindex="-1">Créer le contrôleur <a class="header-anchor" href="#creer-le-controleur" aria-label="Permalink to &quot;Créer le contrôleur&quot;">​</a></h3><p>La première étape dans une structure (MVC) comme celle que vous avez à votre disposition est de créer un contrôleur. Ce premier contrôleur sera dédié à la gestion de la liste des clients ainsi que la recherche. Nous pouvons le nommer par exemple <code>ClientController</code> (très original oui…).</p><div class="tip custom-block"><p class="custom-block-title">Pour rappel</p><p>La structure MVC intègre un outil en ligne de commande afin de simplifier la création. Vous pouvez donc saisir dans le terminal la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">php</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mvc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> controller:create</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ClientController</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Vous avez maintenant un contrôleur vide dans votre projet !</p></div><p>Je vous laisse créer une première méthode dedans qui aura pour but à terme d&#39;afficher la liste des clients. Vous pouvez la nommer par exemple <code>liste</code> ou <code>listeClient</code>.</p><h3 id="creer-la-vue" tabindex="-1">Créer la vue <a class="header-anchor" href="#creer-la-vue" aria-label="Permalink to &quot;Créer la vue&quot;">​</a></h3><p>Maintenant que nous avons créé la base de notre contrôleur, nous pouvons préparer la vue. Je vous laisse créer celle-ci dans le dossier <code>views/liste/</code>.</p><div class="tip custom-block"><p class="custom-block-title">Quelques éléments pour vous aider.</p><p>Les zones « blanches » visibles dans le design sont appelées des Cards. Ils sont fournis de base dans Bootstrap ou Tailwind. N&#39;hésitez pas à les utiliser.</p><p>Les résultats (liste des clients) sont une donnée tabulée, plutôt que de réinventer ce genre de choses avec des <code>div</code> n&#39;hésitez pas à utiliser l&#39;élément HTML prévu à cet effet à savoir une <code>table</code>.</p></div><h3 id="creer-la-route" tabindex="-1">Créer la route / <a class="header-anchor" href="#creer-la-route" aria-label="Permalink to &quot;Créer la route /&quot;">​</a></h3><p>Maintenant que nous avons notre contrôleur et notre vue, nous devons ajouter notre route. Le client souhaite une CRM Client, il faut donc remplacer la page d&#39;accueil de base de la structure par votre page fraîchement créé.</p><p>Modifier votre routeur pour faire pointer le lien <code>/</code> vers votre contrôleur ainsi que vers votre méthode. Pour vous aider, vous devriez avoir dans votre routeur <strong>une</strong> ligne ressemblant à ceci :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [$clientControleur, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;liste&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="danger custom-block"><p class="custom-block-title"><code>$clientControleur</code> ?</p><p>Ceci est un objet instancié à partir de la classe de votre ClientControleur. Pour que ça fonctionne, il faut évidemment avoir créé un objet de type <code>ClientControleur</code> dans votre code.</p></div><h3 id="afficher-la-liste-des-clients" tabindex="-1">Afficher la liste des clients <a class="header-anchor" href="#afficher-la-liste-des-clients" aria-label="Permalink to &quot;Afficher la liste des clients&quot;">​</a></h3><p>Nous y voilà ! Vous avez Votre Vue, Votre Controleur… Il ne manque plus que le modèle. Dans ce projet vous n&#39;allez pas écrire de modèle, mais vous allez utiliser des modèles existants créés par un tiers (ce qui risque d&#39;arriver par exemple … en stage).</p><p>Avant de continuer cette première page, il faut trouver le bon modèle à utiliser pour pouvoir construire votre liste de clients. Vu que c&#39;est le premier, je vous propose que nous le fassions ensemble…</p><p>Vous avez dans le diagramme UML de classe une classe nommée <code>ClientModele</code>, celle-ci contient l&#39;ensemble du code permettant de rechercher des données dans la base client. Si vous regardez le diagramme en détail, vous avez accès à une méthode <code>liste</code> (avec deux paramètres). Celle-ci retourne un tableau (<code>array</code>), mais pas un array de n&#39;importe quoi ! Elle retourne un <code>array</code> de client, que nous pouvons nommer ainsi <code>Client[]</code>.</p><p>L&#39;objet client représente un client en base de données, il inclut donc l&#39;ensemble des champs, <strong>mais également</strong> des méthodes permettant d&#39;accéder par exemple à la liste des produits ou des adresses d&#39;un client.</p><div class="danger custom-block"><p class="custom-block-title">Ne pas copier/coller le code suivant c&#39;est un exemple.</p><p>Concrètement ça permet d&#39;écrire quelque chose comme :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// À mettre dans le constructeur évidemment</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$clientModele </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ClientModele</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Récupère les clients en base.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$lesClients </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $clientModele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">liste</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Affiche l&#39;ensemble des clients en base. </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pour chaque client, affiche les informations général de celui</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// La méthode generalInfo() est disponible dans la classe Client.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ($lesClients </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $leClient){</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $leClient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">generalInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>Hyper pratique, non ?</strong></p></div><p>Vu qu&#39;il s&#39;agit de la première fois, je vous aide un peu sur la méthode de votre contrôleur (mais attention, ça sera la seule fois dans le TP).</p><p><em>Extrait de code du contrôleur</em>:</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> __construct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    $this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clientModele </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ClientsModele</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> liste</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($page </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    $clients </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> $this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">clientModele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">liste</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, $page);</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &quot;views/liste/client.php&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;page&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $page, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;clients&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $clients)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    );</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="ajouter-la-pagination-et-la-fonctionnalite-de-recherche" tabindex="-1">Ajouter la pagination et la fonctionnalité de recherche <a class="header-anchor" href="#ajouter-la-pagination-et-la-fonctionnalite-de-recherche" aria-label="Permalink to &quot;Ajouter la pagination et la fonctionnalité de recherche&quot;">​</a></h3><p>Vous avez à votre disposition dans le bon modèle <code>ClientModele</code> une méthode permettant d&#39;effectuer une recherche. Après l&#39;avoir trouvé, je vous laisse écrire le code dans votre contrôleur pour effectuer une recherche dans la base de données des clients.</p><p>⚠️ Un instant ! Ici pas besoin de créer une nouvelle route ! Vous devez modifier la méthode de liste pour ajouter de nouveaux paramètres pour la pagination et la partie recherche.</p><div class="tip custom-block"><p class="custom-block-title">Vous ne pouvez pas deviner</p><p>Il faut donc « tester », « expérimenter », pour ça vous avez à votre disposition la documentation de PHP, mais également vos connaisances de première année. Par exemple, pour passer un paramètre à votre PHP en GET vous savez déjà faire :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> href</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/?nom=valeur&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Lien</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> vers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> une</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> page</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> avec</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> un</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> paramètre</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Dans le cas du paramètre page, vous pouvez donc écrire :</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> href</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/?page=2&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Page</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> suivante</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Avec la structure MVC, le paramètre page=XXX sera automatiquement récupéré par votre routeur et sera passé en paramètre de votre méthode (si vous avez bien respecté la signature de la méthode).</p></div><div class="danger custom-block"><p class="custom-block-title">Point variables</p><p>Pour incrémenter une variable, vous pouvez utiliser la syntaxe suivante :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$maVariable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$maVariable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Ici, nous incrémentons la variable de 1, mais celle-ci sera directement modifiée. C&#39;est pratique, mais dans le cas d&#39;une pagination (ou nous allons faire +1 et -1) il faut faire attention <strong>à ne pas modifier</strong> la variable d&#39;origine. Pour cela, il faut utiliser la syntaxe suivante :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$maVariable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $maVariable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Affiche 2</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $maVariable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Affiche 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div><h2 id="la-fiche-client" tabindex="-1">La fiche client <a class="header-anchor" href="#la-fiche-client" aria-label="Permalink to &quot;La fiche client&quot;">​</a></h2><p>Maintenant que la liste des clients fonctionne, nous allons créer la fiche client. Celle-ci a pour but d&#39;afficher les informations <strong>d&#39;un client</strong>, il va donc falloir être capables de récupérer les informations d&#39;un client via <code>son identifiant</code> puis d&#39;en afficher le détail. L&#39;entreprise pour vous aider vous propose le design suivant :</p><p><img src="`+o+`" alt="Idée de design" loading="lazy"></p><h3 id="le-controleur" tabindex="-1">Le contrôleur <a class="header-anchor" href="#le-controleur" aria-label="Permalink to &quot;Le contrôleur&quot;">​</a></h3><p>Nous avons un controleur existant <code>ClientControleur</code>, celui-ci va devoir être modifié pour ajouter une nouvelle méthode <code>fiche</code>. Celle-ci va devoir récupérer les informations d&#39;un client et les passer à la vue.</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> fiche</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // À compléter avec les bons appels de méthode.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // …</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Affichage de la vue ($client est un objet de type Client, récupéré en base via votre modèle et son identifiant)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Template</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">render</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;views/fiche/client&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;client&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $client]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="" tabindex="-1">Créer la route /client/ <a class="header-anchor" href="#" aria-label="Permalink to &quot;Créer la route /client/{id}&quot;">​</a></h3><p>Nous avons vu en introduction de ce TP qu&#39;il était possible de réaliser des routes assez jolies. Je vous laisse créer une nouvelle route dans votre projet. Celle-ci va devoir devra appeler la méthode <code>fiche</code> de votre contrôleur <code>FicheControleur</code>.</p><h3 id="creer-la-fiche-client" tabindex="-1">Créer la fiche client <a class="header-anchor" href="#creer-la-fiche-client" aria-label="Permalink to &quot;Créer la fiche client&quot;">​</a></h3><p>À cette étape il s&#39;agit de créer la vue qui permettra d&#39;afficher les données d&#39;un client.</p><div class="tip custom-block"><p class="custom-block-title">Quelques éléments pour vous aider.</p><p>Les zones « blanches » visibles dans le design sont appelées des Cards. Ils sont fournis de base dans Bootstrap ou Tailwind. N&#39;hésitez pas à les utiliser.</p><p>Les différentes listes (produits, adresses) sont des données tabulées, plutôt que de réinventer ce genre de choses avec des <code>div</code> n&#39;hésitez pas à utiliser l&#39;élément HTML prévu à cet effet à savoir une <code>table</code>.</p></div><h3 id="recuperer-un-client" tabindex="-1">Récupérer un client <a class="header-anchor" href="#recuperer-un-client" aria-label="Permalink to &quot;Récupérer un client&quot;">​</a></h3><p>Pour que votre vue affiche votre client, vous devez trouver la bonne méthode dans le bon modèle. Vous avez à votre disposition une méthode <code>getClientById</code> qui prend en paramètre l&#39;id d&#39;un client et qui retourne un objet de type <code>Client</code>. Je pense que j&#39;en ai dit assez pour que vous puissiez avancer.</p><div class="tip custom-block"><p class="custom-block-title">Vous ne pouvez pas deviner</p><p>Ici, pas d&#39;invention possible. Vous devez vous référer aux deux diagrammes UML pour connaître les méthodes à appeler et connaître le fonctionnement de l&#39;objet <code>Client</code>.</p></div><details class="details custom-block"><summary>Besoin d&#39;aide ?</summary><p>Vous ne devriez pas en avoir besoin… Cependant, voici un petit coup de pouce.</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Modèle permettant l&#39;accès à la BDD</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$clientModele </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ClientModele</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Récupération du client avec 1 comme identifiant.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$leClient </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $clientModele</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getByClientId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Exemple, retourne le nom du client.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$leClient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getNom</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Exemple, retourne la liste des clients du produit.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$lesProduitDuClient </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $leClient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lesProduits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>Évidemment, vous devez adapter le code à votre besoin.</strong> N&#39;hésitez pas à regarder le code des modèles pour voir les méthodes disponibles, mais également l&#39;exemple présent en début de TP.</p></details><h3 id="afficher-la-liste-des-produits-d-un-client" tabindex="-1">Afficher la liste des produits d&#39;un client <a class="header-anchor" href="#afficher-la-liste-des-produits-d-un-client" aria-label="Permalink to &quot;Afficher la liste des produits d&#39;un client&quot;">​</a></h3><p>Si vous avez avancé comme prévu, vous avez à votre disposition dans votre vue un objet de type Client. Cet objet possède une méthode <code>lesProduits()</code> (comme indiqué dans le diagramme UML), celle-ci va pour permettre de récupérer la liste des produits commandés par le client. Vous allez devoir l&#39;utiliser dans votre HTML.</p><p>Cette méthode va retourner une liste (array). Cette liste ne sera pas de n&#39;importe quel type ça sera une liste de <code>Produit</code>, nous pouvons donc écrire que cette liste retourne <code>Produit[]</code>.</p><p><em>Exemple d&#39;utilisation</em> :</p><div class="language-php vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> foreach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">($leClient</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lesProduits</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $leProduit){ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">li</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;?=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $leProduit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">li</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    &lt;?</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">php</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ul</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Je vous laisse écrire le code dans votre vue afin d&#39;afficher la liste des produits d&#39;un client comme demandé.</p><h3 id="ajouter-un-produit-au-client" tabindex="-1">Ajouter un produit au client <a class="header-anchor" href="#ajouter-un-produit-au-client" aria-label="Permalink to &quot;Ajouter un produit au client&quot;">​</a></h3><p>Ajouter le code permettant d&#39;ajouter un produit à un client. Pour réaliser cette action, vous aller avoir besoin :</p><ul><li>D&#39;une vue avec un formulaire (pour choisir le produit).</li><li>D&#39;une route permettant d&#39;ajouter le produit choisi à l&#39;utilisateur actuellement consulté.</li><li>D&#39;une méthode dans votre contrôleur qui prendra deux paramètres <code>$clientId</code> et <code>$produitId</code><ul><li>Cette méthode va appeler la bonne méthode dans le bon modèle.</li><li>Rediriger l&#39;utilisateur vers la fiche du client.</li></ul></li></ul><h2 id="les-adresses-clients" tabindex="-1">Les adresses clients <a class="header-anchor" href="#les-adresses-clients" aria-label="Permalink to &quot;Les adresses clients&quot;">​</a></h2><p>En reprenant le principe de la liste des produits dans la fiche client, écrire le code qui permet :</p><ul><li>D&#39;afficher la liste des adresses d&#39;un client.</li><li>Créer et ajouter une adresse à un client.</li></ul><div class="warning custom-block"><p class="custom-block-title">En manque d&#39;inspiration ?</p><p>Pour traiter la demande d&#39;affichage des adresses d&#39;un utilisateur, vous devez regarder l&#39;UML et plus précisément les méthodes accessibles dans l&#39;objet <code>Client</code>. En regardant attentivement, vous devriez trouver une méthode nommée <code>lesAdresses()</code>. Cette méthode retourne un tableau des adresses utilisateur.</p><p>Pour l&#39;ajout, vous allez devoir utiliser le modèle <code>AdresseModele</code> et plus particulièrement la méthode <code>creerAdresseClient</code> qui vous permettra d&#39;ajouter une adresse.</p></div><h2 id="la-liste-des-contacts" tabindex="-1">La liste des contacts <a class="header-anchor" href="#la-liste-des-contacts" aria-label="Permalink to &quot;La liste des contacts&quot;">​</a></h2><p>En reprenant le principe de la partie « Produit » ou « Adresse ». Le développeur de la société vous demande d&#39;ajouter le code nécessaire pour que :</p><ul><li>Votre client possède plusieurs données de contact <code>(Nom du contact, Numéro, Email)</code>.</li></ul><p>Il vous demande de modifier l&#39;objet <code>Client</code> pour ajouter un nouveau <code>getters</code> permettant d&#39;obtenir l&#39;ensemble des contacts d&#39;un client.</p><div class="tip custom-block"><p class="custom-block-title">À faire</p><p>Pour traiter ce problème, vous devez découper votre travail en différentes étapes :</p><ul><li>Créer un nouveau modèle <code>php mvc model:create ContactModele</code></li><li>Ajouter en base la tables.</li><li>Écrire les requêtes dans votre modèle.</li><li>Créer un objet <code>Contact</code> (prendre exemple sur ceux déjà présents dans le code, dans le dossier <code>classes</code>).</li><li>Afficher les contacts du client dans la partie Fiche Client.</li></ul></div><h2 id="restitution-du-travail" tabindex="-1">Restitution du travail <a class="header-anchor" href="#restitution-du-travail" aria-label="Permalink to &quot;Restitution du travail&quot;">​</a></h2><p>Vous avez atteint la fin du TP (hors bonus). Il est temps de rendre votre travail. Pour cela, vous remplissez le formulaire suivant :</p>`,68),m=s("iframe",{src:"https://docs.google.com/forms/d/e/1FAIpQLSfybcRlzChYkU3rj3orI4Fkh82mOalfN4myNzMNdIHydMzNZQ/viewform?embedded=true",width:"100%",height:"500",frameborder:"0",marginheight:"0",marginwidth:"0"},"Loading…",-1),b=e('<h2 id="les-bonus" tabindex="-1">Les bonus <a class="header-anchor" href="#les-bonus" aria-label="Permalink to &quot;Les bonus&quot;">​</a></h2><p>Un bon TP se termine toujours par de bons bonus. Les bonus vont vous permettre de voir si vous avez compris les manipulations précédemment réalisées.</p><h3 id="bonus-ajouter-une-pagination-dans-la-fonctionnalitee-de-recherche" tabindex="-1">Bonus : Ajouter une pagination dans la fonctionnalitée de recherche. <a class="header-anchor" href="#bonus-ajouter-une-pagination-dans-la-fonctionnalitee-de-recherche" aria-label="Permalink to &quot;Bonus : Ajouter une pagination dans la fonctionnalitée de recherche.&quot;">​</a></h3><p>Modifier votre code pour ajouter un système de pagination (10 clients par 10 clients) dans votre liste. Les méthodes que vous avez utilisées comportent différents paramètres permettant de réaliser des listes paginées. Après l&#39;avoir trouvé, je vous laisse donc :</p><ul><li>Modifier l&#39;interface afin de permettre la pagination.</li><li>Modifier vos appels aux modèles pour réaliser des listes paginées.</li></ul><h3 id="bonus-les-produits" tabindex="-1">Bonus : Les produits <a class="header-anchor" href="#bonus-les-produits" aria-label="Permalink to &quot;Bonus : Les produits&quot;">​</a></h3><p>Vous avez précédemment codé la partie Fiche client. Le développeur de l&#39;entreprise vous demande maintenant d&#39;ajouter les différents écrans pour afficher les produits. La première étape va donc être la création d&#39;un contrôleur.</p><h4 id="bonus-lister-les-produits-en-base" tabindex="-1">Bonus : Lister les produits en base <a class="header-anchor" href="#bonus-lister-les-produits-en-base" aria-label="Permalink to &quot;Bonus : Lister les produits en base&quot;">​</a></h4><ul><li>Créer la vue permettant de liste les produits présente en base.</li><li>Créer la route permettant d&#39;afficher votre vue.</li><li>À l&#39;aide du bon modèle affiché la liste de l&#39;ensemble des produits.</li></ul><p>Voilà à quoi pourrait ressembler l&#39;écran :</p><p><img src="'+d+'" alt="Les produits" loading="lazy"></p><h4 id="ajouter-un-produit-en-base" tabindex="-1">Ajouter un produit en base <a class="header-anchor" href="#ajouter-un-produit-en-base" aria-label="Permalink to &quot;Ajouter un produit en base&quot;">​</a></h4><ul><li>Créer la vue permettant d&#39;ajouter un nouveau produit en base.</li><li>Créer la route permettant d&#39;afficher cette nouvelle vue.</li><li>Écrire la logique dans votre nouveau contrôleur pour ajouter un produit en base à l&#39;aide des modèles déjà présents.</li></ul><h3 id="bonus-l-authentification" tabindex="-1">Bonus : L&#39;authentification <a class="header-anchor" href="#bonus-l-authentification" aria-label="Permalink to &quot;Bonus : L&#39;authentification&quot;">​</a></h3><p>Le développeur de l&#39;entreprise vous demande d&#39;ajouter un système d&#39;authentification afin de sécuriser l&#39;accès à votre CRM. Pour cela, vous allez devoir :</p><ul><li>Créer un nouveau modèle <code>php mvc model:create UtilisateurModele</code></li><li>Créer une nouvelle table <code>utilisateur</code> en base de données.</li><li>Créer une nouvelle vue permettant de se connecter.</li><li>Créer une nouvelle route permettant d&#39;afficher la vue.</li><li>Écrire la logique dans votre nouveau contrôleur pour authentifier un utilisateur à l&#39;aide des modèles déjà présents.</li></ul><div class="tip custom-block"><p class="custom-block-title">À faire</p><ul><li><p>N&#39;oubliez pas de modifier votre routeur pour que la page d&#39;accueil pointe vers votre nouvelle page de connexion.</p></li><li><p>N&#39;oubliez pas également de modifier votre routeur afin de ne pas autoriser l&#39;accès à votre CRM sans être connecté (sauf la page de connexion évidemment).</p></li></ul></div>',17),v=[u,k,g,m,b];function y(E,F,C,f,A,D){return n(),a("div",null,v)}const P=i(c,[["render",y]]);export{B as __pageData,P as default};
