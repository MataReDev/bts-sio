import{_ as e}from"./chunks/version1.DSsN59F8.js";import{_ as s,c as i,o as a,U as r}from"./chunks/framework.aGaNZw_P.js";const t="/assets/devops_loop.DNHg_bRj.webp",n="/assets/tobias01.Bjlrn95I.png",l="/assets/os_share.CBaauh3e.jpg",o="/assets/serveur_linux.BafIivhS.png",u="/assets/serveur.BKMcidtv.jpg",p="/assets/asymmetric-encryption.HtN_wJZI.png",d="/assets/ssh-key-based-authentication.DLtQaCnL.png",c="/assets/graylog1.5jM9jD7N.png",L=JSON.parse('{"title":"Complément du cours Serveur","description":"Ce document est un complément du cours. Il vous permettra de revenir sur les différentes notions avec différents exemples.","frontmatter":{"description":"Ce document est un complément du cours. Il vous permettra de revenir sur les différentes notions avec différents exemples.","tags":"devops, serveur, support"},"headers":[],"relativePath":"tp/devops/serveur/support.md","filePath":"tp/devops/serveur/support.md","lastUpdated":1710456149000}'),h={name:"tp/devops/serveur/support.md"},m=r('<h1 id="complement-du-cours-serveur" tabindex="-1">Complément du cours Serveur <a class="header-anchor" href="#complement-du-cours-serveur" aria-label="Permalink to &quot;Complément du cours Serveur&quot;">​</a></h1><p>Dans ce document, nous allons voir ce que sont les serveurs, les serveurs Web, les serveurs de base de données, etc. Mais surtout, nous allons voir de quoi est constitué un serveur, et comment le gérer.</p><details class="details custom-block"><summary>Sommaire</summary><nav class="table-of-contents"><ul><li><a href="#le-devops">Le DevOps</a></li><li><a href="#l-environnement-des-developpeurs">L&#39;environnement des développeurs</a><ul><li><a href="#windows">Windows</a></li><li><a href="#linux">Linux</a></li><li><a href="#macos">macOS</a></li><li><a href="#votre-os-votre-choix">Votre OS… Votre choix</a></li></ul></li><li><a href="#la-ligne-de-commande">La ligne de commande</a><ul><li><a href="#astuces">Astuces</a></li><li><a href="#l-edition-de-fichier">L&#39;édition de fichier</a></li></ul></li><li><a href="#qu-est-ce-qu-un-serveur">Qu&#39;est-ce qu&#39;un serveur ?</a><ul><li><a href="#comment-representer-un-serveur">Comment représenter un serveur</a></li><li><a href="#comment-resumer-cette-composition">Comment résumer cette composition ?</a></li></ul></li><li><a href="#qu-est-ce-qu-un-serveur-web">Qu&#39;est-ce qu&#39;un serveur Web ?</a></li><li><a href="#qu-est-ce-qu-un-serveur-de-base-de-donnees">Qu&#39;est-ce qu&#39;un serveur de base de données ?</a></li><li><a href="#la-configuration-reseau">La configuration réseau</a></li><li><a href="#les-ports">Les ports</a><ul><li><a href="#iptables">iptables</a></li></ul></li><li><a href="#la-ligne-de-commande-1">La ligne de commande</a><ul><li><a href="#les-commandes-de-base">Les commandes de base</a></li><li><a href="#les-droits">Les droits</a></li><li><a href="#quelques-commandes-utiles">Quelques commandes utiles</a></li></ul></li><li><a href="#la-structure-des-dossiers">La structure des dossiers</a></li><li><a href="#installer-des-logiciels">Installer des logiciels</a><ul><li><a href="#installer-un-logiciel">Installer un logiciel</a></li><li><a href="#mettre-a-jour-un-logiciel">Mettre à jour un logiciel</a></li><li><a href="#supprimer-un-logiciel">Supprimer un logiciel</a></li></ul></li><li><a href="#les-services">Les services</a><ul><li><a href="#gerer-les-services">Gérer les services</a></li></ul></li><li><a href="#les-utilisateurs">Les utilisateurs</a></li><li><a href="#l-acces-a-distance">L&#39;accès à distance</a><ul><li><a href="#les-cles-ssh">Les clés SSH</a></li><li><a href="#autoriser-une-cle-ssh">Autoriser une clé SSH</a></li><li><a href="#se-connecter-a-un-serveur">Se connecter à un serveur</a></li><li><a href="#fonctionnement-d-une-cle-ssh">Fonctionnement d&#39;une clé SSH</a></li></ul></li><li><a href="#les-sauvegardes">Les sauvegardes</a><ul><li><a href="#sauvegarder-les-donnees">Sauvegarder les données</a></li><li><a href="#les-types-de-sauvegardes">Les types de sauvegardes</a></li><li><a href="#exemple-de-script-de-sauvegarde">Exemple de script de sauvegarde</a></li></ul></li><li><a href="#les-logs">Les logs</a><ul><li><a href="#les-logs-du-serveur">Les logs du serveur</a></li><li><a href="#comment-les-analyser">Comment les analyser ?</a></li><li><a href="#exemple-de-logs">Exemple de logs</a></li><li><a href="#superviser-les-logs">Superviser les logs</a></li></ul></li><li><a href="#physique-ou-virtuel">Physique ou virtuel ?</a></li><li><a href="#la-securite">La sécurité</a></li><li><a href="#un-serveur-ou-plusieurs-serveurs">Un serveur ou plusieurs serveurs ?</a><ul><li><a href="#pourquoi-avoir-plusieurs-serveurs">Pourquoi avoir plusieurs serveurs ?</a></li></ul></li><li><a href="#les-environnements">Les environnements</a></li><li><a href="#la-replication">La réplication</a><ul><li><a href="#plusieurs-type-de-replications-existent">Plusieurs type de réplications existent</a></li></ul></li><li><a href="#les-hebergeurs">Les hébergeurs</a><ul><li><a href="#qu-est-ce-qu-un-hebergeur">Qu&#39;est-ce qu&#39;un hébergeur ?</a></li><li><a href="#les-differents-types-d-hebergeurs">Les différents types d&#39;hébergeurs</a></li><li><a href="#les-hebergeurs-1">Les hébergeurs</a></li><li><a href="#comment-choisir-votre-hebergeur">Comment choisir votre hébergeur ?</a></li></ul></li><li><a href="#docker">Docker</a><ul><li><a href="#installation-dans-un-container-docker-ou-directement-sur-la-machine">Installation dans un container Docker ou directement sur la machine ?</a></li><li><a href="#kubernetes">Kubernetes ?</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul></nav></details><details class="details custom-block"><summary>TL;DR</summary><p>Voici un résumé de ce qu&#39;il est possible de retenir de ce document (évidemment, je vous conseille vivement de lire l&#39;ensemble de celui-ci, mais voilà les grandes idées).</p><p>L&#39;approche DevOps à pour objectif principal d&#39;automatiser pour assurer la qualité via par entre autres le test et la répétabilité.</p><p>Les développeurs sont également des utilisateurs d&#39;un OS et pour le comprendre nous réfléchirons aux différentes distributions Linux disponibles en les comparant à Windows et MacOS.</p><p>Beaucoup de types de serveurs existent (serveurs Web, de base de données, de fichiers, etc). en SLAM la notion de la stack logicielle est importante et surtout celle nommée LAMP (Linux, Apache, MySQL, PHP). Un serveur ne fonctionne pas sans que le réseau (adresses IP, DNS, DHCP, les ports permettant de communiquer). Sans entrer dans une complexité extrême, il sera important d&#39;en connaître les bases.</p><p>Nous étudierons également comment la ligne de commandes fonctionne, ainsi que l&#39;architecture d&#39;un serveur Linux (système de fichier, utilisateurs, droits). Un serveur Linux ne possédant pas d&#39;interface graphique, nous utiliserons les protocoles de communication suivants pour l&#39;administrer :</p><ul><li>SSH</li><li>FTP</li><li>SFTP</li></ul><p>⚠️ L&#39;ensemble protégé pas seulement par des mots de passe, mais également par des clés SSH.</p><p>Nous regarderons comment il est possible de mettre en place une analyse pertinente <strong>des logs d&#39;erreurs</strong>. Ainsi qu&#39;une politique de sauvegarde pour s&#39;assurer que notre machine soit toujours fonctionnelle, quels que soient les problèmes qu&#39;elle pourra rencontrer.</p><p>Et finalement nous regarderons comment doit être prise la décision entre un serveur physique ou virtuel. Ainsi que les différents types d&#39;hébergement disponible (mutualisés, dédiés, SaaS) et comment choisir le meilleur pour les besoins.</p></details><h2 id="le-devops" tabindex="-1">Le DevOps <a class="header-anchor" href="#le-devops" aria-label="Permalink to &quot;Le DevOps&quot;">​</a></h2><p>Aujourd&#39;hui, on parle de DevOps, mais c&#39;est quoi ?</p><ul><li>DevOps est une culture, une philosophie, une approche</li><li>DevOps est un ensemble de pratiques, de méthodes, d&#39;outils</li><li>DevOps est une approche centrée sur l&#39;automatisation et l&#39;agilité</li></ul><p>Le DevOps répond à un besoin : celui de faire évoluer les méthodes de développement et de déploiement des applications. L&#39;objectif étant que le développeur puisse déployer son application le plus simplement et rapidement possible. Les développeurs ont utilisé les outils qu&#39;ils avaient à disposition pour automatiser le déploiement de leurs applications. Ils ont donc utilisé les outils de gestion de version (Git, SVN, etc.), les outils de déploiement (intégration continue) mais également les outils de conteneurisation (Docker) pour réaliser leurs tâches.</p><p>Le terme de DevOps est un peu fourre-tout, car il regroupe plusieurs métiers. En effet, le DevOps est un métier qui regroupe plusieurs métiers :</p><ul><li>Développeur.</li><li>Administrateur système.</li><li>Administrateur réseau.</li><li>Administrateur de base de données.</li></ul><p>Le DevOps est donc un métier qui regroupe plusieurs métiers. Il est donc difficile de définir précisément ce qu&#39;est un DevOps. Mais en général, on peut dire que le DevOps est un développeur qui a des connaissances en administration, système, réseau et base de données. L&#39;objectif du devops étant :</p><ul><li>Développer (et maintenir) des applications.</li><li>Choisir la configuration de votre serveur <em>(choix de l&#39;OS, de la distribution, etc.)</em>.</li><li>Déployer votre application sur le serveur <em>(installation, configuration, etc.)</em>.</li><li>Automatiser le déploiement de votre application <em>(intégration continue)</em>.</li><li>Diagnostiquer les problèmes <em>(analyse des logs, superviser.)</em></li><li><strong>Sécuriser</strong> votre serveur <em>(firewall, etc.)</em></li></ul><p>Mais surtout le DevOps <strong>s&#39;assure de la qualité</strong> de son application. Il s&#39;assure que l&#39;application est <strong>disponible</strong>, <strong>performante</strong> et <strong>sécurisée</strong>.</p><p><img src="'+t+'" alt="DevOps" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Définition</p><p>Le DevOps <strong>s&#39;assure de la qualité</strong> de son application, de la <strong>disponibilité</strong>, <strong>performances</strong> et <strong>sécurité</strong>.</p></div><h2 id="l-environnement-des-developpeurs" tabindex="-1">L&#39;environnement des développeurs <a class="header-anchor" href="#l-environnement-des-developpeurs" aria-label="Permalink to &quot;L&#39;environnement des développeurs&quot;">​</a></h2><p>Choisir son environnement de développement est très important. En effet, le choix de l&#39;environnement de développement va déterminer votre productivité. Il est donc important de choisir un environnement de développement adapté à vos besoins.</p><p>Pour coder, un développeur à généralement besoin de :</p><ul><li>Un éditeur de texte.</li><li>Un terminal.</li></ul><p>Nous retrouvons ces deux éléments dans la plupart des environnements de développement. Mais certains environnements de développement vont plus loin et vont proposer des outils supplémentaires.</p><p><img src="'+n+'" alt="Linux, Mac, Windows" loading="lazy"></p><h3 id="windows" tabindex="-1">Windows <a class="header-anchor" href="#windows" aria-label="Permalink to &quot;Windows&quot;">​</a></h3><ul><li><a href="https://code.visualstudio.com/" target="_blank" rel="noreferrer">Visual Studio Code</a></li><li><a href="https://gitforwindows.org/" target="_blank" rel="noreferrer">Git Bash</a></li><li><a href="https://apps.microsoft.com/store/detail/windows-terminal/9N0DX20HK701?hl=fr-fr&amp;gl=fr" target="_blank" rel="noreferrer">Windows Terminal</a></li><li><a href="https://learn.microsoft.com/fr-fr/windows/wsl/install" target="_blank" rel="noreferrer">Windows Subsystem for Linux WSL</a></li></ul><h3 id="linux" tabindex="-1">Linux <a class="header-anchor" href="#linux" aria-label="Permalink to &quot;Linux&quot;">​</a></h3><ul><li><a href="https://code.visualstudio.com/" target="_blank" rel="noreferrer">Visual Studio Code</a></li><li>Git : <code>sudo apt install git</code></li><li>Terminal : Intégré</li></ul><h3 id="macos" tabindex="-1">macOS <a class="header-anchor" href="#macos" aria-label="Permalink to &quot;macOS&quot;">​</a></h3><ul><li><a href="https://code.visualstudio.com/" target="_blank" rel="noreferrer">Visual Studio Code</a></li><li>Git : <code>brew install git</code> (ou <code>xcode-select --install</code>)</li><li>Terminal : Intégré</li></ul><h3 id="votre-os-votre-choix" tabindex="-1">Votre OS… Votre choix <a class="header-anchor" href="#votre-os-votre-choix" aria-label="Permalink to &quot;Votre OS… Votre choix&quot;">​</a></h3><p>Vous pouvez utiliser l&#39;OS que vous souhaitez. Je ne vais pas tenter de vous convertir à un OS en particulier. Mais je vous conseille d&#39;utiliser un environnement de développement qui vous convient. Si vous êtes à l&#39;aise avec Windows, alors utilisez Windows. Si vous êtes à l&#39;aise avec Linux, alors utilisez Linux. Si vous êtes à l&#39;aise avec macOS, alors utilisez macOS.</p><p>Mais sachez qu&#39;utiliser Linux (par exemple) est une vraie réalité en entreprise (tout comme macOS).</p><p><img src="'+l+'" alt="Répartition" loading="lazy"><em>Source: <a href="https://fossbytes.com/windows-still-the-leading-os-for-software-development-followed-by-linux/" target="_blank" rel="noreferrer">fossbytes.com</a></em></p><div class="tip custom-block"><p class="custom-block-title">Définition</p><p>Choisir son OS pour un développeur est une question de <strong>préférence</strong> et de <strong>confort</strong> mais aussi en fonction du langage de programmation <strong>ciblé</strong>.</p></div><h2 id="la-ligne-de-commande" tabindex="-1">La ligne de commande <a class="header-anchor" href="#la-ligne-de-commande" aria-label="Permalink to &quot;La ligne de commande&quot;">​</a></h2><p>La ligne de commande est un outil très puissant. Elle permet de faire des choses très rapidement, très efficacement et (souvent) très simplement.</p><p>Quelques commandes de base :</p><ul><li><code>ls</code> : liste les fichiers et dossiers du répertoire courant.</li><li><code>cd</code> : change le répertoire courant.</li><li><code>pwd</code> : affiche le répertoire courant.</li><li><code>mkdir</code> : crée un répertoire.</li><li><code>touch</code> : crée un fichier.</li><li><code>rm</code> : supprime un fichier ou un répertoire.</li><li><code>cp</code> : copie un fichier ou un répertoire.</li><li><code>mv</code> : déplace un fichier ou un répertoire.</li></ul><div class="tip custom-block"><p class="custom-block-title">La liste est non exhaustive</p><p>Il existe beaucoup d&#39;autres commandes. Mais celles-ci sont les plus utilisées. Vous pouvez les retrouver sur le site <a href="https://linuxcommand.org/" target="_blank" rel="noreferrer">Linux Command</a>.</p></div><h3 id="astuces" tabindex="-1">Astuces <a class="header-anchor" href="#astuces" aria-label="Permalink to &quot;Astuces&quot;">​</a></h3><ul><li><code>tab</code> : complète le nom d&#39;un fichier ou dossier.</li><li><code>ctrl + r</code> : recherche dans l&#39;historique des commandes.</li><li><code>!!</code> : répète la dernière commande.</li></ul><h3 id="l-edition-de-fichier" tabindex="-1">L&#39;édition de fichier <a class="header-anchor" href="#l-edition-de-fichier" aria-label="Permalink to &quot;L&#39;édition de fichier&quot;">​</a></h3><p>Il est possible d&#39;éditer un fichier en ligne de commande. Pour cela, vous pouvez utiliser la commande <code>nano</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fichie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Mais je vous conseille d&#39;utiliser <code>vim</code> à la place. <code>vim</code> est un éditeur de texte très puissant.</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fichie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour utiliser <code>vim</code>, il suffit juste de connaitre quelques commandes :</p><ul><li><code>i</code> : mode insertion.</li><li><code>esc</code> : sort du mode insertion.</li><li><code>:w</code> : enregistre.</li><li><code>:q</code> : quitte.</li><li><code>:wq</code> : enregistre et quitte.</li></ul><h2 id="qu-est-ce-qu-un-serveur" tabindex="-1">Qu&#39;est-ce qu&#39;un serveur ? <a class="header-anchor" href="#qu-est-ce-qu-un-serveur" aria-label="Permalink to &quot;Qu&#39;est-ce qu&#39;un serveur ?&quot;">​</a></h2><p>Un serveur est un ordinateur qui fournit des services à d&#39;autres ordinateurs. Il peut s&#39;agir d&#39;un serveur Web, d&#39;un serveur de base de données, d&#39;un serveur de fichiers, etc.</p><p>Concrètement, un serveur est un ordinateur qui est connecté à un réseau et qui est accessible depuis un autre ordinateur. Il est souvent installé dans un datacenter, c&#39;est-à-dire dans un bâtiment spécialisé qui contient des serveurs. Les serveurs sont souvent installés dans des salles spéciales qui sont climatisées et qui sont surveillées 24h/24 et 7j/7.</p><p>Mais sans aller jusque-là, vous pouvez aussi installer un serveur chez vous. Vous pouvez installer un serveur chez vous pour faire des tests, pour héberger un site Web, etc. Vous pouvez par exemple utiliser un Raspberry Pi comme serveur, et y installer les services que vous souhaitez (Web, Base de données, Domotique, Fichier).</p><div class="tip custom-block"><p class="custom-block-title">Pourquoi installer un serveur chez soi ?</p><p>Il est possible d&#39;installer un serveur chez soi pour faire des tests, pour héberger un site Web, etc. C&#39;est une bonne idée de faire des tests ou pour tester des idées avant de mettre en production sur un serveur distant.</p><p>Créer un serveur à domicile permet réellement de progresser, car vous devrez gérer l&#39;ensemble du serveur. Vous devrez gérer l&#39;installation, la configuration, la sécurité, etc. C&#39;est une bonne expérience pour apprendre l&#39;administration système.</p><p>Voilà à quoi peut ressembler un serveur à domicile (chez moi en l&#39;occurrence) :</p><p><img src="'+e+'" alt="Serveur à domicile" loading="lazy"></p></div><p>Nous pourrions résumer la définition d&#39;un serveur en disant que c&#39;est un ordinateur qui est connecté à un réseau et qui est accessible depuis un autre ordinateur.</p><h3 id="comment-representer-un-serveur" tabindex="-1">Comment représenter un serveur <a class="header-anchor" href="#comment-representer-un-serveur" aria-label="Permalink to &quot;Comment représenter un serveur&quot;">​</a></h3><p>Avant d&#39;aller plus dans le détail, nous pouvons représenter un serveur de la manière suivante :</p><p><img src="'+o+'" alt="Serveur" loading="lazy"></p><p>Cette représentation est très simple, mais elle permet de comprendre les différentes couches d&#39;un serveur. Nous allons voir plus en détail chacune de ces couches.</p><ul><li><strong>Le système d&#39;exploitation</strong> est la couche la plus basse. C&#39;est la couche qui permet de faire fonctionner le serveur. Dans notre cas Linux.</li><li><strong>Les Ports</strong> : Ce sont des numéros qui permettent d&#39;identifier un service. Les ports vont permettre de rendre accessible le service depuis l&#39;extérieur.</li><li><strong>Les utilisateurs</strong> : Une machine == au moins un utilisateur le <strong>root</strong>. Pour respecter les bonnes pratiques, il est préférable de créer un utilisateur dédié à chaque service.</li><li><strong>Les services</strong> : Ce sont définition des applications qui vont tourner en arrière-plan. Par exemple, un serveur Web, un serveur de base de données, etc.</li><li><strong>Les applications</strong> : Ce sont les binaires qui vont être exécutés. Par exemple, Apache, MySQL, etc.</li><li><strong>Les Logs</strong> : Ce sont des fichiers (habituellement dans le dossier <code>/var/log</code>) qui vont contenir les messages générés par les applications (erreurs, informations, etc.).</li><li><strong>Les données</strong> : Ce sont des fichiers exemple le code source de vos applications, ou encore les données de la base de données.</li></ul><h3 id="comment-resumer-cette-composition" tabindex="-1">Comment résumer cette composition ? <a class="header-anchor" href="#comment-resumer-cette-composition" aria-label="Permalink to &quot;Comment résumer cette composition ?&quot;">​</a></h3><p>Un serveur est constitué d&#39;un système d&#39;exploitation (Linux, Windows, etc.), d&#39;utilisateurs, de services, d&#39;applications, de logs et de données. Lorsqu&#39;une application est exécutée en arrière-plan, on l&#39;appelle un service. Pour pouvoir suivre un service, on observe les logs.</p><p>Les services sont accessibles depuis l&#39;extérieur grâce aux ports. Certains ports sont réservés (80 -&gt; HTTP, 443 -&gt; HTTPS, 22 -&gt; SSH, etc.). Il est possible de créer des ports personnalisés pour chaque service.</p><h2 id="qu-est-ce-qu-un-serveur-web" tabindex="-1">Qu&#39;est-ce qu&#39;un serveur Web ? <a class="header-anchor" href="#qu-est-ce-qu-un-serveur-web" aria-label="Permalink to &quot;Qu&#39;est-ce qu&#39;un serveur Web ?&quot;">​</a></h2><p>Un serveur Web est un serveur qui permet de servir des pages Web. Il permet de servir des pages Web statiques (fichiers HTML, CSS, JavaScript, images, etc.), mais aussi des pages Web dynamiques (fichiers PHP, Python, Ruby, etc.).</p><p>Dans notre cas nous utiliserons Apache pour le serveur Web. Apache est un serveur Web open source qui est très utilisé. Il est très puissant et il est très facile à configurer. Il est possible de configurer Apache pour servir des pages Web statiques, mais aussi des pages Web dynamiques.</p><p>Il existe différents serveurs Web, Apache est l&#39;un des plus utilisés. Il existe également Nginx, Caddy, etc. Mais Apache est le plus utilisé, donc c&#39;est le serveur Web que nous utiliserons.</p><ul><li>Nginx est également un serveur Web très puissant, mais il est un peu plus difficile à configurer.</li><li>Caddy est un serveur Web qui est très simple à configurer, mais il est moins puissant qu’apache.</li></ul><p><img src="'+u+`" alt="Serveur" loading="lazy"></p><p>Notre serveur Web sera accessible par différents moyens :</p><ul><li>Il sera accessible via son adresse IP.</li><li>Si vous en avez un, il sera accessible via son nom de domaine.</li></ul><div class="tip custom-block"><p class="custom-block-title">Pourquoi un nom de domaine ?</p><p>Un nom de domaine est un nom qui permet de se connecter à un serveur. Par exemple, si vous avez un nom de domaine, vous pouvez vous connecter à votre serveur via son nom de domaine. Par exemple, si vous avez un nom de domaine <code>monsite.com</code>, vous pouvez vous connecter à votre serveur via <code>monsite.com</code>.</p><p>Techniquement, un nom de domaine est un nom qui est associé à une adresse IP.</p><p>Si votre serveur possède un nom de domaine, nous allons pouvoir également créer ce que l&#39;on appelle des Virtual Hosts. Un Virtual Host est une configuration spécifique qui permet de faire correspondre un sous-domaine avec une site Web sur la machine :</p><ul><li><code>monsite.com</code> correspondra au site Web par défaut.</li><li><code>blog.monsite.com</code> correspondra au site Web du blog.</li><li><code>forum.monsite.com</code> correspondra au site Web du forum.</li><li>etc.</li></ul></div><h2 id="qu-est-ce-qu-un-serveur-de-base-de-donnees" tabindex="-1">Qu&#39;est-ce qu&#39;un serveur de base de données ? <a class="header-anchor" href="#qu-est-ce-qu-un-serveur-de-base-de-donnees" aria-label="Permalink to &quot;Qu&#39;est-ce qu&#39;un serveur de base de données ?&quot;">​</a></h2><p>Un serveur de base de données est un serveur qui permet de stocker des données. Il permet de stocker des données dans des tables, de faire des requêtes SQL, etc.</p><p>Dans notre cas nous utiliserons MariaDB pour le serveur de base de données. MariaDB est un serveur de base de données open source qui est très utilisé. Il est très puissant et il est très facile à configurer. Il est possible de configurer MariaDB pour stocker des données dans des tables, de faire des requêtes SQL, etc. Quel que soit le langage de programmation que vous utilisez, il est possible de se connecter à MariaDB pour stocker et récupérer des données. Par exemple, si vous utilisez PHP, vous pouvez utiliser la librairie PDO pour vous connecter à MariaDB.</p><div class="tip custom-block"><p class="custom-block-title">Pourquoi MariaDB et pas MySQL ?</p><p>C&#39;est une bonne question… MariaDB est un fork de MySQL, c&#39;est-à-dire que c&#39;est une copie de MySQL. MariaDB a été créé parce que Oracle a racheté MySQL. Oracle a ensuite décidé de rendre MySQL payant. MariaDB est donc une copie de MySQL qui est gratuite. MariaDB est donc une alternative à MySQL.</p><p>Ce sont donc deux logiciels équivalents, MariadDB est gratuit et MySQL est pour l&#39;instant également gratuit. Mais le logiciel MySQL pourrait devenir payant à l&#39;avenir d&#39;où l&#39;intérêt de se tourner vers MariaDB.</p></div><h2 id="la-configuration-reseau" tabindex="-1">La configuration réseau <a class="header-anchor" href="#la-configuration-reseau" aria-label="Permalink to &quot;La configuration réseau&quot;">​</a></h2><p>La configuration réseau est une étape importante de la configuration d&#39;un serveur. Si vous ne configurez pas correctement cette étape, il ne sera pas possible de s&#39;y connecter.</p><p>À votre domicile, vous ne vous souciez pas de ceci, car vous avez un DHCP qui s&#39;occupe de tout pour vous. Mais sur un serveur, pour plus de sécurité, il n&#39;y a que très rarement un DHCP. Il faut donc configurer manuellement l&#39;adresse IP de votre serveur.</p><p>En fonction des systèmes d&#39;exploitation que vous utilisez. Sous Linux sans interface graphique vous devrez configurer le fichier <code>/etc/network/interfaces</code>.</p><p>Dans ce fichier vous devrez configurer l&#39;adresse IP, le masque de sous-réseau, la passerelle par défaut, etc.</p><ul><li>L&#39;adresse IP est l&#39;adresse qui permet de se connecter à votre serveur.</li><li>Le masque de sous-réseau est l&#39;adresse qui permet de déterminer les machines qui sont sur le même réseau que votre serveur.</li><li>La passerelle par défaut est l&#39;adresse qui permet de se connecter à votre routeur.</li><li>Le DNS est l&#39;adresse qui permettra à votre serveur de résoudre les noms de domaine (exemple qui est <code>google.com</code> ?).</li></ul><p>Pour simplifier cette procédure, vous trouverez un générateur de configuration ici : <a href="/cheatsheets/serveur/debian-reseau.html">Générateur de configuration réseau Debian</a></p><div class="tip custom-block"><p class="custom-block-title">DHCP ?</p><p>Vous ne vous souvenez plus de ce qu&#39;est le DHCP ? Le DHCP est un service installé sur votre routeur (ou sur un serveur), il permet de configurer automatiquement les machines qui se connectent au réseau. Il permet de configurer l&#39;adresse IP, le masque de sous-réseau, la passerelle par défaut, etc. En quelques mots, comment ça fonctionne ?</p><ul><li>Quand une machine se connecte au réseau, elle envoie une requête au DHCP pour obtenir une configuration réseau.</li><li>Le DHCP lui répond avec une configuration réseau.</li><li>La machine configure automatiquement son adresse IP, son masque de sous-réseau, sa passerelle par défaut, etc.</li></ul></div><h2 id="les-ports" tabindex="-1">Les ports <a class="header-anchor" href="#les-ports" aria-label="Permalink to &quot;Les ports&quot;">​</a></h2><p>Un port est un canal de communication entre deux ordinateurs. Il est possible d&#39;ouvrir des ports sur votre serveur pour permettre à des ordinateurs distants de communiquer avec votre serveur.</p><p>Par exemple, si vous ouvrez le port 80 sur votre serveur, alors les ordinateurs distants pourront communiquer avec votre serveur en utilisant le port 80.</p><p>La liste des ports est standardisée, chaque serveur possède 65535 ports. Les ports vont de 0 à 65535 :</p><ul><li>Les ports vont de 0 à 1023 sont réservés pour les services système.</li><li>Les ports qui vont de 1024 à 65535 sont réservés pour les services utilisateurs.</li></ul><p>Dans les ports réservés pour les services système, il y a les ports suivants :</p><ul><li>22 : SSH</li><li>80 : HTTP</li><li>443 : HTTPS</li><li>3306 : MariaDB</li><li>…</li></ul><p>Dans les ports réservés pour les services utilisateurs, nous retrouvons souvent les ports suivants :</p><ul><li>8080 : HTTP</li><li>8443 : HTTPS</li></ul><div class="tip custom-block"><p class="custom-block-title">Port standard ou port personnalisé ?</p><p>La liste des ports ci-dessus est la liste des ports standards, vous pouvez bien évidemment les changer. Exemple, pour éviter qu&#39;un pirate ne trouve trop facilement le port SSH de votre machine, il est vivement conseillé de le changer.</p></div><p>La notion de port est <strong>très importante,</strong> car il est possible d&#39;ouvrir des ports sur votre serveur. Il est donc important de réfléchir à la question suivante : quels ports ouvrir sur votre serveur ?</p><div class="danger custom-block"><p class="custom-block-title">Attention</p><p>Les ports sont le moyen de faire communiquer votre serveur avec les ordinateurs distants. Même si il est possible d&#39;ouvrir des ports sur votre serveur, il est important de ne pas ouvrir tous les ports. En effet, si vous ouvrez tous les ports, alors n&#39;importe quel ordinateur pourra communiquer avec votre serveur. Cela peut être dangereux, car un pirate pourrait alors se connecter à votre serveur et faire des choses malveillantes.</p></div><h3 id="iptables" tabindex="-1">iptables <a class="header-anchor" href="#iptables" aria-label="Permalink to &quot;iptables&quot;">​</a></h3><p>Sous Linux nous pouvons utiliser iptables pour gérer les ports, grâce à iptable qui est un quelques sortes un pare-feu nous allons pouvoir gérer les ports ouverts / accessibles sur notre serveur. Cette configuration n&#39;est pas à négliger, car elle permet de sécuriser votre serveur.</p><p>Par exemple, si nous réalisons un serveur Web, nous allons ouvrir uniquement le port 80 et le port 443. Nous allons donc bloquer tous les autres ports. Cela permet de sécuriser notre serveur.</p><p>Voilà la configuration d&#39;Iptables pour un serveur Web :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On vide les règles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -F</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On bloque tout</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -P</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INPUT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DROP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On autorise les connexions déjà établies</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INPUT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> state</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ESTABLISHED,RELATED</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACCEPT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On autorise les connexions SSH</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INPUT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACCEPT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On autorise les connexions HTTP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INPUT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACCEPT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On autorise les connexions HTTPS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INPUT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --dport</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 443</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -j</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ACCEPT</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># On sauvegarde les règles</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iptables-save</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/iptables/rules.v4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Pourquoi autoriser les connexions déjà établies ?</p><p>Cela permet de ne pas bloquer les connexions déjà établies. Par exemple, si vous êtes en train de télécharger un fichier sur votre serveur, et que vous perdez votre connexion internet, alors votre navigateur va continuer à télécharger le fichier. Si vous bloquez les connexions déjà établies, alors votre navigateur ne pourra plus télécharger le fichier.</p></div><h2 id="la-ligne-de-commande-1" tabindex="-1">La ligne de commande <a class="header-anchor" href="#la-ligne-de-commande-1" aria-label="Permalink to &quot;La ligne de commande&quot;">​</a></h2><p>Nous avons vu comment se connecter à notre serveur. Maintenant, nous allons voir comment utiliser la ligne de commande pour administrer notre serveur. Ici, pas d&#39;interface graphique, tout se passe en ligne de commande.</p><p>Pourquoi utiliser la ligne de commande ? Parce que c&#39;est plus rapide, plus efficace et plus sécurisé. Vous pouvez automatiser des tâches avec des scripts. De plus celle-ci ne prend pas de ressources de votre serveur !</p><h3 id="les-commandes-de-base" tabindex="-1">Les commandes de base <a class="header-anchor" href="#les-commandes-de-base" aria-label="Permalink to &quot;Les commandes de base&quot;">​</a></h3><p>Pour commencer, nous allons voir quelques commandes de base :</p><ul><li><code>ls</code> : liste les fichiers et dossiers du répertoire courant.</li><li><code>cd</code> : change le répertoire courant.</li><li><code>pwd</code> : affiche le répertoire courant.</li><li><code>mkdir</code> : crée un répertoire.</li><li><code>touch</code> : crée un fichier.</li><li><code>rm</code> : supprime un fichier ou un répertoire.</li><li><code>cp</code> : copie un fichier ou un répertoire.</li><li><code>mv</code> : déplace un fichier ou un répertoire.</li><li><code>cat</code> : affiche le contenu d&#39;un fichier.</li><li><code>nano</code> : édite un fichier (je vous conseille d&#39;utiliser <code>vim</code> à la place).</li></ul><div class="tip custom-block"><p class="custom-block-title">La liste est non exhaustive</p><p>Bien évidemment, il existe beaucoup d&#39;autres commandes. Mais celles-ci sont les plus utilisées. Vous pouvez les retrouver sur le site <a href="https://linuxcommand.org/" target="_blank" rel="noreferrer">Linux Command</a>.</p></div><h3 id="les-droits" tabindex="-1">Les droits <a class="header-anchor" href="#les-droits" aria-label="Permalink to &quot;Les droits&quot;">​</a></h3><p>Les droits sont très importants sur un serveur. Ils permettent de définir qui peut faire quoi sur un fichier ou un répertoire.</p><p>Les droits sont composés de trois parties :</p><ul><li>Les droits du propriétaire.</li><li>Les droits du groupe.</li><li>Les droits des autres.</li></ul><p>Chaque partie est composée de trois caractères :</p><ul><li><code>r</code> : lecture</li><li><code>w</code> : écriture</li><li><code>x</code> : exécution</li></ul><p>Par exemple, si vous avez les droits suivants sur un fichier :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rwxr-xr-x</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cela signifie que vous avez les droits suivants :</p><ul><li>Vous avez les droits de lecture, d&#39;écriture et d&#39;exécution.</li><li>Le groupe a les droits de lecture et d&#39;exécution.</li><li>Les autres ont les droits de lecture et d&#39;exécution.</li></ul><p>Pour changer les droits d&#39;un fichier, vous pouvez utiliser la commande <code>chmod</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">droit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">s</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fichie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Par exemple, pour donner les droits de lecture et d&#39;exécution au groupe et aux autres, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> g+rx,o+rx</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fichie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour changer le propriétaire d&#39;un fichier, vous pouvez utiliser la commande <code>chown</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">propriétair</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">fichie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Par exemple si nous voulons autoriser l&#39;utilisateur apache a lire et écrire dans le fichier <code>index.html</code>, nous pouvons utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache:apache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> index.html</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Le fichier <code>index.html</code> est maintenant accessible en lecture et en écriture par l&#39;utilisateur apache.</p><h3 id="quelques-commandes-utiles" tabindex="-1">Quelques commandes utiles <a class="header-anchor" href="#quelques-commandes-utiles" aria-label="Permalink to &quot;Quelques commandes utiles&quot;">​</a></h3><ul><li><code>sudo</code> : permet d&#39;exécuter une commande en tant qu&#39;administrateur.</li><li><code>su</code> : permet de se connecter en tant qu&#39;un autre utilisateur.</li><li><code>top</code> : affiche les processus en cours d&#39;exécution.</li><li><code>ps</code> : affiche les processus en cours d&#39;exécution.</li><li><code>!!</code> : ré-exécute la dernière commande. Pratique par exemple pour y ajouter des arguments, ou pour l&#39;exécuter en tant qu&#39;administrateur (ex. <code>sudo !!</code>).</li></ul><h2 id="la-structure-des-dossiers" tabindex="-1">La structure des dossiers <a class="header-anchor" href="#la-structure-des-dossiers" aria-label="Permalink to &quot;La structure des dossiers&quot;">​</a></h2><p>L&#39;architecture des dossiers d&#39;un linux est très simple. Elle est composée de différentes parties :</p><ul><li><code>/</code> : le dossier racine.</li><li><code>/home</code> : les dossiers des utilisateurs.</li><li><code>/var</code> : les dossiers des services.</li><li><code>/etc</code> : les fichiers de configuration.</li></ul><p>Dans le dossier <code>/home</code>, vous trouverez les dossiers des utilisateurs. Chaque utilisateur possède son propre dossier.</p><p>Dans le dossier <code>/var</code>, vous trouverez les dossiers des services. Par exemple, le dossier <code>/var/www</code> contient les fichiers du serveur Web Apache.</p><p>Dans le dossier <code>/etc</code>, vous trouverez les fichiers de configuration. Par exemple, le fichier <code>/etc/apache2/apache2.conf</code> contient la configuration du serveur Web Apache.</p><div class="tip custom-block"><p class="custom-block-title">Nous avons plus de dossiers</p><p>Nous avons ici une liste très courte des dossiers qui vous seront utiles. Vous pouvez retrouver la liste complète sur le site <a href="https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard" target="_blank" rel="noreferrer">Linux Filesystem Hierarchy Standard</a>.</p><p>Nous observerons plus en détail les différents dossiers dans les prochains TP.</p></div><h2 id="installer-des-logiciels" tabindex="-1">Installer des logiciels <a class="header-anchor" href="#installer-des-logiciels" aria-label="Permalink to &quot;Installer des logiciels&quot;">​</a></h2><p>Votre serveur ne possède pas d&#39;interface, mais nous pouvons complètement y ajouter des logiciels. Sous Debian, nous avons le gestionnaire de paquets <code>apt</code> qui permet d&#39;installer des logiciels.</p><p>Le gestionnaire de paquet est la vraie force de Linux. Il permet d&#39;installer des logiciels, de les mettre à jour, de les supprimer, de les configurer … Il est très puissant et très simple à utiliser. Le tout de manière centralisée et sécurisée (en effet les repositories sont signés et administrés par des personnes compétentes).</p><h3 id="installer-un-logiciel" tabindex="-1">Installer un logiciel <a class="header-anchor" href="#installer-un-logiciel" aria-label="Permalink to &quot;Installer un logiciel&quot;">​</a></h3><p>Pour installer un logiciel, il suffit d&#39;utiliser la commande <code>apt install</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">logicie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Par exemple, pour installer le serveur Web Apache, nous pouvons utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="mettre-a-jour-un-logiciel" tabindex="-1">Mettre à jour un logiciel <a class="header-anchor" href="#mettre-a-jour-un-logiciel" aria-label="Permalink to &quot;Mettre à jour un logiciel&quot;">​</a></h3><p>Pour mettre à jour un logiciel, il suffit d&#39;utiliser la commande <code>apt update</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va mettre à jour la liste des logiciels disponibles. Pour mettre à jour un logiciel, il suffit d&#39;utiliser la commande <code>apt upgrade</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> upgrade</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va mettre à jour les logiciels installés.</p><h3 id="supprimer-un-logiciel" tabindex="-1">Supprimer un logiciel <a class="header-anchor" href="#supprimer-un-logiciel" aria-label="Permalink to &quot;Supprimer un logiciel&quot;">​</a></h3><p>Pour supprimer un logiciel, il suffit d&#39;utiliser la commande <code>apt remove</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">logicie</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">l</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Par exemple, pour supprimer le serveur Web Apache, nous pouvons utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="les-services" tabindex="-1">Les services <a class="header-anchor" href="#les-services" aria-label="Permalink to &quot;Les services&quot;">​</a></h2><p>Votre serveur exécute des logiciels. Ces logiciels quand ils sont exécutés en arrière-plan sont appelés des services. Nos ordinateurs modernes (serveur ou non) ont une puissance de calcul énorme. Il est donc possible d&#39;exécuter plusieurs services en même temps sur un seul ordinateur.</p><p>Votre ordinateur est capable sans problème d&#39;exécuter des 100aines de services en même temps. Par exemple :</p><ul><li>Un serveur Web</li><li>Un serveur de base de données</li><li>Un serveur de messagerie</li><li>Un serveur de fichiers</li><li>…</li></ul><p>Mais il est important de réfléchir à la question suivante : quels services voulez-vous exécuter sur votre serveur ? Et surtout, ne serait-il pas intéressant de les exécuter sur des serveurs différents ? Pour plusieurs raisons :</p><ul><li>Vous pouvez répartir la charge sur plusieurs serveurs.</li><li>Vous pouvez avoir plusieurs serveurs pour des raisons de sécurité.</li><li>Vous pouvez avoir plusieurs serveurs pour des raisons de maintenance.</li><li>…</li></ul><h3 id="gerer-les-services" tabindex="-1">Gérer les services <a class="header-anchor" href="#gerer-les-services" aria-label="Permalink to &quot;Gérer les services&quot;">​</a></h3><p>Beaucoup de distribution Linux moderne utilise SystemD pour gérer les services. Il permet de démarrer, d&#39;arrêter, de redémarrer, de recharger, de vérifier l&#39;état des services.</p><p>Pour vérifier l&#39;état des services, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_servic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour démarrer un service, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_servic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour arrêter un service, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_servic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour redémarrer un service, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_servic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour indiquer au système que vous souhaitez démarrer le service au démarrage du système, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_servic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Et pour le désactiver :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disable</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_servic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Les services</p><p>Les services sont le cœur du fonctionnement de votre serveur. Votre machine seule ne sert à rien. Il faut lui ajouter des services pour qu&#39;elle soit utile. Par exemple, un serveur Web, un serveur de base de données, un serveur de messagerie, un serveur de fichiers, etc.</p><p>Les quelques commandes ci-dessus vous permettent de gérer les services de votre serveur.</p></div><h2 id="les-utilisateurs" tabindex="-1">Les utilisateurs <a class="header-anchor" href="#les-utilisateurs" aria-label="Permalink to &quot;Les utilisateurs&quot;">​</a></h2><p>Voilà la pierre angulaire de la sécurité de votre serveur. La gestion des utilisateurs est centrale dans l&#39;administration de votre machine. De base sous Linux nous avons :</p><ul><li>Le compte root, il est le compte administrateur de votre machine. Il a tous les droits sur votre machine.</li><li>Le compte utilisateur, il est le compte utilisateur de votre machine. Il n&#39;a pas tous les droits sur votre machine.</li></ul><p>À votre avis :</p><ul><li>Est-ce pertinent d&#39;utiliser le compte <code>root</code> ? Pourquoi ?</li><li>Quel type de mot de passe doit avoir votre compte <code>root</code> ?</li></ul><p>Lors d&#39;une connexion à distance, il est important de se connecter avec un compte utilisateur et non avec le compte <code>root</code>. Pourquoi ? Parce que le compte <code>root</code> a tous les droits sur votre machine. Si un pirate parvient à se connecter à votre machine avec le compte <code>root</code>, il aura tous les droits sur votre machine. Il pourra donc faire ce qu&#39;il veut.</p><div class="danger custom-block"><p class="custom-block-title">Le compte root</p><p>Vous devez donc empêcher l&#39;accès au compte <code>root</code> à distance. Pour cela, il faut modifier le fichier de configuration SSH. Pour cela, vous devez modifier le fichier <code>/etc/ssh/sshd_config</code> et modifier la ligne suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PermitRootLogin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour éviter tout problème (erreur, sécurité, etc), il est également intéressant d&#39;utiliser le moins possible le compte <code>root</code>.</p></div><h2 id="l-acces-a-distance" tabindex="-1">L&#39;accès à distance <a class="header-anchor" href="#l-acces-a-distance" aria-label="Permalink to &quot;L&#39;accès à distance&quot;">​</a></h2><p>Vous vous doutez que nous n&#39;accédons pas à un serveur comme nous accédons à une machine physique (via un clavier et un souris), nous allons utiliser un accès à distance. Il existe plusieurs méthodes pour accéder à distance à votre serveur :</p><ul><li>SSH</li><li>FTP</li><li>SFTP</li></ul><p>Pour prendre la main sur votre serveur, nous allons utiliser le protocole SSH. Le <strong>service</strong> SSH permet de se connecter à distance à votre serveur. Il est très utilisé et très sécurisé.</p><p>Il est installé par défaut sur la plupart des distributions Linux. Pour vérifier que le service est bien installé, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Pour le démarrer automatiquement au démarrage du système, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ssh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="les-cles-ssh" tabindex="-1">Les clés SSH <a class="header-anchor" href="#les-cles-ssh" aria-label="Permalink to &quot;Les clés SSH&quot;">​</a></h3><p>Nous avons parlé des utilisateurs, nous avons parlé également des mots de passe. Lors de l&#39;accès à distance à votre serveur, il est intéressant d&#39;utiliser des clés SSH.</p><p>Pourquoi ? Parce que les mots de passe sont plus faciles à deviner que les clés SSH.</p><p>Une clé SSH est composée de deux parties :</p><ul><li>Une clé privée : elle est stockée sur votre ordinateur. Elle est utilisée pour se connecter à votre serveur.</li><li>Une clé publique : elle est stockée sur votre serveur. Elle est utilisée pour vérifier que vous êtes bien le propriétaire de la clé privée.</li></ul><p><img src="`+p+'" alt="Clé SSH" loading="lazy"></p><p>Pour générer une clé SSH, vous pouvez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh-keygen</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rsa</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va générer deux fichiers :</p><ul><li><code>~/.ssh/id_rsa</code> : la clé privée</li><li><code>~/.ssh/id_rsa.pub</code> : la clé publique</li></ul><div class="danger custom-block"><p class="custom-block-title">La clé privée</p><p>Cette clé privée doit être protégée. Si quelqu&#39;un a accès à cette clé privée, il pourra se connecter à votre serveur. Il est donc important de la protéger.</p></div><h3 id="autoriser-une-cle-ssh" tabindex="-1">Autoriser une clé SSH <a class="header-anchor" href="#autoriser-une-cle-ssh" aria-label="Permalink to &quot;Autoriser une clé SSH&quot;">​</a></h3><p>Maintenant que vous avez généré une clé SSH, il faut l&#39;ajouter sur votre serveur. Pour cela, vous devez copier le contenu du fichier <code>~/.ssh/id_rsa.pub</code> et le coller dans le fichier <code>~/.ssh/authorized_keys</code> sur votre serveur.</p><p>Une commande existe pour faire cela automatiquement :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh-copy-id</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/.ssh/id_rsa.pub</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_compt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">adresse_ip_du_serveu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>À partir de maintenant vous pouvez vous connecter à votre serveur avec la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_compt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">adresse_ip_du_serveu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Et aucun mot de passe ne sera demandé.</p><p>Pratique, non ?</p><h3 id="se-connecter-a-un-serveur" tabindex="-1">Se connecter à un serveur <a class="header-anchor" href="#se-connecter-a-un-serveur" aria-label="Permalink to &quot;Se connecter à un serveur&quot;">​</a></h3><p>Pour se connecter à un serveur, vous devez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">nom_du_compt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">adresse_ip_du_serveu</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Par exemple, si vous voulez vous connecter à votre serveur avec le compte <code>vbrosseau</code>, vous devez utiliser la commande suivante :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ssh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vbrosseau@192.168.1.10</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Si votre échange de clé SSH à fonctionné, vous n&#39;aurez pas besoin de rentrer de mot de passe 👍.</p><h3 id="fonctionnement-d-une-cle-ssh" tabindex="-1">Fonctionnement d&#39;une clé SSH <a class="header-anchor" href="#fonctionnement-d-une-cle-ssh" aria-label="Permalink to &quot;Fonctionnement d&#39;une clé SSH&quot;">​</a></h3><p>Lorsque vous vous connectez à votre serveur avec la commande <code>ssh</code>, le serveur va vérifier que la clé publique que vous avez envoyée correspond à la clé privée que vous avez sur votre ordinateur. Si c&#39;est le cas, vous êtes connecté.</p><p>Techniquement il y a plusieurs étapes :</p><ul><li>Le serveur génère une donnée aléatoire et le chiffre avec la clé privée et calcule le hash md5 de la valeur chiffré.</li><li>Le serveur envoie la donnée au client.</li><li>Le client déchiffre le chiffre avec la clé publique.</li><li>Le client renvoie le hash md5 de la valeur déchiffré au serveur.</li><li>Si les deux md5 sont identiques, le serveur accepte la connexion.</li></ul><p><img src="'+d+`" alt="Fonctionnement d&#39;une clé SSH" loading="lazy"></p><p>Nous parlons donc ici d&#39;un chiffrement asymétrique. Il existe également un chiffrement symétrique.</p><h2 id="les-sauvegardes" tabindex="-1">Les sauvegardes <a class="header-anchor" href="#les-sauvegardes" aria-label="Permalink to &quot;Les sauvegardes&quot;">​</a></h2><p>Qui dit serveur, dit … sauvegarde ! Il est important de sauvegarder son serveur pour éviter de perdre des données. Les sauvegardes ont plusieurs objectifs :</p><ul><li>Sauvegarder les données (évidemment).</li><li>Sauvegarder les fichiers de configuration.</li><li>Sauvegarder les bases de données.</li></ul><p>Mais surtout elles doivent être <strong>automatiques</strong> pour ne pas les oublier (via un script mis dans un cron). Les sauvegardes doivent être <strong>régulières</strong> (tous les jours, toutes les semaines, tous les mois …).</p><p>Les sauvegardes doivent être <strong>sécurisées</strong> (chiffrées, stockées sur un autre support …).</p><h3 id="sauvegarder-les-donnees" tabindex="-1">Sauvegarder les données <a class="header-anchor" href="#sauvegarder-les-donnees" aria-label="Permalink to &quot;Sauvegarder les données&quot;">​</a></h3><p>Pour sauvegarder les données, il existe plusieurs solutions :</p><ul><li>Sauvegarder les données sur un autre serveur.</li><li>Sauvegarder les données sur un disque externe.</li><li>Sauvegarder les données sur un service de stockage en ligne.</li></ul><p>Dans tous les cas, il s&#39;agit de sauvegarder les données sur une autre machine que le serveur. Pourquoi ? Parce que si le serveur tombe en panne, vous n&#39;aurez plus accès aux données.</p><p>Les sauvegardes sont également un élément sensible de la machine. En effet, elles vont contenir l&#39;ensemble des données de celui-ci (les mots de passe y compris). Elles sont donc très sensibles, et ~peuvent~ doivent être chiffrées pour éviter que des personnes malveillantes ne puissent les récupérer.</p><h3 id="les-types-de-sauvegardes" tabindex="-1">Les types de sauvegardes <a class="header-anchor" href="#les-types-de-sauvegardes" aria-label="Permalink to &quot;Les types de sauvegardes&quot;">​</a></h3><p>Il existe plusieurs types de sauvegardes :</p><ul><li>Sauvegarde complète : sauvegarde de l&#39;ensemble des données.</li><li>Sauvegarde incrémentale : sauvegarde des données modifiées depuis la dernière sauvegarde.</li><li>Sauvegarde différentielle : sauvegarde des données modifiées depuis la dernière sauvegarde complète.</li></ul><p>Les sauvegardes incrémentales et différentielles sont plus rapides que les sauvegardes complètes. Mais elles sont plus complexes à mettre en place. En fonction du temps à passer et du volume des données à sauvegarder, vous pouvez choisir l&#39;une ou l&#39;autre.</p><h3 id="exemple-de-script-de-sauvegarde" tabindex="-1">Exemple de script de sauvegarde <a class="header-anchor" href="#exemple-de-script-de-sauvegarde" aria-label="Permalink to &quot;Exemple de script de sauvegarde&quot;">​</a></h3><p>Voici un exemple de script de sauvegarde complet :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sauvegarde des données</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -avz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delete</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /media/backup/home/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sauvegarde de la base de données</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysqldump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all-databases</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /media/backup/databases.sql</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Ce script va sauvegarder les données du dossier <code>/home</code> et la base de données dans le dossier <code>/media/backup</code>.</p><p>Voici un exemple de script de sauvegarde incrémentale :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sauvegarde des données</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -avz</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --delete</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --link-dest=/media/backup/home/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /media/backup/home/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Sauvegarde de la base de données</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysqldump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --all-databases</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /media/backup/databases.sql</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>Ce script va sauvegarder les données du dossier <code>/home</code> et la base de données dans le dossier <code>/media/backup</code>.</p><div class="tip custom-block"><p class="custom-block-title">Comment l&#39;automatiser ?</p><p>Vous pouvez automatiser la sauvegarde en créant un script et en le mettant dans un cron. Voici un exemple de cron :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /home/backup.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Ce cron va exécuter le script <code>/home/backup.sh</code> tous les jours à minuit.</p></div><h2 id="les-logs" tabindex="-1">Les logs <a class="header-anchor" href="#les-logs" aria-label="Permalink to &quot;Les logs&quot;">​</a></h2><p>Maintenant que nous avons vu comment fonctionnent les rudiments d&#39;un serveur, nous allons nous intéresser aux logs. Les logs sont des fichiers qui contiennent les informations sur les actions effectuées sur le serveur. Ils sont très utiles pour débugger un serveur.</p><p>Différents types de logs existent sur votre serveur :</p><ul><li>Les logs du serveur (Apache, Nginx …).</li><li>Les logs des applications (WordPress, …).</li><li>Les logs des bases de données (MySQL, …).</li></ul><p>Et plusieurs niveaux de logs existent :</p><ul><li>Les logs d&#39;erreurs (erreurs, alertes …).</li><li>Les logs de débogage (informations …).</li></ul><p>En général, les logs d&#39;erreurs sont plus importants que les logs de débogage. En effet, les logs d&#39;erreurs vont vous permettre de débugger votre serveur. Les logs de débogage vont vous permettre de voir ce qui se passe sur votre serveur.</p><div class="tip custom-block"><p class="custom-block-title">Point cybersécurité</p><p>Les logs sont des fichiers qui contiennent des informations sensibles. Les logs d’Apache ou Nginx contiennent entre autres les accès au votre serveur. Ils sont donc utiles pour observer si vous subissez des attaques. Ils sont également très sensibles, et très attractifs pour des attaquants.</p><p>Si votre organisation le permet, les logs peuvent être externalisés pour être centralisés dans un serveur centralisé. Ce qui va permettre de les sécuriser, ainsi que les analyser plus facilement (avec des outils comme Kibana, Graylog…).</p></div><h3 id="les-logs-du-serveur" tabindex="-1">Les logs du serveur <a class="header-anchor" href="#les-logs-du-serveur" aria-label="Permalink to &quot;Les logs du serveur&quot;">​</a></h3><p>Les logs du serveur sont généralement stockés dans le dossier <code>/var/log</code>. Il est possible de les consulter avec la commande <code>tail</code> :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/log/apache2/access.log</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Cette commande va afficher les logs du serveur Apache en temps réel. Le <code>-f</code> permet de suivre les logs en temps réel (sans avoir à relancer la commande).</p><h3 id="comment-les-analyser" tabindex="-1">Comment les analyser ? <a class="header-anchor" href="#comment-les-analyser" aria-label="Permalink to &quot;Comment les analyser ?&quot;">​</a></h3><p>Une partie du travail du DevOps est d&#39;analyser les logs. Il est important de savoir lire les logs, et de savoir les interpréter. Il est également important de savoir les analyser. Il existe plusieurs outils pour analyser les logs :</p><ul><li>tail : affiche les logs en temps réel.</li><li>nano : éditeur de texte.</li><li>vim : éditeur de texte.</li><li>Kibana : outil de visualisation des logs.</li><li>Graylog : outil de centralisation des logs.</li></ul><p>Vous pouvez avoir différentes erreurs dans vos logs :</p><ul><li>Des erreurs de configuration serveur. (ex. : mauvaise configuration d’Apache, erreur de type 500).</li><li>Des erreurs d&#39;application. (ex. : erreur dans le code de votre site en PHP, erreur de type 500).</li><li>Des erreurs de type ressource introuvables. (ex : un fichier n&#39;existe pas, erreur de type 404).</li></ul><h3 id="exemple-de-logs" tabindex="-1">Exemple de logs <a class="header-anchor" href="#exemple-de-logs" aria-label="Permalink to &quot;Exemple de logs&quot;">​</a></h3><p>Log de type 404 :</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">127.0.0.1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [28/Jul/2022:10:27:32 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-0300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;GET /hidden/ HTTP/1.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 404 7218</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Comment lire ce log ? :</p><ul><li><code>127.0.0.1</code> : adresse IP de l&#39;utilisateur ayant fait la requête.</li><li><code>28/Jul/2022:10:27:32 -0300</code> : date et heure de la requête.</li><li><code>GET /hidden/ HTTP/1.0</code> : méthode HTTP, URL, version HTTP.</li><li><code>404</code> : code HTTP. (404 = ressource introuvable)</li></ul><div class="tip custom-block"><p class="custom-block-title">Point lecture de log</p><p>La lecture de logs est un exercice important. Il faut s&#39;entraîner, ça vous permettra de mieux comprendre ce qui se passe sur votre serveur, et de mieux corriger vos erreurs.</p></div><h3 id="superviser-les-logs" tabindex="-1">Superviser les logs <a class="header-anchor" href="#superviser-les-logs" aria-label="Permalink to &quot;Superviser les logs&quot;">​</a></h3><p>Nous avons vu comment analyser les logs. Mais il est également important de superviser les logs. La supervision des logs va permettre de détecter les erreurs, et de les corriger. Il existe plusieurs outils pour superviser les logs :</p><ul><li>LogStash : outil de centralisation des logs.</li><li>Graylog : outil de centralisation des logs.</li><li>Nagios : outil de supervision des logs.</li></ul><p>Ces outils vont permettre de centraliser les logs. En effet, même si vous savez analyser les logs, les centraliser permettra de les « valoriser ». L&#39;autre aspect important de la supervision est la notification, celle-ci vous permettra d&#39;être proactif sur les problèmes. Les notifications pourront prendre différentes formes :</p><ul><li>Notification par mail.</li><li>Notification par slack.</li></ul><p><img src="`+c+'" alt="GrayLog" loading="lazy"></p><h2 id="physique-ou-virtuel" tabindex="-1">Physique ou virtuel ? <a class="header-anchor" href="#physique-ou-virtuel" aria-label="Permalink to &quot;Physique ou virtuel ?&quot;">​</a></h2><p>Il est possible d&#39;installer un serveur sur un ordinateur physique, mais il est également possible d&#39;installer un serveur sur une machine virtuelle. Une machine virtuelle est un logiciel qui permet de simuler un ordinateur. Il est possible de créer plusieurs machines virtuelles sur un seul ordinateur. Chaque machine virtuelle est indépendante de l&#39;autre, c&#39;est-à-dire que chaque machine virtuelle est comme un ordinateur physique.</p><p>Le TP que nous allons faire est sur une machine virtuelle. Mais vous pouvez également installer un serveur sur un ordinateur physique.</p><h2 id="la-securite" tabindex="-1">La sécurité <a class="header-anchor" href="#la-securite" aria-label="Permalink to &quot;La sécurité&quot;">​</a></h2><p>Héberger du contenu nécessite de réfléchir à la sécurité. En effet, il est important de sécuriser son serveur pour éviter que des personnes malveillantes ne puissent accéder à votre serveur et à vos données.</p><p>Différents éléments seront à prendre en compte pour sécuriser votre serveur :</p><ul><li>L&#39;accès aux ports de votre serveur.</li><li>Les services présents sur votre serveur.</li><li>Les utilisateurs présents sur votre serveur.</li><li>Les mots de passe d&#39;accès.</li></ul><div class="danger custom-block"><p class="custom-block-title">Développeur != À l&#39;arrache</p><p>À première vue, vous vous dites que vous n&#39;avez pas besoin de sécuriser votre serveur, car vous êtes le seul à y avoir accès. Mais ce n&#39;est pas une bonne idée. Vous ne savez pas qui peut avoir accès à votre serveur. Il est possible que quelqu&#39;un d&#39;autre ait accès à votre serveur, et que cette personne soit malveillante. Il est donc important de sécuriser votre serveur.</p><p>Vous vous dites également que les serveurs ne sont pas votre histoire. Que c&#39;est l&#39;affaire des personnes dans l&#39;option SISR. Malheureusement pour vous dans la réalité des organisations vous serez amené à gérer des serveurs (au moins de développement).</p></div><h2 id="un-serveur-ou-plusieurs-serveurs" tabindex="-1">Un serveur ou plusieurs serveurs ? <a class="header-anchor" href="#un-serveur-ou-plusieurs-serveurs" aria-label="Permalink to &quot;Un serveur ou plusieurs serveurs ?&quot;">​</a></h2><p>Avant d&#39;aller plus loin… Réfléchissez à la question suivante : est-ce que vous allez installer un seul serveur ou plusieurs serveurs ?</p><p>L&#39;idée est donc de comprendre pourquoi il est intéressant d&#39;avoir plusieurs serveurs. En effet, il est possible d&#39;avoir un seul serveur qui contient tout. Mais il est également possible d&#39;avoir plusieurs serveurs qui contiennent chacun une partie du serveur. Par exemple, vous pouvez avoir un serveur qui contient le serveur Web, un serveur qui contient le serveur de base de données, etc.</p><h3 id="pourquoi-avoir-plusieurs-serveurs" tabindex="-1">Pourquoi avoir plusieurs serveurs ? <a class="header-anchor" href="#pourquoi-avoir-plusieurs-serveurs" aria-label="Permalink to &quot;Pourquoi avoir plusieurs serveurs ?&quot;">​</a></h3><p>Il y a plusieurs raisons pour avoir plusieurs serveurs pour :</p><ul><li>Répartir la charge.</li><li>Meilleure disponibilité.</li><li>Meilleure sécurité.</li><li>Meilleure maintenance.</li><li>Plusieurs environnements.</li></ul><h2 id="les-environnements" tabindex="-1">Les environnements <a class="header-anchor" href="#les-environnements" aria-label="Permalink to &quot;Les environnements&quot;">​</a></h2><p>En informatique (comme dans la vraie vie), on a besoin de plusieurs environnements. En effet, actuellement, vous n&#39;avez qu&#39;un seul environnement : votre ordinateur. Mais vous avez besoin de plusieurs environnements :</p><ul><li>Développement. (ex. : votre ordinateur).</li><li>Test / Recette / Staging (ex. : un serveur qui servira à valider vos développements, ou héberger votre base de données).</li><li>Production. (ex. : le serveur qui hébergera votre site).</li></ul><p>Le découpage en environnement est une pratique très répandue. Elle permet de tester son code sans risquer de casser le site de production.</p><h2 id="la-replication" tabindex="-1">La réplication <a class="header-anchor" href="#la-replication" aria-label="Permalink to &quot;La réplication&quot;">​</a></h2><p>La <strong>réplication informatique des données</strong> est un procédé qui consiste à copier les données d’un serveur maître et à les stocker sur d’autres supports, la plupart du temps un ou <strong>différents serveurs</strong>. On les appelle serveurs cibles, aussi appelés <strong>serveurs esclaves</strong> ou de destination, et l’on parle de réplication de serveur à serveur en réseau.</p><p>Nous allosn pouvoir réaliser de la réplication de données de plusieurs manières :</p><ul><li>Réplication de base de données (très courant).</li><li>Réplication de fichiers / Serveur.</li></ul><p>La réplication de base de données est très réppandue dans l&#39;organisation. Elle permet de s&#39;assurer de la disponibilité des données. En effet, si le serveur de base de données tombe en panne, il est possible de récupérer les données sur un autre serveur. Il ne faut pas confondre la réplication de base de données avec la sauvegarde de base de données. Ici nous nous <strong>concentrons sur la haute disponibilité des données</strong>. En s&#39;assurant que les données soit très rapidement disponible en cas de problème.</p><p>Comme pour la base de données, il est possible d&#39;avoir une copie parfaite des fichiers de son serveur (fichier, et configuration) afin d&#39;être en capacité d&#39;avoir instantanément un serveur de remplacement en cas de problème.</p><h3 id="plusieurs-type-de-replications-existent" tabindex="-1">Plusieurs type de réplications existent <a class="header-anchor" href="#plusieurs-type-de-replications-existent" aria-label="Permalink to &quot;Plusieurs type de réplications existent&quot;">​</a></h3><p>Pour les réplications de base de données :</p><ul><li>Active : le serveur esclave peut être utilisé en cas de problème sur le serveur maître. Les deux serveurs peuvent être utilisés en même temps.</li><li>Passive : le serveur esclave ne peut pas être utilisé en cas de problème sur le serveur maître. Dans le cas normal, le serveur esclave ne fait que recevoir les données du serveur maître.</li></ul><p>Pour les réplications de fichiers :</p><ul><li>Synchrone : les données sont répliquées en temps réel (le serveur esclave est toujours à jour).</li><li>Asynchrone : les données sont répliquées de manière périodique (la fréquence des mise à jours est définie en fonction de la criticité).</li><li>Semi-synchrone : les données sont répliquées de manière périodique et en temps réel.</li></ul><h2 id="les-hebergeurs" tabindex="-1">Les hébergeurs <a class="header-anchor" href="#les-hebergeurs" aria-label="Permalink to &quot;Les hébergeurs&quot;">​</a></h2><p>Maintenant que nous avons vu les différents éléments à prendre en compte pour installer un serveur, nous allons voir où nous pouvons installer un serveur. En effet, il est possible d&#39;installer un serveur sur un ordinateur physique, mais il est également possible d&#39;installer un serveur sur un hébergeur.</p><h3 id="qu-est-ce-qu-un-hebergeur" tabindex="-1">Qu&#39;est-ce qu&#39;un hébergeur ? <a class="header-anchor" href="#qu-est-ce-qu-un-hebergeur" aria-label="Permalink to &quot;Qu&#39;est-ce qu&#39;un hébergeur ?&quot;">​</a></h3><p>Un hébergeur est une entreprise qui propose des serveurs. Vous pouvez louer un serveur chez un hébergeur. Vous pouvez louer un serveur chez un hébergeur pour héberger votre site Web, votre application, etc.</p><h3 id="les-differents-types-d-hebergeurs" tabindex="-1">Les différents types d&#39;hébergeurs <a class="header-anchor" href="#les-differents-types-d-hebergeurs" aria-label="Permalink to &quot;Les différents types d&#39;hébergeurs&quot;">​</a></h3><p>Il existe plusieurs types d&#39;hébergeurs :</p><ul><li>Les hébergements mutualisés.</li><li>Les hébergements dédiés.</li><li>Les hébergements de type SaaS.</li></ul><h4 id="les-hebergements-mutualises" tabindex="-1">Les hébergements mutualisés <a class="header-anchor" href="#les-hebergements-mutualises" aria-label="Permalink to &quot;Les hébergements mutualisés&quot;">​</a></h4><p>Les hébergeurs mutualisés sont des hébergeurs qui proposent des serveurs mutualisés. Un serveur mutualisé est un serveur qui contient plusieurs sites Web. Les sites Web sont séparés les uns des autres. Un serveur va donc contenir plusieurs sites Web, mais ces sites Web ne peuvent pas communiquer entre eux. Ils sont indépendants.</p><h4 id="les-hebergements-dedies" tabindex="-1">Les hébergements dédiés <a class="header-anchor" href="#les-hebergements-dedies" aria-label="Permalink to &quot;Les hébergements dédiés&quot;">​</a></h4><p>Dans le cas d&#39;un hébergement dédié, vous louez un serveur qui est entièrement dédié à votre site Web. Vous pouvez donc installer les services que vous voulez sur votre serveur. Vous pouvez donc installer un serveur Web, un serveur de base de données, etc.</p><p>Le serveur peut-être physique ou virtuel. Mais dans tous les cas vous avez un accès complet à l&#39;OS.</p><h4 id="les-hebergements-de-type-saas" tabindex="-1">Les hébergements de type SaaS <a class="header-anchor" href="#les-hebergements-de-type-saas" aria-label="Permalink to &quot;Les hébergements de type SaaS&quot;">​</a></h4><p>Dans le cas d&#39;un hébergement de type SaaS, vous louez un service, par exemple :</p><ul><li>Un service de messagerie.</li><li>Un service de stockage.</li><li>Un service de gestion de projet.</li><li>Un service de gestion de relation client.</li><li>Un service d&#39;hébergement de base de données.</li><li>Un WordPress</li></ul><h3 id="les-hebergeurs-1" tabindex="-1">Les hébergeurs <a class="header-anchor" href="#les-hebergeurs-1" aria-label="Permalink to &quot;Les hébergeurs&quot;">​</a></h3><p>Il existe énormément d&#39;hébergeurs, nous pouvons les classer en deux catégories :</p><h4 id="les-hebergeurs-de-type-mutualise-dedie" tabindex="-1">Les hébergeurs de type mutualisé &amp; dédié <a class="header-anchor" href="#les-hebergeurs-de-type-mutualise-dedie" aria-label="Permalink to &quot;Les hébergeurs de type mutualisé &amp; dédié&quot;">​</a></h4><ul><li><a href="https://www.ovh.com/fr/" target="_blank" rel="noreferrer">OVH</a></li><li><a href="https://www.scaleway.com/fr/" target="_blank" rel="noreferrer">Scaleway</a></li><li><a href="https://www.digitalocean.com/" target="_blank" rel="noreferrer">DigitalOcean</a></li><li><a href="https://www.linode.com/" target="_blank" rel="noreferrer">Linode</a></li><li><a href="https://aws.amazon.com/fr/" target="_blank" rel="noreferrer">Amazon Web Services</a></li><li><a href="https://cloud.google.com/" target="_blank" rel="noreferrer">Google Cloud Platform</a></li><li><a href="https://azure.microsoft.com/fr-fr/" target="_blank" rel="noreferrer">Microsoft Azure</a></li></ul><div class="tip custom-block"><p class="custom-block-title">Les hébergeurs précédemment cités</p><p>Ici nous retrouvons les grands noms de l&#39;hébergement. Ces hébergeurs proposent des hébergements mutualisés, dédiés, VPS, etc. Ils proposent également des services de type SaaS (exemple Shadow)</p></div><h4 id="les-hebergeurs-de-type-saas" tabindex="-1">Les hébergeurs de type SaaS <a class="header-anchor" href="#les-hebergeurs-de-type-saas" aria-label="Permalink to &quot;Les hébergeurs de type SaaS&quot;">​</a></h4><p>Ensuite, il est possible d&#39;identifier des hébergeurs plus spécialisés :</p><ul><li><a href="https://www.heroku.com/" target="_blank" rel="noreferrer">Heroku</a></li><li><a href="https://www.netlify.com/" target="_blank" rel="noreferrer">Netlify</a></li><li><a href="https://vercel.com/" target="_blank" rel="noreferrer">Vercel</a></li><li><a href="https://pages.github.com/" target="_blank" rel="noreferrer">GitHub Pages</a></li><li><a href="https://docs.gitlab.com/ee/user/project/pages/" target="_blank" rel="noreferrer">GitLab Pages</a></li><li><a href="https://firebase.google.com/" target="_blank" rel="noreferrer">Firebase</a></li></ul><p>L&#39;ensemble de ces services sont en partie ou en totalité gratuits. Vous pouvez les utiliser pour héberger des sites « statiques » (HTML, CSS, JS, etc.). Ce type de site ne nécessite pas de serveur Web, car il n&#39;y a pas de traitement côté serveur, ils sont nommés JAMStack.</p><p>C’est une façon intéressante pour débuter gratuitement sur le web, c&#39;est par exemple le cas de mon site. Réalisé avec <a href="https://vuepress.vuejs.org/" target="_blank" rel="noreferrer">VuePress</a>, il est hébergé sur <a href="https://www.netlify.com/" target="_blank" rel="noreferrer">Netlify</a>.</p><h3 id="comment-choisir-votre-hebergeur" tabindex="-1">Comment choisir votre hébergeur ? <a class="header-anchor" href="#comment-choisir-votre-hebergeur" aria-label="Permalink to &quot;Comment choisir votre hébergeur ?&quot;">​</a></h3><p>Il existe plusieurs critères pour choisir votre hébergeur :</p><ul><li>La localisation de votre hébergeur. (Important dans le cadre du RGPD).</li><li>La disponibilité de votre hébergeur.</li><li>La sécurité de votre hébergeur.</li><li>La performance de votre hébergeur.</li><li>Le prix de votre hébergeur.</li></ul><div class="tip custom-block"><p class="custom-block-title">En entreprise</p><p>Le choix de votre hébergeur est important, car il va déterminer la performance de votre application. Vous devez donc être vigilant lors de votre sélection, car un mauvais choix peut avoir des conséquences importantes sur l&#39;activité de l&#39;organisation.</p></div><h2 id="docker" tabindex="-1">Docker <a class="header-anchor" href="#docker" aria-label="Permalink to &quot;Docker&quot;">​</a></h2><p>L&#39;autre moyen d&#39;installer des services sur votre serveur est d&#39;utiliser Docker. Docker est un logiciel qui permet de créer des conteneurs.</p><p>Un conteneur est un environnement qui contient un service. Par exemple, vous pouvez créer un conteneur qui contient un serveur Web. Vous pouvez créer plusieurs conteneurs qui contiennent chacun un serveur Web. Vous pouvez créer plusieurs conteneurs qui contiennent chacun un serveur Web et un serveur de base de données.</p><h3 id="installation-dans-un-container-docker-ou-directement-sur-la-machine" tabindex="-1">Installation dans un container Docker ou directement sur la machine ? <a class="header-anchor" href="#installation-dans-un-container-docker-ou-directement-sur-la-machine" aria-label="Permalink to &quot;Installation dans un container Docker ou directement sur la machine ?&quot;">​</a></h3><p>Là c&#39;est à vous de voir, les deux sont possibles. Personnellement je préfère l&#39;utilisation de Docker, car cela permet de créer des environnements de fonctionnement différent en fonction du projet. Nous pouvons avoir des architectures vraiment spécifiques à chaque projet :</p><ul><li>Projet A : Apache + Mysql version 5.7</li><li>Projet B : Nginx + MariaDB version 10.5</li></ul><p>Le tout sans avoir de conflit entre les deux projets. Autre avantage, de base, Docker n&#39;expose pas les ports de vos conteneurs. Vous réduisez donc le risque d&#39;attaques.</p><p>Plus tard nous découvrirons Docker et l&#39;avantage de celui-ci (vous verrez c&#39;est incroyable 🎉). Il est de toute façon primordial de comprendre comment on installe un serveur classique pour comprendre l&#39;usage de Docker.</p><div class="tip custom-block"><p class="custom-block-title">Docker c&#39;est vaste</p><p>Plus tard dans l&#39;année nous utiliserons Docker pour créer des environnements de type « Conteneurs »… Volontairement j&#39;ai souhaité vous en parler ici. Donc soyez curieux. N&#39;hésitez pas à vous documenter si vous le souhaitez.</p><ul><li><a href="/tp/devops/support-docker-cicd.html">Cours Docker</a></li><li><a href="/cheatsheets/docker/">Aide mémoire</a></li><li><a href="/tp/docker/introduction.html">Introduction à Docker</a></li></ul></div><h3 id="kubernetes" tabindex="-1">Kubernetes ? <a class="header-anchor" href="#kubernetes" aria-label="Permalink to &quot;Kubernetes ?&quot;">​</a></h3><p>Kubernetes est une solution open source permettant de gérer des clusters de conteneurs. Il permet de déployer, de gérer et de mettre à l&#39;échelle des applications dans un cluster de conteneurs.</p><p>Kubernetes est un orchestrateur de conteneurs. Il permet de déployer, de gérer et de mettre à l&#39;échelle des applications dans un cluster de conteneurs. Si nous devons faire un parallèle, c&#39;est un peu la suite de Docker. Il permet de déployer des conteneurs sur plusieurs serveurs et gérer la scalabilité d&#39;un système.</p><div class="tip custom-block"><p class="custom-block-title">Scalabilité ?</p><p>La scalabilité d&#39;un système informatique décrit sa capacité à gérer une croissance accrue des utilisateurs, des données ou des exigences de performance sans compromettre la qualité de service. Cela peut être atteint en utilisant des technologies telles que la répartition de charges, la mise en réseau et la virtualisation.</p><p>C&#39;est un concept important dans le monde du DevOps. En effet, il est important de pouvoir déployer des applications sur plusieurs serveurs. Cela permet de répartir la charge et de pouvoir gérer une augmentation de la charge. Kubernetes permet de gérer cette scalabilité, mais il existe d&#39;autres solutions comme Docker Swarm.</p></div><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>Même si vous êtes un développeur, maîtriser les bases de l&#39;administration d&#39;un serveur est important. En effet, vos applications (web) ont des besoins (librairies, dépendances, etc.) pour bien comprendre comment déployer vos sites, il est important de comprendre comment votre serveur va fonctionner.</p><p>Le DevOps sera donc capable de réaliser son site, mais également de le déployer sur un serveur qu&#39;il aura choisi / défini. Avec par exemple des solutions comme Docker ou Kubernetes.</p>',345),v=[m];function g(k,b,f,y,q,F){return a(),i("div",null,v)}const E=s(h,[["render",g]]);export{L as __pageData,E as default};
