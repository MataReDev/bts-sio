import{_ as i}from"./chunks/sync.C-wA2TXQ.js";import{_ as a,c as e,o as n,U as s,k as l}from"./chunks/framework.aGaNZw_P.js";const t="/assets/avd.D5LBtKvm.jpg",r="/assets/change_icon.CxEdTIdw.png",p="/assets/split.TsViunQ5.png",h="/assets/create_new_resources.CyG-rxZj.png",o="/assets/resources.UQb5XYa_.png",d="/assets/resources_strings.C6Z_7IMg.png",k="/assets/exemple_res_alt.C4QWCeAI.png",c="/assets/constrainte.tCbpKTVr.png",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdsAAAD2CAAAAAC7VHK0AAAPmUlEQVR4AezRMQ0AAAACIPtH9rKHgwqkr3DrFre4xS1ucesWt7jFLW5x6xa3uMUtbnGLW7e4xS1ucYtbt7jFLW5xi1vcusUtbnGLW9y6HXv0jJhBHMQB9LTzX+92sW1bXdTFdhW0sZ3P1q8KLhHM5F3h/QCko/7H26sLbq5uH/3RNOTeIu07muuvK/AMRcwYXn5t3+yBLwWJt8j6Dscqvlq5UrpbMXrwmoG0W/i2Wjziz23YfIOoW/jXK02SwSxfe4Wc2+x5v0NyOJ1nGSG3iK4UKZJEFS5GIeEWoUmPpHEmfAJuc4/9OsmjdzzkuN/ibdAkifT+Z+a3eOtRJJPqeAXnWySmLZLKnIyC7y0ymxbJZS1kGN+elZNkhSc5trfhPo0kUz1BrrfYc0k2Zws8b/HaQNLVvIDlbW7TJenstQzL22gT/ftgzy6cGkvSAID/b+c3QoQkT9q7X4IzjLu74rrLjTHu7u6OrfsyCwmDBuKQdy8vwWpZkq26stR9M9B5X3d/TdUvX3S3LxttIx2l7v9HyetIFtoGzrjnDi0RySEV0+Y448KdWYHkOBGCc6FNTs+6IU3Fifjf4B4OZKGtd08aGUExNRg0nhg5JURMQTFR4qZaGllOMBOJGwwD1QyAKSwpwsKcZoSwmSVSO/44BEOTlfhcx2eOv6Un+2wj7cvT2JINTWuI5hZ4a9NyTJadWE1NW8EoF6g+ehrMpWAu3FdXlNDjtLqutramtra2vlJ2hr0SMx15YyPhM+lQzVHC5qjJWdNEpX1YzEXLKRMZ4S7+EMk629DNojS26vlIiyrcXLkdaVDh0egVohlpQRavFAzURE9IaWyZ6OhfhxO24he/3x8OG79+cFjCPXZq2hb09pbNhOTKb5HldI6azOM3IhIa9vtbwVy2nK1ZnMBPHwXXgllnGzjkSWMrXdBbDD/uuqvXy3DVzS0JW43jt4OrkVoVPe5kIvUoLbjQEiGMmBop7fSvQmbfllcdqAoO7S+vPiBZQj1WlFjP2fGTlBvtbe5O2oKDVxmbkUqVT11yWld1oFH37S6v3o2FEcn85IaJp3MNL9bfSSyTxvU0j2SdrX+vO61t/GjC1nnHsCWKolDNoIWOVwNlLldl9OhCSAFJGAJEAWSCY1WGGkmMxPjPKWkfXoGS9wfgkId9OU6AoTXU/S8XA4hzKMuQc6ISqmBuGgksGSlBVWT8Z0lOLVGOqMaK5AXI5fqP/5YApsg8RhieVMWJv0AzphVKjGrUla+/WghFJri7B7POdnDdn7GV4PqTG4hhSzad6AperwYV0Zb1tx82EMIJ2HH96YW1gKLdLSvPPqFYLTj26F4TQ4S0Di9Dqc5GyN/rxELDtlA3O/HkXCmg/NAhTCFvevD4SBE06ThoPkUognV3npxarCY1BSw48ujh0QIoUpVgXvwnKxFMKT728F4dg1wQXHn36bk1gHFYeOjJw0ah0qbLelfLepqJ7dq+rLMdWJyB7ZFcTJHttl7vkg9GD0Ph1nBzd3Cs9zGtiHX3dI9EzssInhnp6/IPbJGl6yFvwM/l1d+NdvsC9znA74eWmrZGYOzvdRFNI7bQ6E/evugXharb60WAvwz29IS+y8OJdczZFcOA3gh++i34y2okzFYu/SrQ7Q13FJNkJQ3l6z/bqICrfwwYx7wuQATdDPo+BgY3qTDvp+BHX/g9IB+8erC7nmRiW9abdbZ9Belt9eZ/WGw5f79h2LqaY4dUw5Z6SlqHthW4KseGazzbR3uoc7u/YwU/EHwD7Nfiffu3AntrpMFT2BraLqG3Q4tnsR2/XVraNrbfybw+1VURfJHveaAfBwlIau8aB9Kmoc4y7Zz+WBWJtgXX4qfdhS8jlXCGLUWtoRZP0eP4Jae6L/hhETscu++SjsWvsZLOWJVcuF5vzXOzTGwLvNln605re14f7evv7+8LxQ3bz01btyCu1wOLZbkydiXXqbQPL3VcCe7IsatfeJdZrsbq7UB1j305z76wXL9uB68Hy2axHZAd1s/0czbi9SmOQ9Hm+bbil0ewlrJVnfuil+bZ8Itryb5FJ28j67y62AkgptkSuGKs1S67PL7ufHnvnbXWhfkD7TD3TmTLfNvGl7VQKtRfW3Bm74J6ss/Wk4FtV2tbW9uHXn3KVuPqm4FlUK2KHnMg9GpkpfxmoPhfC+bdG96YczW0VeHqFv3mX+f/K09/Y1VfDZbOYtuTg6Qq/ao1YesqD36/zmp3AjZpa/Ttx/1Wm0NJvp2mstWiFR+LnQFCm2ar1OpnHJTgt0MbFMW+EBdv7e/EzpZ42yKjGmSwRH+dyzL7Ejf7bPtLMnhMPrTQKTnn34rPZntcItiwVTrj4VAoNBbYadhuB1zZr8eM67D+hQ28GCzFs9jasFKlX7Ng4zEZwDMD4a/KGeATtkCFn/VFv28SKjNtCWz8GPIH46dVPs0WS4f1Zokz+HBkhyxt7AiOjox3YoAf+YPvt6I/ZVviyzrbgeUZ2Jqvpey3p/Wt+3e2X4RePHz86PH91daroR2Gbbn+44NHjx89OSPhF4Nl5A9s40lbBOWNryOh5xqetAXItfZWOPp2CU7elaqDXc2bLsV+Zxv/PGF7f2SHY3HX6IWtVUOdBAG448vYyC1EYEk8U9tln7LOdnhbBrZHJaFx5505+7a1v8TqkiQV5iZshbo7fvXfDkmSISb7D3rYnH2rAAKcjsUfxq/IImWrKgQ6HUUPx1tdPJFSvxvKt+VUR2faEqVBP+FkFL0Y3pB7LlRts+V/SvSt6nCu/yl2SAFm32b0qfKWgayzHanNzDb5/nam7RJFrkzZrnI+DGyyq6oCkMO0hUvjrfMkoCiIYUWC3D2XrUwvPi5zWspG2ySeslVcJ1+vcljRcL/5sTMp8v0oO6w10TPKDFu4Pv4yR1XZj73F6lP/aruj8FMnzLt90+PM2RO+a9paMSeI8HS41cNZZxs8V5ChretuvF5yNadshfQkuIu7JmzXWCtCH0pk7eAtkXvNsNWI45doOQYrXuxEeEOlmOxb4u+VErb2CVsrMWzVy+HTRNoXeeiasFWdR6I3Ndeq8A9OlkiRXwLr6Kqv4pem962dEvR1oBbAlvG7ucq1aAvLvz7+FQEvA/VAaYmeVZA29h1n6urz61Aa2/zTgayzDT9dlMZWvqgfUwxb6Z7eKMsHY0egaauciPfcJFXRkwqlr0fWS/Tt2C/vvg50FDhvhHchjasV/uHODz2hBuhuG9k+8dEQ4f5ehWoGfbjHQdQa/Yad+3xAXt4d/LJ1ILQdCPOzi4/jSC75Jvz9B2/4YPLpXboU7/3a6xt7hFK2uEj/2cE42DM43N4R+HWZqu4aHf3258HRn4pcm0Ij7e2jgysQoR+j31U4HsSfq2lsix+Fs842+tPGNLao4t4erLkFqr+3FaEdd3eZThohlzsu0A139mHOD91YihH6/FXn6xaGYM3t1YYek1ffamu/sx4Q+p97Jam+1bi4fglzY1a9fREwsulejcovXaIELLrU1nFnAzDXcXD+HiXQc+5d56PtkCWPw83v2o+uuHGKiaQtK7h3FnCNKctvtH04kQc4VXY+7biz/NjlJVhZe6Oj/coywDla96xjp7TnVXm6vl39QzT7bIca0thyBBDXzBEzjkHq43qBYT5H0JgTDAIiOJaph6qEG7pYaAYfNHoFQiYo4USkqglqZIzJxEiFUQ1RYt4yFnugQWvWNgoaKaQKD1JpMiWI0b+ypEBziZkACfbEMW6hIK5pFBAPlBRAOAPA41ahkWOA5xOCBOZpbA8MZqFt+HFeGtypb9A0I8yL5PfePPXtWjKpCc640Kat54wlJ2Z8UydSNiK1MVnX3D2xbJaUkUueN7NSMs+N5RO3klun54RmJNPQ/pe9e0AOIIiCAHrZ2LZt2yxvIbadQmzbHvwpJefozr/CW+9Mt/+IBbSVm0Tf/0k4EUBbp3oD6GkDur4w9xVsJ9Dbxm5aSFv33eVHTuvX9o261+s0ndw29UhAbZ0eDaOmDR5WuHurn5v9mK/IVU8CnHdxnk2Mm3UgyDk1Zj2Z99V2TWPnS5nZWFLamEmNngv3s8B55sbNfTt0W1HLKYS0STNK0G3/Rm8XBZLJBhZsKY78ZLnqjaCiDe2+EJZsbPleLwuhkQ0uXfwWor4Cez+Yw3FhDsjuvzNkXRT2daE+PhgcNiiubvrFCF8/kH3bHixPCsKFTSwd2HqzpN1PYtXD9pzXWV9diTXV9R3eL3t3TAQACEUxDPyrQgMDEjDAwN+wwb1LLFRAx9znVvnx8XdbtEVbtEVbbdEWbdEWbdEWbbVFW7RFW7RFW23RFm3RFm3RVlu0RVu0RVu0RVtt0RZt0RZt0VZbtEVbtEVbtEVbbdEWbdEWbdFWW7RFW7RFW7RFW23RFm3RFm3RVlu0RVu0RVu0RVtt0RZt0RZt0VZbtEVbtEVbtNV2paLFAQAAAAAAAAAAoL926gE4li2KwvAez3vXtm3btm3btm3btm3btu04mZnus645KQXdVSf7Kxt/rZVx1egYxEKNvUSLjAbSg6nsHSg7U1PoYOa0C167TkQjHVhqPxWqUA9nMZC2IsR2F5Gkk7DfawAiEWnP3sMDAevPAXeLaxs38Q6Bf4l9yUguUZteccDPW5e20cZ6C68RkdNsceJhQxtpqL4L4l9wNSOZWEvuc0C90XkOoH3beGsdeNvKThRjtgPe3f8n7TQBto362zqgDcnDkmr+S6hvpqeyjtZht2m2K+JJLcu3AY/wguf4yJq2bUh/KydV29gjngI+K3KZyDha+93mviJwNb+BvjF3eguxKAG3DRlRm5xzCL8zFSIR6dDWXPMmXHuy0k/WqveF82AaA7cNASU2uID7XWIR6dHW2uQDlHXx6Q9FLwmcLcBtg8uUY66Hqr4YlcxI+rQd4gGfsdHpT4YUh5zqy8LcNnhi9noihHN1cQORPm2NvvAYYqN/JF3twmqt2go522a4GCAcx2uGJ9KtLbA+PLmJ9QFbebfBMlXAd0IMIl3bLjOTm//ecdtgau0L9XGjGH+3FdxWhrb/d3sM+G7PZ+LdSteWDNEmPITwWZvFwruVrS2RNfc2B8Td/hF5t9K1JbKVO+kP5UbzKLxb6doSxW37WsBvS0ED71aCtm51x7wQCFic08i7la4tWYtvUYW43S3KmLC2W4Eza/92DKINScVUab8TuH0mjLWtHQA3IqARSSZB9ycKoPknP9+5w81uh1ZtYy7x8PyXx8rYJJ0EU18BnvG1bOtE4MRGClHMXmDt/YF20o5h1tOXgXpYk2uw4GCMMcYYY4wxxhhjjDHGGGOMMcY+A/gz+nIj/7aEAAAAAElFTkSuQmCC",E="/assets/viewBinding.DrEN4RDy.png",g="/assets/create_activity.L0qbE9cq.png",m="/assets/create_activity2.BbgjPesn.png",b="/assets/splash.B2butT74.png",y="/assets/vector_asset.COMkBXS2.png",v="/assets/vector_asset2.DOzpMFbw.png",F="/assets/sample_ui_test.CetvUT6O.png",C="/assets/flow_permissions.BBoHiED8.png",f="/assets/layout_locate_me.Dreb52OU.png",A="/assets/layout_list_item.DOUrp5CT.png",q="/assets/list_item_sample.CKpKeUg1.png",B="/assets/rv_sample_settings.CFoJwHTV.png",M=JSON.parse(`{"title":"Découverte des bases d'Android","description":"La première étape est la création d'un projet. Pour ça nous allons utiliser « Android Studio » qui est l'IDE à utiliser pour créer une application Android.","frontmatter":{"description":"La première étape est la création d'un projet. Pour ça nous allons utiliser « Android Studio » qui est l'IDE à utiliser pour créer une application Android."},"headers":[],"relativePath":"tp/android/android-base-tp.md","filePath":"tp/android/android-base-tp.md","lastUpdated":1704112852000}`),D={name:"tp/android/android-base-tp.md"},L=s('<h1 id="decouverte-des-bases-d-android" tabindex="-1">Découverte des bases d&#39;Android <a class="header-anchor" href="#decouverte-des-bases-d-android" aria-label="Permalink to &quot;Découverte des bases d&#39;Android&quot;">​</a></h1><details class="details custom-block"><summary>Sommaires</summary><nav class="table-of-contents"><ul><li><a href="#creer-un-projet">Créer un projet</a></li><li><a href="#creation-de-l-emulateur">Création de l&#39;émulateur</a></li><li><a href="#les-textes">Les textes</a></li><li><a href="#decouverte-des-dossiers">Découverte des dossiers</a></li><li><a href="#le-fichier-androidmanifest">Le fichier AndroidManifest</a><ul><li><a href="#a-faire">À faire :</a></li></ul></li><li><a href="#personnalisation-de-votre-application">Personnalisation de votre application</a></li><li><a href="#les-layouts">Les layouts</a><ul><li><a href="#a-faire-1">À faire :</a></li><li><a href="#les-ressources-alternatives">Les ressources alternatives</a></li><li><a href="#a-faire-2">À faire :</a></li><li><a href="#les-dimensions-et-contraintes">Les dimensions et contraintes</a></li><li><a href="#a-faire-3">À faire :</a></li></ul></li><li><a href="#l-activity">L&#39;activity</a><ul><li><a href="#a-faire-4">À faire :</a></li><li><a href="#la-snackbar">La Snackbar</a></li></ul></li><li><a href="#rendre-un-element-clickable">Rendre un élément clickable</a><ul><li><a href="#a-faire-5">À faire</a></li></ul></li><li><a href="#rendre-un-element-clickable-2">Rendre un élément clickable 2</a><ul><li><a href="#a-faire-6">À faire</a></li><li><a href="#les-kotlin-android-extension">Les Kotlin Android Extension</a></li><li><a href="#creer-une-autre-activity">Créer une autre activity</a></li></ul></li><li><a href="#demarrer-une-activite-avec-des-parametres">Démarrer une activité avec des paramètres</a><ul><li><a href="#dans-l-activity-a-demarrer">Dans l&#39;activity à démarrer</a></li><li><a href="#dans-l-activity-qui-va-lancer-l-autre-activity">Dans l&#39;activity qui va lancer l&#39;autre activity</a></li></ul></li><li><a href="#theme-et-drawable">Thème et Drawable</a><ul><li><a href="#a-faire-7">À faire</a></li></ul></li><li><a href="#theme-de-couleurs">Thème de couleurs</a><ul><li><a href="#a-faire-8">À faire</a></li></ul></li><li><a href="#les-intent-externes-tierces">Les Intent externes / tierces</a><ul><li><a href="#ouvrir-les-parametres-bluetooth">Ouvrir les paramètres Bluetooth</a></li><li><a href="#ouvrir-un-lien-web">Ouvrir un lien web</a></li><li><a href="#ouvrir-google-maps">Ouvrir Google Maps</a></li><li><a href="#a-faire-9">À faire</a></li></ul></li><li><a href="#les-permissions">Les Permissions</a></li><li><a href="#declaration-des-permissions">Déclaration des permissions</a><ul><li><a href="#permission-acceptee">Permission acceptée ?</a></li><li><a href="#demander-la-permission">Demander la permission</a></li><li><a href="#methode-surchargee-apres-l-acceptation">Méthode surchargée après l&#39;acceptation</a></li><li><a href="#obtenir-la-localisation">Obtenir la localisation</a></li><li><a href="#bonus-obtenir-l-adresse-par-rapport-au-lat-long">BONUS ! Obtenir l&#39;adresse par rapport au lat, long</a></li><li><a href="#a-faire-10">À faire</a></li></ul></li><li><a href="#les-recyclerview">Les Recyclerview</a></li><li><a href="#les-«-plugins-»-librairies">Les « Plugins » / Librairies</a><ul><li><a href="#les-dialogs">Les Dialogs</a></li><li><a href="#avec-le-material-design-de-google">Avec le Material Design de Google</a></li><li><a href="#recyclical">Recyclical</a></li></ul></li><li><a href="#activite-«-parametres-»">Activité « Paramètres »</a><ul><li><a href="#la-classe-localpreferences-aka-sauvegarder-des-parametres">La classe LocalPreferences (AKA Sauvegarder des paramètres)</a></li></ul></li></ul></nav></details><div class="danger custom-block"><p class="custom-block-title">XML ou Compose ?</p><p>Nous sommes en 2023, le monde d&#39;Android évolue… Pendant des années l&#39;écriture des « layouts » (interface) n&#39;était possible que via du XML. Il est maintenant possible d&#39;écrire les layouts de manières bien plus modernes avec <a href="https://developer.android.com/jetpack/compose" target="_blank" rel="noreferrer">JetPack Compose</a>. Le TP que vous suivez est toujours valide, mais repose sur l&#39;utilisation de XML.</p></div><h2 id="creer-un-projet" tabindex="-1">Créer un projet <a class="header-anchor" href="#creer-un-projet" aria-label="Permalink to &quot;Créer un projet&quot;">​</a></h2><p>La première étape est la création d&#39;un projet. Pour ça nous allons utiliser « Android Studio » qui est l&#39;IDE à utiliser pour créer une application Android.</p><p>Lors de la création, Android Studio va nous poser plusieurs questions, nous allons donc choisir :</p><ul><li>Template : Empty View Activity</li><li>Language : Kotlin</li><li>SDK Min. : SDK 26.</li></ul><p>Je vous laisse suivre les étapes de création d&#39;un nouveau projet.</p><div class="warning custom-block"><p class="custom-block-title">Mais quelques petites remarques :</p><ul><li>Le choix du package est très important. Comme nous avons vu ensemble en cours, le « Package » doit être unique. En effet deux applications ne peuvent pas avoir le même.</li><li>Choisir un min SDK qui correspond aux cibles des mobiles souhaités. (Si vous êtes en France ou dans un autre pays, il conviendra de faire le bon choix).</li><li>Kotlin est maintenant le langage à choisir, Java et Kotlin cohabite sans problème vous n&#39;aurez donc aucun problème de compatibilité.</li></ul></div><h2 id="creation-de-l-emulateur" tabindex="-1">Création de l&#39;émulateur <a class="header-anchor" href="#creation-de-l-emulateur" aria-label="Permalink to &quot;Création de l&#39;émulateur&quot;">​</a></h2><p>Comme vu ensemble pendant le cours, l&#39;émulateur va nous permettre de tester « simplement » notre application avec des performances <em>suffisante dans les cas simple</em>. La création de celui-ci est intégrée à Android Studio. Dans Android Studio la partie émulateur s&#39;appelle Device Manager et est disponible dans le menu <code>tools</code></p><p><img src="'+t+'" alt="AVD" loading="lazy"></p><p>Pour le choix du type de devices vous êtes libres… Mais le mieux est de choisir un « template de mobile » assez représentatif de ce que l&#39;on trouve chez les clients. Un bon choix est par exemple un « Pixel 6a » avec Android Oreo.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Le Logo Playstore présent sur la ligne d&#39;un simulateur indique que celui-ci est équipé des Play Services. Bien que dans notre cas ça ne change pas grand-chose, je vous invite vivement à choisir un émulateur avec les Play Services, car celui-ci sera très proche d&#39;un vrai téléphone trouvable dans le commerce.</p></div><p>Maintenant que votre émulateur est créé, nous allons pouvoir lancer l&#39;application « Run -&gt; Run App ».</p><h2 id="les-textes" tabindex="-1">Les textes <a class="header-anchor" href="#les-textes" aria-label="Permalink to &quot;Les textes&quot;">​</a></h2><p>Android est une plateforme « ouverte » et nativement prévue pour fonctionner dans le monde entier (Android pour tous). Il est donc logique que le i18n (internationalisation) soit intégré et ~même recommandé~ obligatoire pour tout bon développeur.</p><p>L&#39;ensemble des textes de votre application <em>doit être</em> dans le fichier <code>values/strings.xml</code>. Je vous laisse y jeter un petit coup d&#39;œil 👀</p><h2 id="decouverte-des-dossiers" tabindex="-1">Découverte des dossiers <a class="header-anchor" href="#decouverte-des-dossiers" aria-label="Permalink to &quot;Découverte des dossiers&quot;">​</a></h2><p>En complément de ce dont je vous ai parlé en cours, je vous laisse quelques minutes découvrir l&#39;ensemble des dossiers. Je vous laisse regarder plus en détail le dossier <code>res</code>, mais également les fichiers <code>gradle</code>.</p><p>Quelques points d&#39;attentions :</p><ul><li>Le dossier <code>res</code>.</li><li>Les images déjà présentes dans votre projet, notamment le XML pour l&#39;icône.</li><li>La structure en général et l&#39;organisation en <code>package</code> qui reprend votre choix lors de la configuration.</li></ul><h2 id="le-fichier-androidmanifest" tabindex="-1">Le fichier AndroidManifest <a class="header-anchor" href="#le-fichier-androidmanifest" aria-label="Permalink to &quot;Le fichier AndroidManifest&quot;">​</a></h2><p>Pour rappel le fichier manifest va nous permettre d&#39;exposer « de la configuration » relative à votre application sur le téléphone, cette configuration est très large :</p><ul><li>Le nom de votre application.</li><li>Les <code>activity</code> accessibles.</li><li>L&#39;icône de votre application.</li><li>Les services de votre application.</li><li>Les paramétrages spécifiques de vos activités (Orientation, thème, comportement…)</li></ul><h3 id="a-faire" tabindex="-1">À faire : <a class="header-anchor" href="#a-faire" aria-label="Permalink to &quot;À faire :&quot;">​</a></h3><ul><li>Éditer le fichier <code>AndroidManifest.xml</code>.</li><li>Changer le nom de votre application (attention à bien utiliser la mécanique <code>i18n</code>).</li><li>Regarder l&#39;ensemble des paramètres spécifier dans le XML</li><li>Tester à nouveau votre application</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Petit raccourci pratique d&#39;Android Studio. Si vous appuyez deux fois sur la touche <kbd>Shift</kbd><kbd>Shift</kbd> Android Studio vous proposera de chercher des actions / fichiers / menus dans l&#39;ensemble de votre projet.</p></div><h2 id="personnalisation-de-votre-application" tabindex="-1">Personnalisation de votre application <a class="header-anchor" href="#personnalisation-de-votre-application" aria-label="Permalink to &quot;Personnalisation de votre application&quot;">​</a></h2><p>Changer l&#39;icône de l&#39;application en utilisant les outils fournis par Google dans Android Studio « Image asset » :</p><p><img src="'+r+'" alt="Change Icon" loading="lazy"></p><p>Une fois fait, regarder les modifications dans votre projet.</p><p><em>Notamment :</em></p><ul><li>Le fichier <code>AndroidManifest.xml</code> est-ce que celui-ci a été modifié ?</li><li>Si oui, quel(s) élément(s) sont différents ?</li><li>Si non, pouvez-vous me dire pourquoi ?</li></ul><h2 id="les-layouts" tabindex="-1">Les layouts <a class="header-anchor" href="#les-layouts" aria-label="Permalink to &quot;Les layouts&quot;">​</a></h2><p>Si vous avez ouvert le fichier <code>activity_main.xml</code> vous avez certainement constaté que celui-ci était très simple. Nous allons donc le modifier un petit peu.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Android Studio vous propose un éditeur graphique de l&#39;interface, c&#39;est pratique, mais pour apprendre ce n&#39;est pas idéal. Je vous propose de changer de mode d&#39;édition afin de passer en mode XML via la vue <code>Split</code>. Qui nous affichera à la fois le graphique ainsi que le XML.</p><p><img src="'+p+'" alt="SPLIT" loading="lazy"></p></div><h3 id="a-faire-1" tabindex="-1">À faire : <a class="header-anchor" href="#a-faire-1" aria-label="Permalink to &quot;À faire :&quot;">​</a></h3><ul><li>Éditer le layout <code>activity_main.xml</code>.</li><li>Ajouter une balise ImageView.</li><li>Ajouter également une balise Button.</li></ul><h3 id="les-ressources-alternatives" tabindex="-1">Les ressources alternatives <a class="header-anchor" href="#les-ressources-alternatives" aria-label="Permalink to &quot;Les ressources alternatives&quot;">​</a></h3><p>Android intègre la gestion des ressources « alternative », c&#39;est-à-dire la possibilité de charger automatiquement des ressources en fonction de conditions liées au téléphone du client type :</p><ul><li>Taille de l&#39;écran.</li><li>Langue.</li><li>Rotation de l&#39;écran (Paysage / Portrait).</li><li>DPI</li><li>Thème sombre</li><li>Version d&#39;Android</li><li>etc.</li></ul><p>Cette création de ressource est réalisable directement depuis Android Studio :</p><p><img src="'+h+'" alt="Create new resources" loading="lazy"><img src="'+o+'" alt="Création de ressources alternatives" loading="lazy"></p><div class="tip custom-block"><p class="custom-block-title">Vous pouvez tout redéfinir</p><p>L&#39;ensemble des ressources (<code>res</code>) est redéfinissable sans écrire de code. Par exemple si vous souhaitez redéfinir des <code>strings</code> dans différentes conditions il suffit de :</p><p><img src="'+d+'" alt="Popup de création" loading="lazy"><img src="'+k+`" alt="Ressources alternatives" loading="lazy"></p></div><h3 id="a-faire-2" tabindex="-1">À faire : <a class="header-anchor" href="#a-faire-2" aria-label="Permalink to &quot;À faire :&quot;">​</a></h3><ul><li>Éditer le layout <code>activity_main.xml</code>.</li><li>Ajouter une balise TextView.</li><li>Dans le <code>android:text</code> utiliser une strings <code>android:text=&quot;@strings/monString&quot;</code>.</li><li>Celle-ci doit être différente en fonction si l&#39;utilisateur a son téléphone en paysage (<code>land</code>) ou en portrait.</li><li>Ajuster également la taille du logo pour que celui-ci soit plus petit si le téléphone est en portrait (<code>land</code>).</li></ul><h3 id="les-dimensions-et-contraintes" tabindex="-1">Les dimensions et contraintes <a class="header-anchor" href="#les-dimensions-et-contraintes" aria-label="Permalink to &quot;Les dimensions et contraintes&quot;">​</a></h3><p>Vous avez donc ajouté deux nouveaux éléments dans votre layout, mais ils n&#39;ont n&#39;y taille ni « positions ». En effet, comme vu ensemble en cours, nous utilisons un layout de type « ConstraintLayout » c&#39;est-à-dire que vos éléments doivent être contraints les uns par rapport aux autres.</p><p>Vous allez donc devoir ajouter les attributs suivants sur vos deux nouveaux éléments :</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">VotreElement</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    android:id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@+id/monElement&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    android:layout_width</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wrap_content&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    android:layout_height</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wrap_content&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    app:layout_constraintBottom_toBottomOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;parent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    app:layout_constraintEnd_toEndOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;parent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    app:layout_constraintStart_toStartOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;parent&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    app:layout_constraintTop_toTopOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;parent&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><em>Un peu d&#39;explication :</em></p><ul><li><code>android:id</code> permet de rendre l&#39;élément accessible depuis le code, ou tout simplement depuis un autre élément afin de définir une contrainte.</li><li><code>android:layout_width</code> et <code>android:layout_height</code> définisse la taille de votre élément. <code>wrap_content</code> indique que la taille doit être celle du contenu. Je vous laisse découvrir les autres propriétés avec <kbd>alt</kbd> + <kbd>entrée</kbd> sur <code>wrap_content</code>.</li><li><code>app:layout_constraint…</code> définissent les contraintes entre l&#39;élément et les autres éléments de layout. Dans notre cas « parent » signifie que les contraintes seront avec le parent, c&#39;est-à-dire la fenêtre dans le cas présent.</li></ul><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Si vous souhaitez contraindre un élément avec un autre, la syntaxe sera la même, mais vous allez devoir indiquer une contrainte du type <code>&quot;@id/imageView&quot;</code>.</p></div><h3 id="a-faire-3" tabindex="-1">À faire : <a class="header-anchor" href="#a-faire-3" aria-label="Permalink to &quot;À faire :&quot;">​</a></h3><p>Je vous laisse réaliser l&#39;ensemble des contraintes afin que votre layout ressemble à :</p><p><img src="`+c+'" alt="Constrainte" loading="lazy"></p><p>⚠️ Vous noterez l&#39;icône de Playmoweb, je vous laisse l&#39;ajouter dans le dossier <code>drawable</code> de votre projet. Le fichier doit être au format <code>png</code> ou <code>jpeg</code>. Une fois celle-ci ajoutée modifier l&#39;ImageView pour l&#39;utiliser dans l&#39;<code>ImageView</code> avec par exemple <code>app:srcCompat=&quot;@drawable/logo&quot;</code>.</p><p>✋ Relancer l&#39;application et tester que celle-ci fonctionne.</p><h2 id="l-activity" tabindex="-1">L&#39;activity <a class="header-anchor" href="#l-activity" aria-label="Permalink to &quot;L&#39;activity&quot;">​</a></h2><p>Nous avons une activity qui pour l&#39;instant ne fait pas grand-chose. Si vous regardez le code, celui-ci est presque vide. Je vous propose de la modifier, en premier lieu nous allons ajouter un message au lancement de celle-ci.</p><p>Un message simple sur Android s&#39;appelle un Toast :</p><p><img src="'+u+`" alt="Ceci est un toast" loading="lazy"></p><p>Ajouter celui-ci dans la méthode <code>onCreate</code> de votre <code>MainActivity.kt</code>.</p><p>Vous pouvez utiliser la complétion de votre IDE, <code>toast</code> puis <kbd>tab</kbd>.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Les toasts sont rapides et simples à mettre en place. Cependant, ils ne sont pas très beaux. C&#39;est pour ça que nous les utiliserons principalement que pour « les informations de tests ou sans grandes importances ».</p></div><h3 id="a-faire-4" tabindex="-1">À faire : <a class="header-anchor" href="#a-faire-4" aria-label="Permalink to &quot;À faire :&quot;">​</a></h3><ul><li>Ajouter le Toast.</li><li>Le context, comme vu ensemble pendant le cours correspond à votre <code>activity</code> donc il faut indiquer <code>this</code>.</li><li>Pour le texte, pensez bien à mettre celui-ci dans le fichier <code>strings.xml</code> puis à le récupérer via <code>getString(R.string.votreId)</code>.</li></ul><p>✋ Tester votre modification.</p><h3 id="la-snackbar" tabindex="-1">La Snackbar <a class="header-anchor" href="#la-snackbar" aria-label="Permalink to &quot;La Snackbar&quot;">​</a></h3><p>Un autre moyen d&#39;interagir avec l&#39;utilisateur, c&#39;est via un Snackbar. Une snackbar est très similaire à un Toast, cependant elle pourra servir pour afficher des messages importants et surtout des messages avec lesquels nous allons pouvoir interagir.</p><p>Je vous laisse modifier votre code pour remplacer le Toast par :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Snackbar.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findViewById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(android.R.id.content), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Je suis une Snackbar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Snackbar.LENGTH_LONG).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>Ou</strong></p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Snackbar.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">findViewById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(android.R.id.content), </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Je suis une Snackbar&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Snackbar.LENGTH_LONG).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setAction</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // Votre action</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Vous souhaitez changer la durée d&#39;affichage ?</p><p>Plusieurs options s&#39;offre à vous :</p><ul><li><code>Snackbar.LENGTH_SHORT</code></li><li><code>Snackbar.LENGTH_LONG</code></li><li><code>Snackbar.LENGTH_INDEFINITE</code></li></ul></div><h2 id="rendre-un-element-clickable" tabindex="-1">Rendre un élément clickable <a class="header-anchor" href="#rendre-un-element-clickable" aria-label="Permalink to &quot;Rendre un élément clickable&quot;">​</a></h2><p>Pour rendre un élément cliquable sur Android, nous avons plusieurs façons de faire. La première c&#39;est dans le code via son id et la méthode <code>findViewById</code>.</p><p>Ajouter dans votre méthode <code>onCreate</code> le code suivant :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    findViewById</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;(R.id.myButton).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOnClickListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Votre action</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Et voilà… Votre bouton est cliquable.</p><h3 id="a-faire-5" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-5" aria-label="Permalink to &quot;À faire&quot;">​</a></h3><ul><li>Rendre votre bouton clickable.</li><li>Afficher un Toast sur le OnClick.</li></ul><p>⚠️ Attention à bien référencer le bon <code>R.id.myButton</code> par rapport à votre layout.</p><h2 id="rendre-un-element-clickable-2" tabindex="-1">Rendre un élément clickable 2 <a class="header-anchor" href="#rendre-un-element-clickable-2" aria-label="Permalink to &quot;Rendre un élément clickable 2&quot;">​</a></h2><p>Le <code>ViewBinding</code> est maintenant la nouvelle façon moderne de gérer « les références à la vue depuis le code Kotlin ». Ça fonctionne un peu comme le <code>findViewById</code> sauf que le Binding est automatique et surtout celui-ci gère automatiquement le typage !</p><p>Première étape, il faut activer dans votre build.gradle le « ViewBinding », dans le block Android déjà présent ajouter :</p><div class="language-txt vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>buildFeatures {</span></span>
<span class="line"><span>    viewBinding true</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Exemple dans mon cas :</p><p><img src="`+E+'" alt="viewBinding" loading="lazy"></p><p>✋ N&#39;oubliez pas de resync l&#39;IDE</p><p><img src="'+i+`" alt="ide sync" loading="lazy"></p><p>Maintenant nous avons maintenant un Binding automatique entre « La vue et le Code Kotlin », cependant pour que celui-ci soit accessible de l&#39;ensemble de notre classe, nous allons devoir modifier légèrement notre <code>class</code>.</p><p>Exemple de modification dans la <code>MainActivity</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> MainActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> : </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AppCompatActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> lateinit</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> binding: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ActivityMainBinding</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // &lt;-- Référence à notre ViewBinding</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bundle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onCreate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(savedInstanceState)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // --&gt; Indique que l&#39;on utilise le ViewBinding</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        binding </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActivityMainBinding.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">inflate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(layoutInflater)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setContentView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(binding.root)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // L&#39;ensemble de nos références sont disponibles directement dans « binding »</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        binding.button.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOnClickListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // Click sur le Button nommé « Button » dans notre Layout.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><a href="https://developer.android.com/topic/libraries/view-binding" target="_blank" rel="noreferrer">En savoir plus dans la documentation</a></p><h3 id="a-faire-6" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-6" aria-label="Permalink to &quot;À faire&quot;">​</a></h3><p>Modifier le code précédent pour utiliser la nouvelle façon vue précédemment.</p><h3 id="les-kotlin-android-extension" tabindex="-1">Les Kotlin Android Extension <a class="header-anchor" href="#les-kotlin-android-extension" aria-label="Permalink to &quot;Les Kotlin Android Extension&quot;">​</a></h3><p>Bien que pratique, cette méthode n&#39;est maintenant plus « la bonne façon de faire ». Si vous la trouvez sur Internet, passez votre chemin.</p><h3 id="creer-une-autre-activity" tabindex="-1">Créer une autre activity <a class="header-anchor" href="#creer-une-autre-activity" aria-label="Permalink to &quot;Créer une autre activity&quot;">​</a></h3><p>Nous allons ajouter une nouvelle activity, celle-ci sera un « Splash Screen », elle sera donc affichée au lancement de l&#39;application.</p><h4 id="etape-1-creer-l-activity" tabindex="-1">Étape 1 : Créer l&#39;activity <a class="header-anchor" href="#etape-1-creer-l-activity" aria-label="Permalink to &quot;Étape 1 : Créer l&#39;activity&quot;">​</a></h4><p>Pour créer une activity, Android Studio nous propose dans les menus une action qui automatise l&#39;ensemble du processus à savoir :</p><ul><li>Création du package</li><li>Création de la class</li><li>Création du layout</li><li>Modification du AndroidManifest.xml</li></ul><p>Créer la nouvelle activity :</p><p><img src="`+g+'" alt="create_activity" loading="lazy"></p><p>Puis :</p><p><img src="'+m+`" alt="create_activity" loading="lazy"></p><h4 id="etape-2-voir-modifier-le-fichier-androidmanifest-xml" tabindex="-1">Étape 2 : Voir / Modifier le fichier AndroidManifest.xml <a class="header-anchor" href="#etape-2-voir-modifier-le-fichier-androidmanifest-xml" aria-label="Permalink to &quot;Étape 2 : Voir / Modifier le fichier AndroidManifest.xml&quot;">​</a></h4><p>L&#39;activity est maintenant créée. Sauf que… nous avons deux activity qui se lancent au démarrage. Modifier le AndroidManifest pour retirer :</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">intent-filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">action</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.intent.action.MAIN&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">category</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.intent.category.LAUNCHER&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">intent-filter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>De la <code>MainActivity</code>.</p><p>Modifier également le thème de la SplashActivity afin de lui spécifier un thème sans « ActionBar ». Pour ça il vous suffit d&#39;ajouter dans les attributs celui-ci :</p><p><code>android:theme=&quot;@style/Theme.AppCompat.DayNight.NoActionBar&quot;</code></p><p>Exemple :</p><p><code>&lt;activity android:name=&quot;.SplashActivity&quot; android:theme=&quot;@style/Theme.AppCompat.DayNight.NoActionBar&quot;&gt;</code></p><p>✋ Lancer l&#39;application. Vous devez être bloqué sur une « vue blanche ».</p><h4 id="etape-3-modifier-le-layout" tabindex="-1">Étape 3 : Modifier le layout <a class="header-anchor" href="#etape-3-modifier-le-layout" aria-label="Permalink to &quot;Étape 3 : Modifier le layout&quot;">​</a></h4><p>Je vous laisse modifier le layout pour que celui-ci ressemble à :</p><p><img src="`+b+`" alt="Splash" loading="lazy"></p><h4 id="etape-4-lancer-une-activity" tabindex="-1">Étape 4 : Lancer une activity <a class="header-anchor" href="#etape-4-lancer-une-activity" aria-label="Permalink to &quot;Étape 4 : Lancer une activity&quot;">​</a></h4><p>Maintenant que notre « Splash » s&#39;affiche, nous allons pouvoir lancer l&#39;autre activity après <em>un délai</em>. Dans cette partie, nous allons voir comment lancer une activité, et plus précisément comment nous pouvons « simplifier » / « uniformiser » le lancement via une méthode static.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>🤓 Si vous avez déjà fait du développement Android, rien de nouveau, je vous propose simplement juste <strong>une autre façon</strong> de vous organiser.</p></div><h4 id="etape-4-1-methode-«-static-»" tabindex="-1">Étape 4.1 : Méthode « static » <a class="header-anchor" href="#etape-4-1-methode-«-static-»" aria-label="Permalink to &quot;Étape 4.1 : Méthode « static »&quot;">​</a></h4><p>Lancer une activity sur Android est aussi simple que d&#39;appeler la méthode <code>startActivity</code> au moment voulu. Pour « simplifier l&#39;écriture » et éviter le code spaghetti, nous allons ajouter dans le code de la MainActivity une méthode qui sera en charge de « retourner les informations (appelée une <code>Intent</code>) » nécessaires au lancement de celle-ci.</p><p>En Kotlin les méthodes static <strong>doivent être mise</strong> dans <code>companion object</code>. Nous allons donc ajouter « un compagnon » dans notre class. Un compagnon Object va nous permettre de créer une méthode « static » qui sera accessible directement sans instancier là class.</p><p>À faire :</p><p>Ajouter le code suivant dans la <em>MainActivity</em> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context, MainActivity::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.java)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="etape-4-2-appeler-la-methode" tabindex="-1">Étape 4.2 : Appeler la méthode <a class="header-anchor" href="#etape-4-2-appeler-la-methode" aria-label="Permalink to &quot;Étape 4.2 : Appeler la méthode&quot;">​</a></h4><p>Dans le code de la <em>SplashActivity</em> nous allons lancer après quelques secondes le code permettant de lancer la <em>MainActivity</em>. Pour ça ajouter le code suivant dans le <code>onCreate</code> de votre <code>SplashActivity</code>.</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    Handler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Looper.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getMainLooper</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">postDelayed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MainActivity.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        finish</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">Analyse du code</p><p>Le code à proprement dit qui lance l&#39;activity est le suivant :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(MainActivity.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>Et oui c&#39;est aussi simple que ça!</p></div><ul><li>À quoi correspond le <code>this</code> ?</li><li>À quoi sert le <code>finish()</code> ?</li><li>Que se passe-t-il si vous ne le mettez pas ?</li><li>Pouvez-vous changer le temps d&#39;attente ?</li></ul><h2 id="demarrer-une-activite-avec-des-parametres" tabindex="-1">Démarrer une activité avec des paramètres <a class="header-anchor" href="#demarrer-une-activite-avec-des-parametres" aria-label="Permalink to &quot;Démarrer une activité avec des paramètres&quot;">​</a></h2><p>En reprenant le principe précédent, il est tout a fait possible de « passer des paramètres » à votre activity :</p><h3 id="dans-l-activity-a-demarrer" tabindex="-1">Dans l&#39;activity à démarrer <a class="header-anchor" href="#dans-l-activity-a-demarrer" aria-label="Permalink to &quot;Dans l&#39;activity à démarrer&quot;">​</a></h3><h4 id="le-code-pour-demarrer-l-activity" tabindex="-1">Le code pour démarrer l&#39;activity : <a class="header-anchor" href="#le-code-pour-demarrer-l-activity" aria-label="Permalink to &quot;Le code pour démarrer l&#39;activity :&quot;">​</a></h4><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> IDENTIFIANT_ID </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;IDENTIFIANT_ID&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, identifiant: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context, RemoteActivity::</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">class</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.java).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            putExtra</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(IDENTIFIANT_ID, identifiant)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="le-code-pour-recuperer-le-parametre" tabindex="-1">Le code pour récupérer le paramètre <a class="header-anchor" href="#le-code-pour-recuperer-le-parametre" aria-label="Permalink to &quot;Le code pour récupérer le paramètre&quot;">​</a></h4><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Retourne l&#39;identifiant passé en paramètre à l&#39;activité</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getIdentifiant</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">? {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> intent.extras?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(IDENTIFIANT_ID, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="dans-l-activity-qui-va-lancer-l-autre-activity" tabindex="-1">Dans l&#39;activity qui va lancer l&#39;autre activity <a class="header-anchor" href="#dans-l-activity-qui-va-lancer-l-autre-activity" aria-label="Permalink to &quot;Dans l&#39;activity qui va lancer l&#39;autre activity&quot;">​</a></h3><p>Et pour démarrer l&#39;activity :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(VotreActivityADemarrer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStartIntent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CECI-EST-UN-IDENTIFIANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="theme-et-drawable" tabindex="-1">Thème et Drawable <a class="header-anchor" href="#theme-et-drawable" aria-label="Permalink to &quot;Thème et Drawable&quot;">​</a></h2><p>Le grand chalenge d&#39;une application mobile c&#39;est « le côté visuel ». Bien évidemment je sais que vous n&#39;êtes pas des experts UI/UX, Google le sait également. C&#39;est pour ça qu&#39;ils ont intégré dans Android Studio un catalogue d&#39;icône nous permettant nous développeurs de travailler avec des éléments propres et de qualité.</p><p>Pour rappel, les images dans Android s&#39;appellent des <code>Drawables</code> et sont dans le dossier <code>Res</code>. Android Studio intègre un catalogue nommé « Vector Asset », celui-ci est disponible dans les menus :</p><p><img src="`+y+'" alt="Vector Asset" loading="lazy"></p><p>Pour choisir une icône :</p><p><img src="'+v+`" alt="Vector Asset choix" loading="lazy"></p><h3 id="a-faire-7" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-7" aria-label="Permalink to &quot;À faire&quot;">​</a></h3><ul><li>Ajouter un nouveau drawable dans votre projet.</li><li>Que constatez-vous comme changement dans les Drawable ?</li><li>Utiliser l&#39;image choisie dans votre layout « Splash ». L&#39;image choisie doit-être en bas à droite.</li></ul><h2 id="theme-de-couleurs" tabindex="-1">Thème de couleurs <a class="header-anchor" href="#theme-de-couleurs" aria-label="Permalink to &quot;Thème de couleurs&quot;">​</a></h2><p>Comme vous avez pu le constater, les couleurs de votre application sont « principalement » violettes. Les couleurs en question sont définies dans le thème de votre application.</p><p>Je vous propose de les modifier. Première étape, ajouter vos couleurs dans le fichier <code>colors.xml</code>. Une fois fait modifier le fichier <code>themes.xml</code> et plus particulièrement le <code>colorPrimary</code> pour utiliser la couleur que vous avez ajoutée.</p><h3 id="a-faire-8" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-8" aria-label="Permalink to &quot;À faire&quot;">​</a></h3><ul><li>Ajouter une couleur (<code>colors.xml</code>). Par exemple, ajouter une « mainPrimaryColor ».</li><li>L&#39;utiliser dans le thème (<code>themes.xml</code>) en modifiant par le <code>colorPrimary</code> pour utiliser votre nouvelle couleur.</li></ul><h2 id="les-intent-externes-tierces" tabindex="-1">Les Intent externes / tierces <a class="header-anchor" href="#les-intent-externes-tierces" aria-label="Permalink to &quot;Les Intent externes / tierces&quot;">​</a></h2><p>Dans le système Android, nous avons à notre disposition en plus des Intents que vous déclarez la possibilité d&#39;appeler ceux du système. La liste est très grande :</p><ul><li>Lancer les paramètres.</li><li>Ouvrir un lien.</li><li>Ouvrir une Carte Google Maps.</li><li>…</li></ul><h3 id="ouvrir-les-parametres-bluetooth" tabindex="-1">Ouvrir les paramètres Bluetooth <a class="header-anchor" href="#ouvrir-les-parametres-bluetooth" aria-label="Permalink to &quot;Ouvrir les paramètres Bluetooth&quot;">​</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> targetIntent </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    action </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> android.provider.Settings.ACTION_BLUETOOTH_SETTINGS</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(targetIntent);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="ouvrir-un-lien-web" tabindex="-1">Ouvrir un lien web <a class="header-anchor" href="#ouvrir-un-lien-web" aria-label="Permalink to &quot;Ouvrir un lien web&quot;">​</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Intent.ACTION_VIEW, Uri.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cours.brosseau.ovh&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="ouvrir-google-maps" tabindex="-1">Ouvrir Google Maps <a class="header-anchor" href="#ouvrir-google-maps" aria-label="Permalink to &quot;Ouvrir Google Maps&quot;">​</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">startActivity</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Intent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Intent.ACTION_VIEW, Uri.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">parse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;geo:47.472822,-0.5621756&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)));</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="a-faire-9" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-9" aria-label="Permalink to &quot;À faire&quot;">​</a></h3><p>Maintenant que vous savez comment ouvrir une intent Externe :</p><ul><li>Ajouter sur la <code>MainActivity</code> une icône en haut à droite type « Settings ».</li><li>Celle-ci doit être cliquable et doit permettre d&#39;ouvrir les paramètres (<code>ACTION_SETTINGS</code>).</li><li>Ajouter sous le bouton « En bas de l&#39;activité » un texte cliquable <code>TextView</code> permettant d&#39;ouvrir le site de l&#39;école.</li><li>Ajoute à côté du <code>TextView</code> un second <code>TextView</code> qui ouvre l&#39;adresse / la position GPS de l&#39;école dans Google Maps.</li></ul><p>Exemple :</p><p><img src="`+F+'" alt="Sample UI TEST" loading="lazy"></p><h2 id="les-permissions" tabindex="-1">Les Permissions <a class="header-anchor" href="#les-permissions" aria-label="Permalink to &quot;Les Permissions&quot;">​</a></h2><p>Nous avons vu ensemble que la gestion des permissions était un élément important de la plateforme. Nous allons donc voir la théorie, puis la mettre en pratique.</p><p><img src="'+C+'" alt="Les permissions" loading="lazy"></p><p>Voilà le plus simple pour expliquer la mécanique des permissions c&#39;est « un schéma ». Je vous propose de mettre en pratique avec la permission « LOCALISATION ». Je vais volontairement vous donner le code à implémenter (celui-ci est disponible de toute manière dans la documentation d&#39;Android).</p><p>Pour réaliser cette fonctionnalité, nous allons ajouter une nouvelle activité (en utilisant les options de votre IDE). Pour le layout je vous propose de réaliser un layout qui ressemble à :</p><p><img src="'+f+`" alt="Layout" loading="lazy"></p><p>👋 C&#39;est bien évidemment qu&#39;une proposition… Vous pouvez faire autrement !</p><p>Pour le code, c&#39;est un poil plus compliqué, en reprenant le flow du graphique précédent, nous allons avoir besoin :</p><h2 id="declaration-des-permissions" tabindex="-1">Déclaration des permissions <a class="header-anchor" href="#declaration-des-permissions" aria-label="Permalink to &quot;Déclaration des permissions&quot;">​</a></h2><p>Dans le fichier Manifest ajoutez :</p><div class="language-xml vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses-permission</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.permission.ACCESS_COARSE_LOCATION&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">uses-permission</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android:name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;android.permission.ACCESS_FINE_LOCATION&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> /&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="permission-acceptee" tabindex="-1">Permission acceptée ? <a class="header-anchor" href="#permission-acceptee" aria-label="Permalink to &quot;Permission acceptée ?&quot;">​</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hasPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ActivityCompat.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">checkSelfPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Manifest.permission.ACCESS_FINE_LOCATION) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PackageManager.PERMISSION_GRANTED</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="demander-la-permission" tabindex="-1">Demander la permission <a class="header-anchor" href="#demander-la-permission" aria-label="Permalink to &quot;Demander la permission&quot;">​</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Permet d&#39;identifier le fait que nous demandons la permission</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Le code peut-être n&#39;importe quoi, mais il doit être unique</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Il vous permettra de savoir si l&#39;utilisateur revient de la demande de permission (onRequestPermissionsResult)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PERMISSION_REQUEST_LOCATION </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 9999</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> requestPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ActivityCompat.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestPermissions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arrayOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Manifest.permission.ACCESS_FINE_LOCATION), PERMISSION_REQUEST_LOCATION)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        getLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="methode-surchargee-apres-l-acceptation" tabindex="-1">Méthode surchargée après l&#39;acceptation <a class="header-anchor" href="#methode-surchargee-apres-l-acceptation" aria-label="Permalink to &quot;Méthode surchargée après l&#39;acceptation&quot;">​</a></h3><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onRequestPermissionsResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(requestCode: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, permissions: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Array</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">out</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;, grantResults: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">IntArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    super</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onRequestPermissionsResult</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(requestCode, permissions, grantResults)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (requestCode) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        PERMISSION_REQUEST_LOCATION </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // If request is cancelled, the result arrays are empty.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((grantResults.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isNotEmpty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> grantResults[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PackageManager.PERMISSION_GRANTED)) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // Permission obtenue, Nous continuons la suite de la logique.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                getLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // TODO</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                // Permission non accepté, expliqué ici via une activité ou une dialog pourquoi nous avons besoin de la permission</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">Gestion de la permission refusée de manière permanente</p><p>L&#39;utilisateur a le choix de refuser de manière permanente la localisation. Dans ce cas vous devez gérer l&#39;erreur avec <code>shouldShowRequestPermissionRationale()</code> qui retournera <code>true</code> / <code>false</code> en fonction.</p><p>Je vous laisse écrire le code afin d&#39;envoyer l&#39;utilisateur vers les paramètres de son téléphone si cela doit être le cas.</p></div><h3 id="obtenir-la-localisation" tabindex="-1">Obtenir la localisation <a class="header-anchor" href="#obtenir-la-localisation" aria-label="Permalink to &quot;Obtenir la localisation&quot;">​</a></h3><p>C&#39;est le code « métier ». Les méthodes précédentes sont par contre génériques, et toujours présentes, quelle que soit la problématique.</p><p><em>Obtenir la location : Via « la dernière connue » :</em></p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(location: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Toast.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">makeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Lat: \${location.latitude} - Long: \${location.longitude}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Toast.LENGTH_SHORT).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> locationManager </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> applicationContext.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSystemService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(LOCATION_SERVICE) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LocationManager?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        locationManager?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            locationManager.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getLastKnownLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(LocationManager.PASSIVE_PROVIDER)?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><em>Obtenir la localisation 2 pour avoir la position réelle (pas la dernière obtenue par le système) :</em></p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(location: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Toast.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">makeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Lat: \${location.latitude} - Long: \${location.longitude}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Toast.LENGTH_SHORT).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> locationManager </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> applicationContext.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSystemService</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(LOCATION_SERVICE) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LocationManager?</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        locationManager?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            locationManager.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">requestLocationUpdates</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(LocationManager.NETWORK_PROVIDER, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LocationListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(it) });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><em>Obtenir la localisation 3 : Via les Play Services :</em></p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(location: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Toast.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">makeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Lat: \${location.latitude} - Long: \${location.longitude}&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Toast.LENGTH_SHORT).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">hasPermission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        fusedLocationClient </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> LocationServices.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getFusedLocationProviderClient</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        fusedLocationClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getCurrentLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(LocationRequest.PRIORITY_BALANCED_POWER_ACCURACY, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CancellationTokenSource</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().token)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addOnSuccessListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(it) }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">addOnFailureListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                    // Remplacer par un vrai bon message</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    Toast.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">makeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Localisation impossible&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Toast.LENGTH_SHORT).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="danger custom-block"><p class="custom-block-title">Vous devez choisir une façon de faire</p><p>Nous avons donc trois façons de faire, si votre téléphone a les Play Services la dernière solution sera la bonne.</p></div><h3 id="bonus-obtenir-l-adresse-par-rapport-au-lat-long" tabindex="-1">BONUS ! Obtenir l&#39;adresse par rapport au lat, long <a class="header-anchor" href="#bonus-obtenir-l-adresse-par-rapport-au-lat-long" aria-label="Permalink to &quot;BONUS ! Obtenir l&#39;adresse par rapport au lat, long&quot;">​</a></h3><p>Latitude, Longitude c&#39;est triste… Android intègre de base un Geocoder permettant d&#39;obtenir une adresse textuelle en fonction d&#39;une <code>lat,long</code>.</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> geoCode</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(location: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Location</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geocoder </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Geocoder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Locale.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> geocoder.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getFromLocation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(location.latitude, location.longitude, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (results?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isNotEmpty</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        locationText.text </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> results[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getAddressLine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="a-faire-10" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-10" aria-label="Permalink to &quot;À faire&quot;">​</a></h3><p>Je vous laisse implémenter le code… N&#39;hésiter pas à reprendre le « graph » il vous sera utile pour déterminer qu&#39;elle méthode appeler en premier lors de l&#39;appui sur le bouton « Localiser Moi ». Un petit indice… on commence toujours par vérifier si l&#39;application a le droit d&#39;accéder « à la fonctionnalité ».</p><div class="tip custom-block"><p class="custom-block-title">La toolbar</p><p>Pour activer l&#39;action retour dans la Toolbar d&#39;une activité. <strong>Vous devez</strong> ajouter le code suivant dans le <code>OnCreate</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">supportActionBar?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setTitle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.string.whatever)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setDisplayHomeAsUpEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setDisplayShowHomeEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Puis vous devez override la méthode <code>onSupportNavigateUp</code> qui est appelée lors de l&#39;appui sur le « l&#39;icône retour »:</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onSupportNavigateUp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    finish</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div><details class="details custom-block"><summary>Voir une solution complète</summary><p>Vous séchez ? _<em>Je vous invite à me demander avant de regarder la solution…</em> cependant, si vous souhaitez par contre vérifier votre solution.</p><p><a href="https://gist.github.com/c4software/a3fa7f584a464a6308648b7fcce28add" target="_blank" rel="noreferrer">Sachez que vous avez une version du code ici</a></p></details><h2 id="les-recyclerview" tabindex="-1">Les Recyclerview <a class="header-anchor" href="#les-recyclerview" aria-label="Permalink to &quot;Les Recyclerview&quot;">​</a></h2><p>✋ Parlons-en 👋</p><p>Nous allons faire cette étape ensemble.</p><p>Mais dans les grandes lignes :</p><ul><li>Ajouter une nouvelle activité.</li><li>Ajout d&#39;un bouton sur la home permettant de la lancer.</li><li>Dans la nouvelle activity, un RecyclerView qui contiendra « des éléments de type Strings ». (<code>&lt;androidx.recyclerview.widget.RecyclerView android:layout_width=&quot;wrap_content&quot;android:layout_height=&quot;wrap_content&quot; …</code>)</li><li>Chaque élément de la liste doit ressembler à (je vous laisse créer le fichier nommé <code>item_list.xml</code> dans les layouts).</li></ul><p><img src="`+A+'" alt="List Item Layout" loading="lazy"></p>',212),S=l("iframe",{width:"560",height:"315",src:"https://www.youtube.com/embed/28GgLW7vCRM?si=z9kwjf4zHq60pFLl",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,-1),P=s('<div class="tip custom-block"><p class="custom-block-title">Les RecyclerView c&#39;est important</p><p>Comme je le disais en cours, les RecyclerView c&#39;est un concept important. Il faut prendre du temps pour bien comprendre le fonctionnement et les « limites ». En vous inspirant de <a href="https://gist.github.com/c4software/95e51417890c68078c14555b2f1d9a03" target="_blank" rel="noreferrer">l&#39;exemple ici</a></p><p>Je vous laisse implémenter votre propre RecyclerView.</p><p>✋ <strong>Attention</strong>, dans notre cas le RecyclerView sera du type String et non pas <strong>Device</strong></p></div><h2 id="les-«-plugins-»-librairies" tabindex="-1">Les « Plugins » / Librairies <a class="header-anchor" href="#les-«-plugins-»-librairies" aria-label="Permalink to &quot;Les « Plugins » / Librairies&quot;">​</a></h2><p>Comme vu en cours, je vous laisse ajouter les librairies :</p><ul><li>MaterialDialog.</li><li>Recyclical dans votre projet.</li></ul><h3 id="les-dialogs" tabindex="-1">Les Dialogs <a class="header-anchor" href="#les-dialogs" aria-label="Permalink to &quot;Les Dialogs&quot;">​</a></h3><h4 id="avec-materialdialog" tabindex="-1">Avec MaterialDialog <a class="header-anchor" href="#avec-materialdialog" aria-label="Permalink to &quot;Avec MaterialDialog&quot;">​</a></h4><p>Ajouter une dialog dans votre projet. Avec la librairie <a href="https://github.com/afollestad/material-dialogs/blob/main/documentation/CORE.md" target="_blank" rel="noreferrer">MaterialDialog</a>. Celle-ci doit s&#39;afficher lors du clic sur le bouton de la home.</p><h3 id="avec-le-material-design-de-google" tabindex="-1">Avec le Material Design de Google <a class="header-anchor" href="#avec-le-material-design-de-google" aria-label="Permalink to &quot;Avec le Material Design de Google&quot;">​</a></h3><p>Ajouter une dialog dans votre projet. Avec la librairie <a href="https://material.io/develop/android/docs/getting-started" target="_blank" rel="noreferrer">Material Design de Google</a>. Celle-ci doit s&#39;afficher lors du clic sur le bouton de la home.</p><h3 id="recyclical" tabindex="-1">Recyclical <a class="header-anchor" href="#recyclical" aria-label="Permalink to &quot;Recyclical&quot;">​</a></h3><p>Réimplémenter le code précédemment écrit (ou créer une autre activité) avec <a href="https://github.com/afollestad/recyclical" target="_blank" rel="noreferrer">Recyclical</a>.</p><h2 id="activite-«-parametres-»" tabindex="-1">Activité « Paramètres » <a class="header-anchor" href="#activite-«-parametres-»" aria-label="Permalink to &quot;Activité « Paramètres »&quot;">​</a></h2><p>Je vous laisse créer une nouvelle activité. Celle-ci <strong>doit être</strong> constituée :</p><ul><li>Une Toolbar avec un bouton Retour et un titre « Paramètres ».</li><li>un RecyclerView qui va contenir : <ul><li>Paramètres Bluetooth -&gt; ouvre les paramètres du téléphone.</li><li>Informations -&gt; ouvre une activité (ou un dialogue avec un message texte).</li><li>Un élément ouvrant « les paramètres de l&#39;application »</li><li>Un lien vers le site de l&#39;école.</li><li>Un lien vers le Google Maps de l&#39;école.</li></ul></li></ul><div class="danger custom-block"><p class="custom-block-title">Votre RecyclerView</p><p>Votre RecyclerView va contenir des objets du type SettingsItem (class a créé). Chaque élément va ressembler à :</p><p><em>Exemple d&#39;un élément de liste :</em></p><p><img src="'+q+'" alt="ressources list_item_sample.png" loading="lazy"></p><p><img src="'+B+`" alt="ressources list_item_sample.png" loading="lazy"></p><p><em>Les objet de type <code>SettingsItem.kt</code></em>:</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Définition de la Class qui sera dans notre RecyclerView</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SettingsItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> icon: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> onClick: (() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Unit))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Exemple de déclaration dans la datasource (à déclarer dans votre Activity)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mesItems </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> arrayOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    SettingsItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Paramètre Bluetooth&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, R.drawable.bluetooth) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Action lors du click</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    SettingsItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Informations&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, R.drawable.info) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Action lors du click</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    SettingsItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Paramètres&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, R.drawable.settings) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Action lors du click</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    SettingsItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Site de l&#39;école&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, R.drawable.logo_eseo) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // Action lors du click</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Je vous laisse implémenter votre ViewHolder, pour référencer dans votre vue (via des findViewById comme vus ensemble)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// -&gt; name</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// -&gt; icon</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// -&gt; l&#39;action aux cliques</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></div><div class="tip custom-block"><p class="custom-block-title">La toolbar</p><p>Pour activer l&#39;action retour dans la Toolbar d&#39;une activity. <strong>Vous devez</strong> ajouter le code suivant dans le <code>OnCreate</code> :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">supportActionBar?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setTitle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(R.string.whatever)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setDisplayHomeAsUpEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setDisplayShowHomeEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Puis vous devez override la méthode <code>onSupportNavigateUp</code> qui est appelée lors de l&#39;appui sur le « l&#39;icône retour »:</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">override</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> onSupportNavigateUp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    finish</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div><h3 id="la-classe-localpreferences-aka-sauvegarder-des-parametres" tabindex="-1">La classe LocalPreferences (AKA Sauvegarder des paramètres) <a class="header-anchor" href="#la-classe-localpreferences-aka-sauvegarder-des-parametres" aria-label="Permalink to &quot;La classe LocalPreferences (AKA Sauvegarder des paramètres)&quot;">​</a></h3><p>Cette classe va nous permettre de sauvegarder de manière « persistant » des paramètres.</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android.content.Context</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> android.content.SharedPreferences</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LocalPreferences</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> private</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> constructor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sharedPreferences: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SharedPreferences</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSharedPreferences</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MyPref&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Context.MODE_PRIVATE)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> saveStringValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(yourValue: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">?) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sharedPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">edit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">putString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saveStringValue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, yourValue).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getSaveStringValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">? {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sharedPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;saveStringValue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    companion</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> object</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        private</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> INSTANCE: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LocalPreferences</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">? </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LocalPreferences</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> INSTANCE?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                INSTANCE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            } ?: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                INSTANCE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> LocalPreferences</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(context)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> INSTANCE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>Et pour l&#39;utiliser dans vos activity :</p><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// … Reste de votre code</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Exemple sauvegarde d&#39;information à chaque click.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">button.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setOnClickListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    LocalPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">saveStringValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Votre valeur&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Exemple de récupération</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(LocalPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSaveStringValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Toast.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">makeText</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, LocalPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getInstance</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getSaveStringValue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), Toast.LENGTH_SHORT).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// … Suite de votre code</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="a-faire-11" tabindex="-1">À faire <a class="header-anchor" href="#a-faire-11" aria-label="Permalink to &quot;À faire&quot;">​</a></h4><p>Cette classe est générique, il vous suffit d&#39;implémenter les bonnes méthodes.</p><p>J&#39;aimerais que nous puissions sauvegarder l&#39;ensemble des positions de l&#39;utilisateur :</p><ul><li>Créer la class <code>LocalPreferences</code>. (attention dans le bon package)</li><li>Ajouter les deux méthodes permettant la sauvegarde des données dans la class <code>LocalPreferences</code>. (nous allons avoir besoin de <code>putStringSet</code> et de <code>getStringSet</code> deux méthodes fournies par <code>SharedPreferences</code>, permettant de sauvegarder des listes de données).</li></ul><details class="details custom-block"><summary>Voir une solution (comme à chaque fois cherchez par vous-même en vous inspirant de mon exemple)</summary><div class="language-kotlin vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> addToHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(newEntry: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> history </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        history?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(newEntry)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sharedPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">edit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">putStringSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;histories&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, history).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apply</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    fun</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(): </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MutableSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;? {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sharedPreferences.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getStringSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;histories&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">emptySet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></details><ul><li>Modifier votre activity « Localisation » pour sauvegarder chaque position « détecté ». (vous pouvez valider la bonne insertion de votre donnée via un point d&#39;arrêt dans votre code)</li><li>Créer une nouvelle <code>activity</code> qui va afficher l&#39;ensemble des données présent dans votre historique (via un <code>RecyclerView</code>).</li><li>Rendre cette nouvelle activity accessible depuis « la home de votre application ». (uniquement s’il y a des données).</li></ul>`,27),x=[L,S,P];function I(w,T,_,R,V,N){return n(),e("div",null,x)}const z=a(D,[["render",I]]);export{M as __pageData,z as default};
